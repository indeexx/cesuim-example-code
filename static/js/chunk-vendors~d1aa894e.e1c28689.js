(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~d1aa894e"],{"384a":function(e,t,i){"use strict";var n=i("408d"),a=i("8656"),s=i("dde0"),o=i("6b82"),r=i("4051"),c=i("2fad"),d=i("cbf0"),u=i("1a5d"),h=i("61ad"),l=i("c937"),_=i("21b7"),p=i("e2a6"),f=i("8e1f"),m=i("2642"),b=i("722e"),g=i("82ba"),y=i("e2aa"),S=i("6f7c"),x=i("cedf"),O=i("235f"),C=i("a47e"),v=i("7a95"),T=i("3ba0"),A=i("3e8a"),I=i("4a2d"),w=i("77df"),E=i("f00f"),P=i("8289"),D=i("f73c"),j=i("97be"),L=i("dc6c"),R=i("52d3"),M=i("c7d4");const B=new s["a"],U=P["a"].ModelState;function N(e){e=Object(u["a"])(e,u["a"].EMPTY_OBJECT);let t=e.gltf;if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),!(t instanceof Uint8Array))throw new y["a"]("Only binary glTF is supported as a classifier.");t=Object(A["a"])(t),Object(I["a"])(t),Object(O["a"])(t),Object(D["a"])(t),Object(j["a"])(t),C["a"].buffer(t,(function(e){if(!Object(l["a"])(e.extras._pipeline.source))throw new y["a"]("Buffer data must be embedded in the binary gltf.")}));const i=t.nodes,n=t.meshes,s=i[0],o=s.mesh;if(1!==i.length||!Object(l["a"])(o))throw new y["a"]("Only one node is supported for classification and it must have a mesh.");if(1!==n.length)throw new y["a"]("Only one mesh is supported when using b3dm for classification.");const r=n[0].primitives;if(1!==r.length)throw new y["a"]("Only one primitive per mesh is supported when using b3dm for classification.");const c=r[0].attributes.POSITION;if(!Object(l["a"])(c))throw new y["a"]("The mesh must have a position attribute.");const d=r[0].attributes._BATCHID;if(!Object(l["a"])(d))throw new y["a"]("The mesh must have a batch id attribute.");this._gltf=t,this.show=Object(u["a"])(e.show,!0),this.modelMatrix=b["a"].clone(Object(u["a"])(e.modelMatrix,b["a"].IDENTITY)),this._modelMatrix=b["a"].clone(this.modelMatrix),this._ready=!1,this._readyPromise=Object(h["a"])(),this.debugShowBoundingVolume=Object(u["a"])(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(u["a"])(e.debugWireframe,!1),this._debugWireframe=!1,this._classificationType=e.classificationType,this._vertexShaderLoaded=e.vertexShaderLoaded,this._classificationShaderLoaded=e.classificationShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(u["a"])(e.ignoreCommands,!1),this._upAxis=Object(u["a"])(e.upAxis,w["a"].Y),this._batchTable=e.batchTable,this._computedModelMatrix=new b["a"],this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new a["a"],this._state=U.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._dirty=!1,this._nodeMatrix=new b["a"],this._primitive=void 0,this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms=void 0,this._buffers={},this._vertexArray=void 0,this._shaderProgram=void 0,this._uniformMap=void 0,this._geometryByteLength=0,this._trianglesLength=0,this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0}function k(e){const t=e.gltf,i=e._loadResources;C["a"].buffer(t,(function(e,t){i.buffers[t]=e.extras._pipeline.source}))}function F(e){const t=e.gltf.bufferViews,i=e._loadResources.vertexBuffersToCreate;C["a"].bufferView(e.gltf,(function(e,t){e.target===x["a"].ARRAY_BUFFER&&i.enqueue(t)}));const n=e._loadResources.indexBuffersToCreate,a={};C["a"].accessor(e.gltf,(function(e){const i=e.bufferView,s=t[i];s.target!==x["a"].ELEMENT_ARRAY_BUFFER||Object(l["a"])(a[i])||(a[i]=!0,n.enqueue({id:i,componentType:e.componentType}))}))}function V(e,t){const i=t._loadResources,n=t.gltf.bufferViews,a=n[e],s=i.getBuffer(a);t._buffers[e]=s,t._geometryByteLength+=s.byteLength}function z(e,t,i){const n=i._loadResources,a=i.gltf.bufferViews,s=a[e],o={typedArray:n.getBuffer(s),indexDatatype:t};i._buffers[e]=o,i._geometryByteLength+=o.typedArray.byteLength}function W(e){const t=e._loadResources;if(0!==t.pendingBufferLoads)return;const i=t.vertexBuffersToCreate,n=t.indexBuffersToCreate;while(i.length>0)V(i.dequeue(),e);while(n.length>0){const t=n.dequeue();z(t.id,t.componentType,e)}}function G(e,t){const i=t.gltf.meshes[0].primitives[0],n=P["a"].modifyShaderForQuantizedAttributes(t.gltf,i,e);return t._quantizedUniforms=n.uniforms,n.shader}function q(e,t){return Object(l["a"])(t)&&(e=t(e)),e}function Y(e){const t=e.gltf,i=P["a"].getAttributeOrUniformBySemantic(t,"POSITION"),n=P["a"].getAttributeOrUniformBySemantic(t,"_BATCHID"),a={};a[i]=0,a[n]=1;const s=P["a"].getAttributeOrUniformBySemantic(t,"MODELVIEWPROJECTION");let o,r;if(Object(l["a"])(s))o=`uniform mat4 ${s};\n`,r=`${s} * vec4(${i}, 1.0)`;else{const e=P["a"].getAttributeOrUniformBySemantic(t,"PROJECTION");let n=P["a"].getAttributeOrUniformBySemantic(t,"MODELVIEW");Object(l["a"])(n)||(n=P["a"].getAttributeOrUniformBySemantic(t,"CESIUM_RTC_MODELVIEW")),o=`uniform mat4 ${n};\nuniform mat4 ${e};\n`,r=`${e} * ${n} * vec4(${i}, 1.0)`}const c=`    vec4 positionInClipCoords = ${r};\n`;let d=`attribute vec3 ${i};\nattribute float ${n};\n${o}void main() {\n${c}    gl_Position = czm_depthClamp(positionInClipCoords);\n}\n`;const u="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeDepthClamp();\n}\n";e.extensionsUsed.WEB3D_quantized_attributes&&(d=G(d,e));const h=q(d,e._vertexShaderLoaded),_=q(u,e._classificationShaderLoaded);e._shaderProgram={vertexShaderSource:h,fragmentShaderSource:_,attributeLocations:a}}function H(){return{POSITION:0,_BATCHID:1}}function X(e){const t=e._loadResources;if(!t.finishedBuffersCreation()||Object(l["a"])(e._vertexArray))return;const i=e._buffers,n=e.gltf,a=n.accessors,s=n.meshes,o=s[0].primitives,r=o[0],c=H(),d={};let u;if(C["a"].meshPrimitiveAttribute(r,(function(e,t){const s=c[t];if(Object(l["a"])(s)){const o=a[e];d[t]={index:s,vertexBuffer:i[o.bufferView],componentsPerAttribute:Object(T["a"])(o.type),componentDatatype:o.componentType,offsetInBytes:o.byteOffset,strideInBytes:Object(v["a"])(n,o)}}})),Object(l["a"])(r.indices)){const e=a[r.indices];u=i[e.bufferView]}e._vertexArray={attributes:d,indexBuffer:u}}Object.defineProperties(N.prototype,{gltf:{get:function(){return this._gltf}},boundingSphere:{get:function(){if(this._state!==U.LOADED)throw new p["a"]("The model is not loaded.  Use ClassificationModel.readyPromise or wait for ClassificationModel.ready to be true.");const e=this.modelMatrix,t=b["a"].getScale(e,B),i=this._scaledBoundingSphere;return i.center=s["a"].multiplyComponents(this._boundingSphere.center,t,i.center),i.radius=s["a"].maximumComponent(t)*this._initialRadius,Object(l["a"])(this._rtcCenter)&&s["a"].add(this._rtcCenter,i.center,i.center),i}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},dirty:{get:function(){return this._dirty}},extensionsUsed:{get:function(){return Object(l["a"])(this._extensionsUsed)||(this._extensionsUsed=P["a"].getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(l["a"])(this._extensionsRequired)||(this._extensionsRequired=P["a"].getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return 0}},classificationType:{get:function(){return this._classificationType}}});const Z={PROJECTION:function(e,t){return P["a"].getGltfSemanticUniforms().PROJECTION(e,t)},MODELVIEW:function(e,t){return P["a"].getGltfSemanticUniforms().MODELVIEW(e,t)},CESIUM_RTC_MODELVIEW:function(e,t){return P["a"].getGltfSemanticUniforms().CESIUM_RTC_MODELVIEW(e,t)},MODELVIEWPROJECTION:function(e,t){return P["a"].getGltfSemanticUniforms().MODELVIEWPROJECTION(e,t)}};function $(e,t){if(Object(l["a"])(e._uniformMap))return;const i={};C["a"].technique(e.gltf,(function(n){C["a"].techniqueUniform(n,(function(n,a){Object(l["a"])(n.semantic)&&Object(l["a"])(Z[n.semantic])&&(i[a]=Z[n.semantic](t.uniformState,e))}))})),e._uniformMap=i}function Q(e,t){return P["a"].createUniformsForQuantizedAttributes(e.gltf,t,e._quantizedUniforms)}function J(e,t){switch(e.mode){case g["a"].TRIANGLES:return t/3;case g["a"].TRIANGLE_STRIP:case g["a"].TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function K(e){const t=e._batchTable;let i=e._uniformMap;const o=e._vertexArray,u=e.gltf,h=u.accessors,_=u.meshes,p=_[0].primitives[0],f=h[p.indices],g=p.attributes.POSITION,y=P["a"].getAccessorMinMax(u,g),S=a["a"].fromCornerPoints(s["a"].fromArray(y.min),s["a"].fromArray(y.max));let x,O;if(Object(l["a"])(f))O=f.count,x=f.byteOffset/m["a"].getSizeInBytes(f.componentType);else{const e=h[p.attributes.POSITION];O=e.count,x=0}if(e._trianglesLength+=J(p,O),Object(l["a"])(e._uniformMapLoaded)&&(i=e._uniformMapLoaded(i)),e.extensionsUsed.WEB3D_quantized_attributes){const t=Q(e,p);i=Object(c["a"])(i,t)}let C=o.attributes.POSITION,v=C.componentDatatype,T=C.vertexBuffer,A=T.byteOffset,I=T.byteLength/d["a"].getSizeInBytes(v),w=d["a"].createArrayBufferView(v,T.buffer,A,I);C=o.attributes._BATCHID,v=C.componentDatatype,T=C.vertexBuffer,A=T.byteOffset,I=T.byteLength/d["a"].getSizeInBytes(v);let E=d["a"].createArrayBufferView(v,T.buffer,A,I);const D=o.indexBuffer.typedArray;let j;j=o.indexBuffer.indexDatatype===m["a"].UNSIGNED_SHORT?new Uint16Array(D.buffer,D.byteOffset,D.byteLength/Uint16Array.BYTES_PER_ELEMENT):new Uint32Array(D.buffer,D.byteOffset,D.byteLength/Uint32Array.BYTES_PER_ELEMENT),w=Object(n["a"])(w),E=Object(n["a"])(E),j=Object(n["a"])(j,x,x+O);const L=[],B=[],U=[],N=[];let k,F,V,z=E[j[0]];L.push(z),U.push(0);const W=j.length;for(let n=1;n<W;++n)k=E[j[n]],k!==z&&(F=U[U.length-1],V=n-F,L.push(k),B.push(V),U.push(n),N.push(new R["a"]({offset:F,count:V,batchIds:[z],color:r["a"].WHITE})),z=k);F=U[U.length-1],V=W-F,B.push(V),N.push(new R["a"]({offset:F,count:V,batchIds:[z],color:r["a"].WHITE}));const G=e._shaderProgram,q=G.vertexShaderSource,Y=G.fragmentShaderSource,H=G.attributeLocations,X=Object(l["a"])(e._pickIdLoaded)?e._pickIdLoaded():void 0;e._primitive=new M["a"]({classificationType:e._classificationType,positions:w,indices:j,indexOffsets:U,indexCounts:B,batchIds:L,vertexBatchIds:E,batchedIndices:N,batchTable:t,boundingVolume:new a["a"],_vertexShaderSource:q,_fragmentShaderSource:Y,_attributeLocations:H,_uniformMap:i,_pickId:X,_modelMatrix:new b["a"],_boundingSphere:S}),e._buffers=void 0,e._vertexArray=void 0,e._shaderProgram=void 0,e._uniformMap=void 0}function ee(e){const t=e._loadResources;if(!t.finished())return;if(Object(l["a"])(e._primitive))return;const i=e.gltf,n=i.nodes,a=n[0];e._nodeMatrix=P["a"].getTransform(a,e._nodeMatrix),K(e)}function te(e,t){const i=t.context;P["a"].checkSupportedGlExtensions(e.gltf.glExtensionsUsed,i),W(e),Y(e),X(e),$(e,i),ee(e)}const ie=new o["a"],ne=new b["a"];function ae(e,t,i,n){let r=e._computedModelMatrix;if(e._mode!==L["a"].SCENE3D&&!e._ignoreCommands){const t=b["a"].getColumn(r,3,ie);if(o["a"].equals(t,o["a"].UNIT_W)){const t=e.boundingSphere.center,i=S["a"].wgs84To2DModelMatrix(n,t,ne);r=b["a"].multiply(i,r,ne),Object(l["a"])(e._rtcCenter)&&(b["a"].setTranslation(r,o["a"].UNIT_W,r),e._rtcCenter=e._rtcCenter2D)}else r=S["a"].basisTo2D(n,r,ne),e._rtcCenter=e._rtcCenter3D}const c=e._primitive;(t||i)&&(b["a"].multiplyTransformation(r,e._nodeMatrix,c._modelMatrix),a["a"].transform(c._boundingSphere,c._modelMatrix,c._boundingVolume),Object(l["a"])(e._rtcCenter)&&s["a"].add(e._rtcCenter,c._boundingVolume.center,c._boundingVolume.center))}N.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},N.prototype.update=function(e){if(e.mode===L["a"].MORPHING)return;if(!f["a"].supportsWebP.initialized)return void f["a"].supportsWebP.initialize();const t=f["a"].supportsWebP();if(this._state===U.NEEDS_LOAD&&Object(l["a"])(this.gltf)&&(this._state=U.LOADING,this._state!==U.FAILED)){const t=this.gltf.extensions;if(Object(l["a"])(t)&&Object(l["a"])(t.CESIUM_RTC)){const i=s["a"].fromArray(t.CESIUM_RTC.center);if(!s["a"].equals(i,s["a"].ZERO)){this._rtcCenter3D=i;const t=e.mapProjection,n=t.ellipsoid,a=n.cartesianToCartographic(this._rtcCenter3D),o=t.project(a);s["a"].fromElements(o.z,o.x,o.y,o),this._rtcCenter2D=o,this._rtcCenterEye=new s["a"],this._rtcCenter=this._rtcCenter3D}}this._loadResources=new E["a"],P["a"].parseBuffers(this)}const i=this._loadResources;let n=!1;this._state===U.LOADING&&(0===i.pendingBufferLoads&&(P["a"].checkSupportedExtensions(this.extensionsRequired,t),k(this),F(this),this._boundingSphere=P["a"].computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,te(this,e)),i.finished()&&(this._state=U.LOADED,n=!0)),Object(l["a"])(i)&&this._state===U.LOADED&&(n||te(this,e),i.finished()&&(this._loadResources=void 0));const a=this.show;if(a&&this._state===U.LOADED||n){this._dirty=!1;const t=this.modelMatrix,i=e.mode!==this._mode;this._mode=e.mode;const a=!b["a"].equals(this._modelMatrix,t)||i;if(a||n){b["a"].clone(t,this._modelMatrix);const e=this._computedModelMatrix;b["a"].clone(t,e),this._upAxis===w["a"].Y?b["a"].multiplyTransformation(e,w["a"].Y_UP_TO_Z_UP,e):this._upAxis===w["a"].X&&b["a"].multiplyTransformation(e,w["a"].X_UP_TO_Z_UP,e)}(a||n)&&(ae(this,a,n,e.mapProjection),this._dirty=!0)}if(n){const t=this;e.afterRender.push((function(){t._ready=!0,t._readyPromise.resolve(t)}))}else a&&!this._ignoreCommands&&(this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.debugWireframe=this.debugWireframe,this._primitive.update(e))},N.prototype.isDestroyed=function(){return!1},N.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),Object(_["a"])(this)},t["a"]=N},"4a43":function(e,t,i){"use strict";const n={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2,NUMBER_OF_CLASSIFICATION_TYPES:3};t["a"]=Object.freeze(n)},"936e":function(e,t,i){"use strict";var n=i("dde0"),a=i("ae9b"),s=i("c937");function o(e,t){a["a"].typeOf.object("normal",e),a["a"].typeOf.number("distance",t),this._distance=t,this._normal=new r(e,this),this.onChangeCallback=void 0,this.index=-1}function r(e,t){this._clippingPlane=t,this._cartesian3=n["a"].clone(e)}Object.defineProperties(o.prototype,{distance:{get:function(){return this._distance},set:function(e){a["a"].typeOf.number("value",e),Object(s["a"])(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){a["a"].typeOf.object("value",e),Object(s["a"])(this.onChangeCallback)&&!n["a"].equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),n["a"].clone(e,this._normal._cartesian3)}}}),o.fromPlane=function(e,t){return a["a"].typeOf.object("plane",e),Object(s["a"])(t)?(t.normal=e.normal,t.distance=e.distance):t=new o(e.normal,e.distance),t},o.clone=function(e,t){return Object(s["a"])(t)?(t.normal=e.normal,t.distance=e.distance,t):new o(e.normal,e.distance)},Object.defineProperties(r.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){a["a"].typeOf.number("value",e),Object(s["a"])(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){a["a"].typeOf.number("value",e),Object(s["a"])(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){a["a"].typeOf.number("value",e),Object(s["a"])(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}}),t["a"]=o},"9cdf":function(e,t,i){"use strict";const n={CUMULUS:0,validate:function(e){return e===n.CUMULUS}};t["a"]=Object.freeze(n)},ab21:function(e,t,i){"use strict";var n=i("dde0"),a=i("ae9b"),s=i("1a5d"),o=i("b8b5");function r(e){e=Object(s["a"])(e,1),a["a"].typeOf.number.greaterThan("radius",e,0),this._radius=Object(s["a"])(e,1)}Object.defineProperties(r.prototype,{radius:{get:function(){return this._radius},set:function(e){a["a"].typeOf.number.greaterThan("value",e,0),this._radius=e}}}),r.prototype.emit=function(e){const t=o["a"].randomBetween(0,o["a"].TWO_PI),i=o["a"].randomBetween(0,this._radius),a=i*Math.cos(t),s=i*Math.sin(t),r=0;e.position=n["a"].fromElements(a,s,r,e.position),e.velocity=n["a"].clone(n["a"].UNIT_Z,e.velocity)},t["a"]=r},b483:function(e,t,i){"use strict";var n=i("ed17"),a=i("2fad"),s=i("1a5d"),o=i("61ad"),r=i("c937"),c=i("21b7"),d=i("e2a6"),u=i("e8ff"),h=i("d5cf"),l=i("51f2"),_=i("5027"),p=i("8f7d"),f=i("b3ce"),m=i("51f4"),b=i("0b8b"),g=i("da23"),y=i("4a43"),S=i("0650"),x=i("1f21"),O=i("5769"),C=i("dc6c"),v=i("2773"),T=i("8d2f"),A=i("79a2"),I=i("20f8");function w(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT);const t=e.geometryInstances;this.geometryInstances=t,this.show=Object(s["a"])(e.show,!0),this.classificationType=Object(s["a"])(e.classificationType,y["a"].BOTH),this.debugShowBoundingVolume=Object(s["a"])(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=Object(s["a"])(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=Object(s["a"])(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1,this._readyPromise=Object(o["a"])(),this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:Object(s["a"])(e.vertexCacheOptimize,!1),interleave:Object(s["a"])(e.interleave,!1),releaseGeometryInstances:Object(s["a"])(e.releaseGeometryInstances,!0),allowPicking:Object(s["a"])(e.allowPicking,!0),asynchronous:Object(s["a"])(e.asynchronous,!0),compressVertices:Object(s["a"])(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}function E(e,t){const i=t?A["a"].EQUAL:A["a"].ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:i,frontOperation:{fail:I["a"].KEEP,zFail:I["a"].DECREMENT_WRAP,zPass:I["a"].KEEP},backFunction:i,backOperation:{fail:I["a"].KEEP,zFail:I["a"].INCREMENT_WRAP,zPass:I["a"].KEEP},reference:T["a"].CESIUM_3D_TILE_MASK,mask:T["a"].CESIUM_3D_TILE_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!0,func:S["a"].LESS_OR_EQUAL},depthMask:!1}}function P(e){return{stencilTest:{enabled:e,frontFunction:A["a"].NOT_EQUAL,frontOperation:{fail:I["a"].ZERO,zFail:I["a"].ZERO,zPass:I["a"].ZERO},backFunction:A["a"].NOT_EQUAL,backOperation:{fail:I["a"].ZERO,zFail:I["a"].ZERO,zPass:I["a"].ZERO},reference:0,mask:T["a"].CLASSIFICATION_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:g["a"].PRE_MULTIPLIED_ALPHA_BLEND}}Object.defineProperties(w.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}}),w.isSupported=function(e){return e.context.stencilBuffer};const D={stencilTest:{enabled:!0,frontFunction:A["a"].NOT_EQUAL,frontOperation:{fail:I["a"].ZERO,zFail:I["a"].ZERO,zPass:I["a"].ZERO},backFunction:A["a"].NOT_EQUAL,backOperation:{fail:I["a"].ZERO,zFail:I["a"].ZERO,zPass:I["a"].ZERO},reference:0,mask:T["a"].CLASSIFICATION_MASK},stencilMask:T["a"].CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function j(e,t,i,n){if(Object(r["a"])(e._rsStencilDepthPass))return;const a=!e.debugShowShadowVolume;e._rsStencilDepthPass=_["a"].fromCache(E(a,!1)),e._rsStencilDepthPass3DTiles=_["a"].fromCache(E(a,!0)),e._rsColorPass=_["a"].fromCache(P(a,!1)),e._rsPickPass=_["a"].fromCache(D)}function L(e,t){if(!e.compressVertices)return t;if(-1!==t.search(/attribute\s+vec3\s+extrudeDirection;/g)){const e="compressedAttributes",i=`attribute vec2 ${e};`,n="vec3 extrudeDirection;\n",a=`    extrudeDirection = czm_octDecode(${e}, 65535.0);\n`;let s=t;s=s.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),s=f["a"].replaceMain(s,"czm_non_compressed_main");const o=`void main() \n{ \n${a}    czm_non_compressed_main(); \n}`;return[i,n,s,o].join("\n")}}function R(e,t){const i=t.context,n=e._primitive;let a=m["a"];a=e._primitive._batchTable.getVertexShaderCallback()(a),a=O["a"]._appendDistanceDisplayConditionToShader(n,a),a=O["a"]._modifyShaderPosition(e,a,t.scene3DOnly),a=O["a"]._updateColorAttribute(n,a);const s=e._hasPlanarExtentsAttributes,o=s||e._hasSphericalExtentsAttribute;e._extruded&&(a=L(n,a));const c=e._extruded?"EXTRUDED_GEOMETRY":"";let d=new f["a"]({defines:[c],sources:[a]});const u=new f["a"]({sources:[b["a"]]}),h=e._primitive._attributeLocations,l=new v["a"](o,s,e.appearance);if(e._spStencil=p["a"].replaceCache({context:i,shaderProgram:e._spStencil,vertexShaderSource:d,fragmentShaderSource:u,attributeLocations:h}),e._primitive.allowPicking){let s=f["a"].createPickVertexShaderSource(a);s=O["a"]._appendShowToShader(n,s),s=O["a"]._updatePickColorAttribute(s);const d=l.createPickFragmentShader(!1),u=l.createPickVertexShader([c],s,!1,t.mapProjection);if(e._spPick=p["a"].replaceCache({context:i,shaderProgram:e._spPick,vertexShaderSource:u,fragmentShaderSource:d,attributeLocations:h}),o){let n=i.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!Object(r["a"])(n)){const a=l.createPickFragmentShader(!0),o=l.createPickVertexShader([c],s,!0,t.mapProjection);n=i.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:h})}e._spPick2D=n}}else e._spPick=p["a"].fromCache({context:i,vertexShaderSource:d,fragmentShaderSource:u,attributeLocations:h});a=O["a"]._appendShowToShader(n,a),d=new f["a"]({defines:[c],sources:[a]}),e._sp=p["a"].replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:d,fragmentShaderSource:u,attributeLocations:h});const _=l.createFragmentShader(!1),g=l.createVertexShader([c],a,!1,t.mapProjection);if(e._spColor=p["a"].replaceCache({context:i,shaderProgram:e._spColor,vertexShaderSource:g,fragmentShaderSource:_,attributeLocations:h}),o){let n=i.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!Object(r["a"])(n)){const s=l.createFragmentShader(!0),o=l.createVertexShader([c],a,!0,t.mapProjection);n=i.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:o,fragmentShaderSource:s,attributeLocations:h})}e._spColor2D=n}}function M(e,t){const i=e._primitive;let n,s,o,c=2*i._va.length;t.length=c;let d=0,u=i._batchTable.getUniformMapCallback()(e._uniformMap);const _=e._needs2DShader;for(n=0;n<c;n+=2){const c=i._va[d++];s=t[n],Object(r["a"])(s)||(s=t[n]=new h["a"]({owner:e,primitiveType:i._primitiveType})),s.vertexArray=c,s.renderState=e._rsStencilDepthPass,s.shaderProgram=e._sp,s.uniformMap=u,s.pass=l["a"].TERRAIN_CLASSIFICATION,o=h["a"].shallowClone(s,s.derivedCommands.tileset),o.renderState=e._rsStencilDepthPass3DTiles,o.pass=l["a"].CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=o,s=t[n+1],Object(r["a"])(s)||(s=t[n+1]=new h["a"]({owner:e,primitiveType:i._primitiveType})),s.vertexArray=c,s.renderState=e._rsColorPass,s.shaderProgram=e._spColor,s.pass=l["a"].TERRAIN_CLASSIFICATION;const p=e.appearance,f=p.material;if(Object(r["a"])(f)&&(u=Object(a["a"])(u,f._uniforms)),s.uniformMap=u,o=h["a"].shallowClone(s,s.derivedCommands.tileset),o.pass=l["a"].CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=o,_){let t=h["a"].shallowClone(s,s.derivedCommands.appearance2D);t.shaderProgram=e._spColor2D,s.derivedCommands.appearance2D=t,t=h["a"].shallowClone(o,o.derivedCommands.appearance2D),t.shaderProgram=e._spColor2D,o.derivedCommands.appearance2D=t}}const p=e._commandsIgnoreShow,f=e._spStencil;let m=0;c=p.length=c/2;for(let a=0;a<c;++a){const e=p[a]=h["a"].shallowClone(t[m],p[a]);e.shaderProgram=f,e.pass=l["a"].CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,m+=2}}function B(e,t){const i=e._usePickOffsets,n=e._primitive;let a,s,o,c,d,u=2*n._va.length,_=0;i&&(a=n._pickOffsets,u=2*a.length),t.length=u;let p=0;const f=n._batchTable.getUniformMapCallback()(e._uniformMap),m=e._needs2DShader;for(o=0;o<u;o+=2){let u=n._va[p++];if(i&&(s=a[_++],u=n._va[s.index]),c=t[o],Object(r["a"])(c)||(c=t[o]=new h["a"]({owner:e,primitiveType:n._primitiveType,pickOnly:!0})),c.vertexArray=u,c.renderState=e._rsStencilDepthPass,c.shaderProgram=e._sp,c.uniformMap=f,c.pass=l["a"].TERRAIN_CLASSIFICATION,i&&(c.offset=s.offset,c.count=s.count),d=h["a"].shallowClone(c,c.derivedCommands.tileset),d.renderState=e._rsStencilDepthPass3DTiles,d.pass=l["a"].CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=d,c=t[o+1],Object(r["a"])(c)||(c=t[o+1]=new h["a"]({owner:e,primitiveType:n._primitiveType,pickOnly:!0})),c.vertexArray=u,c.renderState=e._rsPickPass,c.shaderProgram=e._spPick,c.uniformMap=f,c.pass=l["a"].TERRAIN_CLASSIFICATION,i&&(c.offset=s.offset,c.count=s.count),d=h["a"].shallowClone(c,c.derivedCommands.tileset),d.pass=l["a"].CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=d,m){let t=h["a"].shallowClone(c,c.derivedCommands.pick2D);t.shaderProgram=e._spPick2D,c.derivedCommands.pick2D=t,t=h["a"].shallowClone(d,d.derivedCommands.pick2D),t.shaderProgram=e._spPick2D,d.derivedCommands.pick2D=t}}}function U(e,t,i,n,a,s,o){M(e,s),B(e,o)}function N(e,t){return Math.floor(e%t/2)}function k(e,t,i,n,a,s){e.modelMatrix=i,e.boundingVolume=a,e.cull=n,e.debugShowBoundingVolume=s,t.commandList.push(e)}function F(e,t,i,n,a){e.modelMatrix=i,e.boundingVolume=a,e.cull=n,t.commandList.push(e)}function V(e,t,i,n,a,s,o,c){const d=e._primitive;let u;O["a"]._updateBoundingVolumes(d,t,a),t.mode===C["a"].SCENE3D?u=d._boundingSphereWC:t.mode===C["a"].COLUMBUS_VIEW?u=d._boundingSphereCV:t.mode===C["a"].SCENE2D&&Object(r["a"])(d._boundingSphere2D)?u=d._boundingSphere2D:Object(r["a"])(d._boundingSphereMorph)&&(u=d._boundingSphereMorph);const h=e.classificationType,l=h!==y["a"].CESIUM_3D_TILE,_=h!==y["a"].TERRAIN,p=t.passes;let f,m,b;if(p.render){const n=i.length;for(f=0;f<n;++f)m=u[N(f,n)],l&&(b=i[f],k(b,t,a,s,m,o)),_&&(b=i[f].derivedCommands.tileset,k(b,t,a,s,m,o));if(t.invertClassification){const i=e._commandsIgnoreShow,n=i.length;for(f=0;f<n;++f)m=u[f],b=i[f],k(b,t,a,s,m,o)}}if(p.pick){const e=n.length,i=d._pickOffsets;for(f=0;f<e;++f){const o=i[N(f,e)];m=u[o.index],l&&(b=n[f],F(b,t,a,s,m)),_&&(b=n[f].derivedCommands.tileset,F(b,t,a,s,m))}}}w.prototype.update=function(e){if(!Object(r["a"])(this._primitive)&&!Object(r["a"])(this.geometryInstances))return;let t=this.appearance;Object(r["a"])(t)&&Object(r["a"])(t.material)&&t.material.update(e.context);const i=this,a=this._primitiveOptions;if(!Object(r["a"])(this._primitive)){const e=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],o=e.length;let c,h,l,_,p=!1,f=!0,m=!1,b=!1;for(o>0&&(l=e[0].attributes,m=v["a"].hasAttributesForSphericalExtents(l),b=v["a"].hasAttributesForTextureCoordinatePlanes(l),_=l.color),c=0;c<o;c++){h=e[c];const t=h.attributes.color;if(Object(r["a"])(t))p=!0;else if(p)throw new d["a"]("All GeometryInstances must have color attributes to use per-instance color.");f=f&&Object(r["a"])(t)&&n["a"].equals(_,t)}if(!f&&!m&&!b)throw new d["a"]("All GeometryInstances must have the same color attribute except via GroundPrimitives");if(p&&!Object(r["a"])(t)&&(t=new x["a"]({flat:!0}),this.appearance=t),!p&&t instanceof x["a"])throw new d["a"]("PerInstanceColorAppearance requires color GeometryInstanceAttributes on all GeometryInstances");if(Object(r["a"])(t.material)&&!m&&!b)throw new d["a"]("Materials on ClassificationPrimitives are not supported except via GroundPrimitives");this._usePickOffsets=!m&&!b,this._hasSphericalExtentsAttribute=m,this._hasPlanarExtentsAttributes=b,this._hasPerColorAttribute=p;const g=new Array(o);for(c=0;c<o;++c)h=e[c],g[c]=new u["a"]({geometry:h.geometry,attributes:h.attributes,modelMatrix:h.modelMatrix,id:h.id,pickPrimitive:Object(s["a"])(this._pickPrimitive,i)});a.appearance=t,a.geometryInstances=g,Object(r["a"])(this._createBoundingVolumeFunction)&&(a._createBoundingVolumeFunction=function(e,t){i._createBoundingVolumeFunction(e,t)}),a._createRenderStatesFunction=function(e,t,n,a){j(i,t)},a._createShaderProgramFunction=function(e,t,n){R(i,t)},a._createCommandsFunction=function(e,t,n,a,s,o,r){U(i,void 0,void 0,!0,!1,o,r)},Object(r["a"])(this._updateAndQueueCommandsFunction)?a._updateAndQueueCommandsFunction=function(e,t,n,a,s,o,r,c){i._updateAndQueueCommandsFunction(e,t,n,a,s,o,r,c)}:a._updateAndQueueCommandsFunction=function(e,t,n,a,s,o,r,c){V(i,t,n,a,s,o,r,c)},this._primitive=new O["a"](a),this._primitive.readyPromise.then((function(e){i._ready=!0,i.releaseGeometryInstances&&(i.geometryInstances=void 0);const t=e._error;Object(r["a"])(t)?i._readyPromise.reject(t):i._readyPromise.resolve(i)}))}if(this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilDepthPass=_["a"].fromCache(E(!1,!1)),this._rsStencilDepthPass3DTiles=_["a"].fromCache(E(!1,!0)),this._rsColorPass=_["a"].fromCache(P(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilDepthPass=_["a"].fromCache(E(!0,!1)),this._rsStencilDepthPass3DTiles=_["a"].fromCache(E(!0,!0)),this._rsColorPass=_["a"].fromCache(P(!0))),this._primitive.appearance!==t){if(!this._hasSphericalExtentsAttribute&&!this._hasPlanarExtentsAttributes&&Object(r["a"])(t.material))throw new d["a"]("Materials on ClassificationPrimitives are not supported except via GroundPrimitive");if(!this._hasPerColorAttribute&&t instanceof x["a"])throw new d["a"]("PerInstanceColorAppearance requires color GeometryInstanceAttribute");this._primitive.appearance=t}this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)},w.prototype.getGeometryInstanceAttributes=function(e){if(!Object(r["a"])(this._primitive))throw new d["a"]("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},w.prototype.isDestroyed=function(){return!1},w.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,Object(c["a"])(this)},t["a"]=w},bd5e:function(e,t,i){"use strict";var n=i("cf26"),a=i("85b2"),s=i("dde0"),o=i("6b82"),r=i("ae9b"),c=i("4051"),d=i("1a5d"),u=i("c937"),h=i("21b7"),l=i("e2a6"),_=i("f7b5"),p=i("a61d"),f=i("722e"),m=i("0238"),b=i("a7b2"),g=i("2341"),y=i("1494"),S=i("4d68"),x=i("1a75"),O=i("936e");function C(e){e=Object(d["a"])(e,d["a"].EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=Object(d["a"])(e.enabled,!0),this.modelMatrix=f["a"].clone(Object(d["a"])(e.modelMatrix,f["a"].IDENTITY)),this.edgeColor=c["a"].clone(Object(d["a"])(e.edgeColor,c["a"].WHITE)),this.edgeWidth=Object(d["a"])(e.edgeWidth,0),this.planeAdded=new _["a"],this.planeRemoved=new _["a"],this._owner=void 0;const t=Object(d["a"])(e.unionClippingRegions,!1);this._unionClippingRegions=t,this._testIntersection=t?v:T,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;const i=e.planes;if(Object(u["a"])(i)){const e=i.length;for(let t=0;t<e;++t)this.add(i[t])}}function v(e){return e===p["a"].OUTSIDE}function T(e){return e===p["a"].INSIDE}function A(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||-1!==e._dirtyIndex&&e._dirtyIndex!==t,e._dirtyIndex=t}function I(e,t){const i=e.length;for(let n=0;n<i;++n)if(b["a"].equals(e[n],t))return n;return-1}Object.defineProperties(C.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?v:T)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}}),C.prototype.add=function(e){const t=this._planes.length,i=this;e.onChangeCallback=function(e){A(i,e)},e.index=t,A(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)},C.prototype.get=function(e){return r["a"].typeOf.number("index",e),this._planes[e]},C.prototype.contains=function(e){return-1!==I(this._planes,e)},C.prototype.remove=function(e){const t=this._planes,i=I(t,e);if(-1===i)return!1;e instanceof O["a"]&&(e.onChangeCallback=void 0,e.index=-1);const n=t.length-1;for(let a=i;a<n;++a){const e=t[a+1];t[a]=e,e instanceof O["a"]&&(e.index=a)}return this._multipleDirtyPlanes=!0,t.length=n,this.planeRemoved.raiseEvent(e,i),!0},C.prototype.removeAll=function(){const e=this._planes,t=e.length;for(let i=0;i<t;++i){const t=e[i];t instanceof O["a"]&&(t.onChangeCallback=void 0,t.index=-1),this.planeRemoved.raiseEvent(t,i)}this._multipleDirtyPlanes=!0,this._planes=[]};const w=new o["a"],E=new o["a"];function P(e,t,i){const a=e._uint8View,s=e._planes;let r=0;for(let c=t;c<i;++c){const e=s[c],t=n["a"].octEncodeToCartesian4(e.normal,E);a[r]=t.x,a[r+1]=t.y,a[r+2]=t.z,a[r+3]=t.w;const i=o["a"].packFloat(e.distance,w);a[r+4]=i.x,a[r+5]=i.y,a[r+6]=i.z,a[r+7]=i.w,r+=8}}function D(e,t,i){const n=e._float32View,a=e._planes;let s=0;for(let o=t;o<i;++o){const e=a[o],t=e.normal;n[s]=t.x,n[s+1]=t.y,n[s+2]=t.z,n[s+3]=e.distance,s+=4}}function j(e,t){const i=g["a"].maximumTextureSize;return t.x=Math.min(e,i),t.y=Math.ceil(e/t.x),t}const L=new a["a"];C.prototype.update=function(e){let t=this._clippingPlanesTexture;const i=e.context,n=C.useFloatTexture(i),a=n?this.length:2*this.length;if(Object(u["a"])(t)){const e=t.width*t.height;(e<a||a<.25*e)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(0===this.length)return;if(!Object(u["a"])(t)){const e=j(a,L);e.y*=2,n?(t=new x["a"]({context:i,width:e.x,height:e.y,pixelFormat:m["a"].RGBA,pixelDatatype:y["a"].FLOAT,sampler:S["a"].NEAREST,flipY:!1}),this._float32View=new Float32Array(e.x*e.y*4)):(t=new x["a"]({context:i,width:e.x,height:e.y,pixelFormat:m["a"].RGBA,pixelDatatype:y["a"].UNSIGNED_BYTE,sampler:S["a"].NEAREST,flipY:!1}),this._uint8View=new Uint8Array(e.x*e.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}const s=this._dirtyIndex;if(this._multipleDirtyPlanes||-1!==s){if(this._multipleDirtyPlanes)n?(D(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._float32View}})):(P(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._uint8View}}));else{let e=0,i=0;n?(i=Math.floor(s/t.width),e=Math.floor(s-i*t.width),D(this,s,s+1),t.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:e,yOffset:i})):(i=Math.floor(2*s/t.width),e=Math.floor(2*s-i*t.width),P(this,s,s+1),t.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:e,yOffset:i}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};const R=new f["a"],M=new b["a"](s["a"].UNIT_X,0);C.prototype.computeIntersectionWithBoundingVolume=function(e,t){const i=this._planes,n=i.length;let a=this.modelMatrix;Object(u["a"])(t)&&(a=f["a"].multiply(t,a,R));let s=p["a"].INSIDE;!this.unionClippingRegions&&n>0&&(s=p["a"].OUTSIDE);for(let o=0;o<n;++o){const t=i[o];b["a"].transform(t,a,M);const n=e.intersectPlane(M);if(n===p["a"].INTERSECTING)s=n;else if(this._testIntersection(n))return n}return s},C.setOwner=function(e,t,i){if(e!==t[i]&&(t[i]=t[i]&&t[i].destroy(),Object(u["a"])(e))){if(Object(u["a"])(e._owner))throw new l["a"]("ClippingPlaneCollection should only be assigned to one object");e._owner=t,t[i]=e}},C.useFloatTexture=function(e){return e.floatingPointTexture},C.getTextureResolution=function(e,t,i){const n=e.texture;if(Object(u["a"])(n))return i.x=n.width,i.y=n.height,i;const a=C.useFloatTexture(t)?e.length:2*e.length,s=j(a,i);return s.y*=2,s},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),Object(h["a"])(this)},t["a"]=C},f204:function(e,t,i){"use strict";var n=i("da23"),a=i("6f54"),s=i("6ba7"),o=i("dde0"),r=i("ae9b"),c=i("4051"),d=i("f4c7"),u=i("9cdf"),h=i("2be3"),l=i("9aea"),_=i("4455"),p=i("d109"),f=i("cbf0"),m=i("adca"),b=i("1a5d"),g=i("c937"),y=i("21b7"),S=i("e2a6"),x=i("d5cf"),O=i("d809"),C=i("2642"),v=i("51f2"),T=i("1494"),A=i("0238"),I=i("5027"),w=i("4d68"),E=i("b3ce"),P=i("8f7d"),D=i("1a75"),j=i("50de"),L=i("518b"),R=i("2189"),M=i("dc15"),B=i("6384"),U=i("cedf");let N;const k=new o["a"],F={positionHighAndScaleX:0,positionLowAndScaleY:1,packedAttribute0:2,packedAttribute1:3,color:4},V={direction:0,positionHighAndScaleX:1,positionLowAndScaleY:2,packedAttribute0:3,packedAttribute1:4,color:5},z=m["a"].SHOW_INDEX,W=m["a"].POSITION_INDEX,G=m["a"].SCALE_INDEX,q=m["a"].MAXIMUM_SIZE_INDEX,Y=m["a"].SLICE_INDEX,H=m["a"].BRIGHTNESS_INDEX,X=m["a"].NUMBER_OF_PROPERTIES,Z=m["a"].COLOR_INDEX;function $(e){e=Object(b["a"])(e,b["a"].EMPTY_OBJECT),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(X),this._noiseTexture=void 0,this._textureSliceWidth=128,this._noiseTextureRows=4,this.noiseDetail=Object(b["a"])(e.noiseDetail,16),this.noiseOffset=o["a"].clone(Object(b["a"])(e.noiseOffset,o["a"].ZERO)),this._loading=!1,this._ready=!1;const t=this;this._uniforms={u_noiseTexture:function(){return t._noiseTexture},u_noiseTextureDimensions:Q(t),u_noiseDetail:function(){return t.noiseDetail}},this._vaNoise=void 0,this._spNoise=void 0,this._spCreated=!1,this._sp=void 0,this._rs=void 0,this.show=Object(b["a"])(e.show,!0),this._colorCommands=[],this.debugBillboards=Object(b["a"])(e.debugBillboards,!1),this._compiledDebugBillboards=!1,this.debugEllipsoids=Object(b["a"])(e.debugEllipsoids,!1),this._compiledDebugEllipsoids=!1}function Q(e){return function(){return k.x=e._textureSliceWidth,k.y=e._noiseTextureRows,k.z=1/e._noiseTextureRows,k}}function J(e){const t=e.length;for(let i=0;i<t;++i)e[i]&&e[i]._destroy()}function K(e){if(e._cloudsRemoved){e._cloudsRemoved=!1;const t=[],i=e._clouds,n=i.length;for(let e=0,a=0;e<n;++e){const n=i[e];Object(g["a"])(n)&&(i._index=a++,t.push(n))}e._clouds=t}}Object.defineProperties($.prototype,{length:{get:function(){return K(this),this._clouds.length}}}),$.prototype.add=function(e){e=Object(b["a"])(e,b["a"].EMPTY_OBJECT);const t=Object(b["a"])(e.cloudType,u["a"].CUMULUS);if(!u["a"].validate(t))throw new S["a"]("invalid cloud type");let i;return t===u["a"].CUMULUS&&(i=new m["a"](e,this),i._index=this._clouds.length,this._clouds.push(i),this._createVertexArray=!0),i},$.prototype.remove=function(e){return!!this.contains(e)&&(this._clouds[e._index]=void 0,this._cloudsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},$.prototype.removeAll=function(){J(this._clouds),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!0},$.prototype._updateCloud=function(e,t){e._dirty||(this._cloudsToUpdate[this._cloudsToUpdateIndex++]=e),++this._propertiesChanged[t]},$.prototype.contains=function(e){return Object(g["a"])(e)&&e._cloudCollection===this},$.prototype.get=function(e){return r["a"].typeOf.number("index",e),K(this),this._clouds[e]};const ee=new Float32Array([-1,-1,1,-1,1,1,-1,1]),te=new Uint16Array([0,1,2,0,2,3]);function ie(e){const t=a["a"].createVertexBuffer({context:e,typedArray:ee,usage:s["a"].STATIC_DRAW}),i=a["a"].createIndexBuffer({context:e,typedArray:te,usage:s["a"].STATIC_DRAW,indexDatatype:C["a"].UNSIGNED_SHORT}),n=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:f["a"].FLOAT}];return new M["a"]({context:e,attributes:n,indexBuffer:i})}let ne;function ae(e){const t=16384;let i=e.cache.cloudCollection_indexBufferBatched;if(Object(g["a"])(i))return i;const n=6*t-6,o=new Uint16Array(n);for(let a=0,s=0;a<n;a+=6,s+=4)o[a]=s,o[a+1]=s+1,o[a+2]=s+2,o[a+3]=s,o[a+4]=s+2,o[a+5]=s+3;return i=a["a"].createIndexBuffer({context:e,typedArray:o,usage:s["a"].STATIC_DRAW,indexDatatype:C["a"].UNSIGNED_SHORT}),i.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferBatched=i,i}function se(e){let t=e.cache.cloudCollection_indexBufferInstanced;return Object(g["a"])(t)||(t=a["a"].createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:s["a"].STATIC_DRAW,indexDatatype:C["a"].UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferInstanced=t),t}function oe(e){let t=e.cache.cloudCollection_vertexBufferInstanced;return Object(g["a"])(t)||(t=a["a"].createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:s["a"].STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_vertexBufferInstanced=t),t}function re(e,t,i){const n=[{index:N.positionHighAndScaleX,componentsPerAttribute:4,componentDatatype:f["a"].FLOAT,usage:s["a"].STATIC_DRAW},{index:N.positionLowAndScaleY,componentsPerAttribute:4,componentDatatype:f["a"].FLOAT,usage:s["a"].STATIC_DRAW},{index:N.packedAttribute0,componentsPerAttribute:4,componentDatatype:f["a"].FLOAT,usage:s["a"].STATIC_DRAW},{index:N.packedAttribute1,componentsPerAttribute:4,componentDatatype:f["a"].FLOAT,usage:s["a"].STATIC_DRAW},{index:N.color,componentsPerAttribute:4,componentDatatype:f["a"].UNSIGNED_BYTE,normalize:!0,usage:s["a"].STATIC_DRAW}];i&&n.push({index:N.direction,componentsPerAttribute:2,componentDatatype:f["a"].FLOAT,vertexBuffer:oe(e)});const a=i?t:4*t;return new B["a"](e,n,a,i)}const ce=new O["a"];function de(e,t,i,n){let a;const s=i[N.positionHighAndScaleX],o=i[N.positionLowAndScaleY],r=n.position;O["a"].fromCartesian(r,ce);const c=n.scale,d=ce.high,u=ce.low;e._instanced?(a=n._index,s(a,d.x,d.y,d.z,c.x),o(a,u.x,u.y,u.z,c.y)):(a=4*n._index,s(a+0,d.x,d.y,d.z,c.x),s(a+1,d.x,d.y,d.z,c.x),s(a+2,d.x,d.y,d.z,c.x),s(a+3,d.x,d.y,d.z,c.x),o(a+0,u.x,u.y,u.z,c.y),o(a+1,u.x,u.y,u.z,c.y),o(a+2,u.x,u.y,u.z,c.y),o(a+3,u.x,u.y,u.z,c.y))}function ue(e,t,i,n){let a;const s=i[N.packedAttribute0],o=n.show,r=n.brightness;e._instanced?(a=n._index,s(a,o,r,0,0)):(a=4*n._index,s(a+0,o,r,0,0),s(a+1,o,r,1,0),s(a+2,o,r,1,1),s(a+3,o,r,0,1))}function he(e,t,i,n){let a;const s=i[N.packedAttribute1],o=n.maximumSize,r=n.slice;e._instanced?(a=n._index,s(a,o.x,o.y,o.z,r)):(a=4*n._index,s(a+0,o.x,o.y,o.z,r),s(a+1,o.x,o.y,o.z,r),s(a+2,o.x,o.y,o.z,r),s(a+3,o.x,o.y,o.z,r))}function le(e,t,i,n){let a;const s=i[N.color],o=n.color,r=c["a"].floatToByte(o.red),d=c["a"].floatToByte(o.green),u=c["a"].floatToByte(o.blue),h=c["a"].floatToByte(o.alpha);e._instanced?(a=n._index,s(a,r,d,u,h)):(a=4*n._index,s(a+0,r,d,u,h),s(a+1,r,d,u,h),s(a+2,r,d,u,h),s(a+3,r,d,u,h))}function _e(e,t,i,n){de(e,t,i,n),ue(e,t,i,n),he(e,t,i,n),le(e,t,i,n)}function pe(e,t,i,n){const a=e,s=a._textureSliceWidth,o=a._noiseTextureRows;if(s/o<1||s%o!==0)throw new S["a"]("noiseTextureRows must evenly divide textureSliceWidth");const r=t.context;a._vaNoise=ie(r),a._spNoise=P["a"].fromCache({context:r,vertexShaderSource:i,fragmentShaderSource:n,attributeLocations:{position:0}});const c=a.noiseDetail,u=a.noiseOffset;a._noiseTexture=new D["a"]({context:r,width:s*s/o,height:s*o,pixelDatatype:T["a"].UNSIGNED_BYTE,pixelFormat:A["a"].RGBA,sampler:new w["a"]({wrapS:R["a"].REPEAT,wrapT:R["a"].REPEAT,minificationFilter:L["a"].NEAREST,magnificationFilter:j["a"].NEAREST})});const h=new d["a"]({vertexArray:a._vaNoise,shaderProgram:a._spNoise,outputTexture:a._noiseTexture,uniformMap:{u_noiseTextureDimensions:Q(a),u_noiseDetail:function(){return c},u_noiseOffset:function(){return u}},persists:!1,owner:e,postExecute:function(e){a._ready=!0,a._loading=!1}});t.commandList.push(h),a._loading=!0}function fe(e,t){const i=e,n=t.context;i._createVertexArray=!1,i._vaf=i._vaf&&i._vaf.destroy();const a=e._clouds,s=a.length;if(s>0){i._vaf=re(n,s,i._instanced);const o=i._vaf.writers;let r;for(r=0;r<s;++r){const i=a[r];_e(e,t,o,i)}i._vaf.commit(ne(n))}}const me=[];function be(e,t){const i=t.context,n=e,a=n._clouds,s=a.length,o=n._cloudsToUpdate,r=n._cloudsToUpdateIndex,c=n._propertiesChanged,d=me;d.length=0,(c[W]||c[G])&&d.push(de),(c[z]||c[H])&&d.push(ue),(c[q]||c[Y])&&d.push(he),c[Z]&&d.push(le);const u=d.length,h=n._vaf.writers;let l,_,p;if(r/s>.1){for(l=0;l<r;++l)for(_=o[l],_._dirty=!1,p=0;p<u;++p)d[p](e,t,h,_);n._vaf.commit(ne(i))}else{for(l=0;l<r;++l){for(_=o[l],_._dirty=!1,p=0;p<u;++p)d[p](e,t,h,_);n._instanced?n._vaf.subCommit(_._index,1):n._vaf.subCommit(4*_._index,4)}n._vaf.endSubCommits()}n._cloudsToUpdateIndex=0}function ge(e,t,i,a){const s=t.context,o=e,r=new E["a"]({defines:[],sources:[i]});o._instanced&&r.defines.push("INSTANCED");const c=new E["a"]({defines:[],sources:[a]});o.debugBillboards&&c.defines.push("DEBUG_BILLBOARDS"),o.debugEllipsoids&&c.defines.push("DEBUG_ELLIPSOIDS"),o._sp=P["a"].replaceCache({context:s,shaderProgram:o._sp,vertexShaderSource:r,fragmentShaderSource:c,attributeLocations:N}),o._rs=I["a"].fromCache({depthTest:{enabled:!0,func:U["a"].LESS},depthMask:!1,blending:n["a"].ALPHA_BLEND}),o._spCreated=!0,o._compiledDebugBillboards=o.debugBillboards,o._compiledDebugEllipsoids=o.debugEllipsoids}function ye(e,t){const i=e,n=t.passes,a=i._uniforms,s=t.commandList;if(n.render){const t=i._colorCommands,n=i._vaf.va,o=n.length;t.length=o;for(let r=0;r<o;r++){let o=t[r];Object(g["a"])(o)||(o=t[r]=new x["a"]),o.pass=v["a"].TRANSLUCENT,o.owner=e,o.uniformMap=a,o.count=n[r].indicesCount,o.vertexArray=n[r].va,o.shaderProgram=i._sp,o.renderState=i._rs,i._instanced&&(o.count=6,o.instanceCount=i._clouds.length),s.push(o)}}}$.prototype.update=function(e){if(K(this),!this.show)return;const t=this.debugBillboards||this.debugEllipsoids;this._ready=!!t||Object(g["a"])(this._noiseTexture),this._ready||this._loading||t||pe(this,e,p["a"],_["a"]),this._instanced=e.context.instancedArrays,N=this._instanced?V:F,ne=this._instanced?se:ae;const i=this._clouds,n=i.length,a=this._cloudsToUpdate,s=this._cloudsToUpdateIndex;this._createVertexArray?fe(this,e):s>0&&be(this,e),s>1.5*n&&(a.length=n),!Object(g["a"])(this._vaf)||!Object(g["a"])(this._vaf.va)||!this._ready&!t||(this._spCreated&&this.debugBillboards===this._compiledDebugBillboards&&this.debugEllipsoids===this._compiledDebugEllipsoids||ge(this,e,l["a"],h["a"]),ye(this,e))},$.prototype.isDestroyed=function(){return!1},$.prototype.destroy=function(){return this._noiseTexture=this._noiseTexture&&this._noiseTexture.destroy(),this._sp=this._sp&&this._sp.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),J(this._clouds),Object(y["a"])(this)}}}]);