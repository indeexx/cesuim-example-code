(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~fe03821e"],{2519:function(t,e,i){"use strict";var n=i("1a5d"),a=i("6cc0");function o(t){const e=Object(n["a"])(t,{});this.attenuation=Object(n["a"])(e.attenuation,!1),this.geometricErrorScale=Object(n["a"])(e.geometricErrorScale,1),this.maximumAttenuation=e.maximumAttenuation,this.baseResolution=e.baseResolution,this.eyeDomeLighting=Object(n["a"])(e.eyeDomeLighting,!0),this.eyeDomeLightingStrength=Object(n["a"])(e.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=Object(n["a"])(e.eyeDomeLightingRadius,1),this.backFaceCulling=Object(n["a"])(e.backFaceCulling,!1),this.normalShading=Object(n["a"])(e.normalShading,!0)}o.isSupported=function(t){return a["a"].isSupported(t.context)},e["a"]=o},"2a6d":function(t,e,i){"use strict";var n=i("408d"),a=i("dde0"),o=i("ae9b"),s=i("4051"),r=i("2fad"),c=i("cbf0"),l=i("1a5d"),d=i("c937"),h=i("7526"),u=i("e2aa"),_=i("c380"),p=i("666e"),m=i("5f79");const f={},b=Uint32Array.BYTES_PER_ELEMENT;function y(t,e){const i=t.json;let a,o,s;const c=Object(d["a"])(i.extensions)?i.extensions["3DTILES_draco_point_compression"]:void 0,l=Object(d["a"])(e)&&Object(d["a"])(e.extensions)?e.extensions["3DTILES_draco_point_compression"]:void 0;let h,_,p,m,f,b;if(Object(d["a"])(l)&&(s=l.properties),Object(d["a"])(c)){o=c.properties;const e=c.byteOffset,i=c.byteLength;if(!Object(d["a"])(o)||!Object(d["a"])(e)||!Object(d["a"])(i))throw new u["a"]("Draco properties, byteOffset, and byteLength must be defined");a=Object(n["a"])(t.buffer,e,e+i),h=Object(d["a"])(o.POSITION),_=Object(d["a"])(o.RGB)||Object(d["a"])(o.RGBA),p=Object(d["a"])(o.NORMAL),m=Object(d["a"])(o.BATCH_ID),f=Object(d["a"])(o.RGBA)}return Object(d["a"])(a)&&(b={buffer:a,featureTableProperties:o,batchTableProperties:s,properties:Object(r["a"])(o,s),dequantizeInShader:!0}),{draco:b,hasPositions:h,hasColors:_,isTranslucent:f,hasNormals:p,hasBatchIds:m}}function g(t){const e=t.json;let i;if(Object(d["a"])(e.POSITION))return i=t.getPropertyArray("POSITION",c["a"].FLOAT,3),{name:m["a"].POSITION,semantic:m["a"].POSITION,typedArray:i,isQuantized:!1,componentDatatype:c["a"].FLOAT,type:_["a"].VEC3};if(Object(d["a"])(e.POSITION_QUANTIZED)){i=t.getPropertyArray("POSITION_QUANTIZED",c["a"].UNSIGNED_SHORT,3);const e=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",c["a"].FLOAT,3);if(!Object(d["a"])(e))throw new u["a"]("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const n=65535,o=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",c["a"].FLOAT,3);if(!Object(d["a"])(o))throw new u["a"]("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");return{name:m["a"].POSITION,semantic:m["a"].POSITION,typedArray:i,isQuantized:!0,componentDatatype:c["a"].FLOAT,type:_["a"].VEC3,quantizedRange:n,quantizedVolumeOffset:a["a"].unpack(o),quantizedVolumeScale:a["a"].unpack(e),quantizedComponentDatatype:c["a"].UNSIGNED_SHORT,quantizedType:_["a"].VEC3}}}function O(t){const e=t.json;let i;if(Object(d["a"])(e.RGBA))return i=t.getPropertyArray("RGBA",c["a"].UNSIGNED_BYTE,4),{name:m["a"].COLOR,semantic:m["a"].COLOR,setIndex:0,typedArray:i,componentDatatype:c["a"].UNSIGNED_BYTE,type:_["a"].VEC4,normalized:!0,isRGB565:!1,isTranslucent:!0};if(Object(d["a"])(e.RGB))return i=t.getPropertyArray("RGB",c["a"].UNSIGNED_BYTE,3),{name:"COLOR",semantic:m["a"].COLOR,setIndex:0,typedArray:i,componentDatatype:c["a"].UNSIGNED_BYTE,type:_["a"].VEC3,normalized:!0,isRGB565:!1,isTranslucent:!1};if(Object(d["a"])(e.RGB565))return i=t.getPropertyArray("RGB565",c["a"].UNSIGNED_SHORT,1),{name:"COLOR",semantic:m["a"].COLOR,setIndex:0,typedArray:i,componentDatatype:c["a"].FLOAT,type:_["a"].VEC3,normalized:!1,isRGB565:!0,isTranslucent:!1};if(Object(d["a"])(e.CONSTANT_RGBA)){const e=t.getGlobalProperty("CONSTANT_RGBA",c["a"].UNSIGNED_BYTE,4),i=e[3],n=s["a"].fromBytes(e[0],e[1],e[2],i),a=i<255;return{name:m["a"].COLOR,semantic:m["a"].COLOR,setIndex:0,constantColor:n,componentDatatype:c["a"].FLOAT,type:_["a"].VEC4,isQuantized:!1,isTranslucent:a}}}function S(t){const e=t.json;let i;if(Object(d["a"])(e.NORMAL))return i=t.getPropertyArray("NORMAL",c["a"].FLOAT,3),{name:m["a"].NORMAL,semantic:m["a"].NORMAL,typedArray:i,octEncoded:!1,octEncodedZXY:!1,componentDatatype:c["a"].FLOAT,type:_["a"].VEC3};if(Object(d["a"])(e.NORMAL_OCT16P)){i=t.getPropertyArray("NORMAL_OCT16P",c["a"].UNSIGNED_BYTE,2);const e=8;return{name:m["a"].NORMAL,semantic:m["a"].NORMAL,typedArray:i,octEncoded:!0,octEncodedZXY:!1,quantizedRange:(1<<e)-1,quantizedType:_["a"].VEC2,quantizedComponentDatatype:c["a"].UNSIGNED_BYTE,componentDatatype:c["a"].FLOAT,type:_["a"].VEC3}}}function D(t){const e=t.json;if(Object(d["a"])(e.BATCH_ID)){const e=t.getPropertyArray("BATCH_ID",c["a"].UNSIGNED_SHORT,1);return{name:m["a"].FEATURE_ID,semantic:m["a"].FEATURE_ID,setIndex:0,typedArray:e,componentDatatype:c["a"].fromTypedArray(e),type:_["a"].SCALAR}}}f.parse=function(t,e){e=Object(l["a"])(e,0),o["a"].defined("arrayBuffer",t);const i=new Uint8Array(t),n=new DataView(t);e+=b;const s=n.getUint32(e,!0);if(1!==s)throw new u["a"](`Only Point Cloud tile version 1 is supported.  Version ${s} is not.`);e+=b,e+=b;const r=n.getUint32(e,!0);if(0===r)throw new u["a"]("Feature table must have a byte length greater than zero");e+=b;const _=n.getUint32(e,!0);e+=b;const m=n.getUint32(e,!0);e+=b;const f=n.getUint32(e,!0);e+=b;const T=Object(h["a"])(i,e,r);e+=r;const C=new Uint8Array(t,e,_);let E,A;e+=_,m>0&&(E=Object(h["a"])(i,e,m),e+=m,f>0&&(A=new Uint8Array(t,e,f),e+=f));const I=new p["a"](T,C),P=I.getGlobalProperty("POINTS_LENGTH");if(I.featuresLength=P,!Object(d["a"])(P))throw new u["a"]("Feature table global property: POINTS_LENGTH must be defined");let N=I.getGlobalProperty("RTC_CENTER",c["a"].FLOAT,3);Object(d["a"])(N)&&(N=a["a"].unpack(N));const v=y(I,E);if(v.rtcCenter=N,v.pointsLength=P,!v.hasPositions){const t=g(I);v.positions=t,v.hasPositions=v.hasPositions||Object(d["a"])(t)}if(!v.hasPositions)throw new u["a"]("Either POSITION or POSITION_QUANTIZED must be defined.");if(!v.hasNormals){const t=S(I);v.normals=t,v.hasNormals=v.hasNormals||Object(d["a"])(t)}if(!v.hasColors){const t=O(I);v.colors=t,v.hasColors=v.hasColors||Object(d["a"])(t),v.hasConstantColor=Object(d["a"])(v.constantColor),v.isTranslucent=Object(d["a"])(t)&&t.isTranslucent}if(!v.hasBatchIds){const t=D(I);v.batchIds=t,v.hasBatchIds=v.hasBatchIds||Object(d["a"])(t)}if(v.hasBatchIds){const t=I.getGlobalProperty("BATCH_LENGTH");if(!Object(d["a"])(t))throw new u["a"]("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");v.batchLength=t}return Object(d["a"])(A)&&(A=new Uint8Array(A),v.batchTableJson=E,v.batchTableBinary=A),v},e["a"]=f},"49d8":function(t,e,i){"use strict";var n=i("4051"),a=i("2fad"),o=i("1a5d"),s=i("c937"),r=i("21b7"),c=i("e2a6"),l=i("b8b5"),d=i("51f2"),h=i("8fcb"),u=i("0b24"),_=i("466f"),p=i("714a"),m=i("2519"),f=i("dc6c");function b(t,e,i,n,a){this._tileset=t,this._tile=e,this._resource=i,this._metadata=void 0,this._pickId=void 0,this._batchTable=void 0,this._styleDirty=!1,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._pointCloud=new p["a"]({arrayBuffer:n,byteOffset:a,cull:!1,opaquePass:d["a"].CESIUM_3D_TILE,vertexShaderLoaded:y(this),fragmentShaderLoaded:g(this),uniformMapLoaded:O(this),batchTableLoaded:S(this),pickIdLoaded:D(this)})}function y(t){return function(e){return Object(s["a"])(t._batchTable)?t._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(e):e}}function g(t){return function(e){return Object(s["a"])(t._batchTable)?t._batchTable.getFragmentShaderCallback(!1,void 0,!1)(e):"uniform vec4 czm_pickColor;\n"+e}}function O(t){return function(e){return Object(s["a"])(t._batchTable)?t._batchTable.getUniformMapCallback()(e):Object(a["a"])(e,{czm_pickColor:function(){return t._pickId.color}})}}function S(t){return function(e,i,n){t._batchTable=new h["a"](t,e,i,n)}}function D(t){return function(){return Object(s["a"])(t._batchTable)?t._batchTable.getPickId():"czm_pickColor"}}function T(t){const e=t._tileset.pointCloudShading,i=t._tile.contentBoundingVolume.boundingSphere.volume(),n=l["a"].cbrt(i/t.pointsLength);let a=t._tile.geometricError;return 0===a&&(a=Object(s["a"])(e)&&Object(s["a"])(e.baseResolution)?e.baseResolution:n),a}function C(t){const e=t.featuresLength;if(!Object(s["a"])(t._features)&&e>0){const i=new Array(e);for(let n=0;n<e;++n)i[n]=new u["a"](t,n);t._features=i}}Object.defineProperties(b.prototype,{featuresLength:{get:function(){return Object(s["a"])(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return this._pointCloud.pointsLength}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this._pointCloud.geometryByteLength}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return Object(s["a"])(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._pointCloud.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(t){this._group=t}}}),b.prototype.hasProperty=function(t,e){return!!Object(s["a"])(this._batchTable)&&this._batchTable.hasProperty(t,e)},b.prototype.getFeature=function(t){if(!Object(s["a"])(this._batchTable))return;const e=this.featuresLength;if(!Object(s["a"])(t)||t<0||t>=e)throw new c["a"](`batchId is required and between zero and featuresLength - 1 (${e-1}).`);return C(this),this._features[t]},b.prototype.applyDebugSettings=function(t,e){this._pointCloud.color=t?e:n["a"].WHITE},b.prototype.applyStyle=function(t){Object(s["a"])(this._batchTable)?this._batchTable.applyStyle(t):this._styleDirty=!0};const E=new m["a"];b.prototype.update=function(t,e){const i=this._pointCloud,n=Object(o["a"])(t.pointCloudShading,E),a=this._tile,r=this._batchTable,c=e.mode,l=t.clippingPlanes;let d;Object(s["a"])(this._pickId)||Object(s["a"])(r)||(this._pickId=e.context.createPickId({primitive:t,content:this})),Object(s["a"])(r)&&r.update(t,e),d=Object(s["a"])(a._contentBoundingVolume)?c===f["a"].SCENE3D?a._contentBoundingVolume.boundingSphere:a._contentBoundingVolume2D.boundingSphere:c===f["a"].SCENE3D?a._boundingVolume.boundingSphere:a._boundingVolume2D.boundingSphere;const h=this._styleDirty;this._styleDirty=!1,i.clippingPlanesOriginMatrix=t.clippingPlanesOriginMatrix,i.style=Object(s["a"])(r)?void 0:t.style,i.styleDirty=h,i.modelMatrix=a.computedTransform,i.time=t.timeSinceLoad,i.shadows=t.shadows,i.boundingSphere=d,i.clippingPlanes=l,i.isClipped=Object(s["a"])(l)&&l.enabled&&a._isClipped,i.clippingPlanesDirty=a.clippingPlanesDirty,i.attenuation=n.attenuation,i.backFaceCulling=n.backFaceCulling,i.normalShading=n.normalShading,i.geometricError=T(this),i.geometricErrorScale=n.geometricErrorScale,i.splitDirection=t.splitDirection,Object(s["a"])(n)&&Object(s["a"])(n.maximumAttenuation)?i.maximumAttenuation=n.maximumAttenuation:a.refine===_["a"].ADD?i.maximumAttenuation=5:i.maximumAttenuation=t.maximumScreenSpaceError,i.update(e)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return this._pickId=this._pickId&&this._pickId.destroy(),this._pointCloud=this._pointCloud&&this._pointCloud.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(r["a"])(this)},e["a"]=b},"6cc0":function(t,e,i){"use strict";var n=i("85b2"),a=i("4051"),o=i("c937"),s=i("21b7"),r=i("82ba"),c=i("a3c8"),l=i("d5cf"),d=i("66fd"),h=i("51f2"),u=i("5027"),_=i("b3ce"),p=i("da23"),m=i("8d2f"),f=i("77db");function b(){this._framebuffer=new d["a"]({colorAttachmentsLength:2,depth:!0,supportsDepthTexture:!0}),this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}function y(t){t._framebuffer.destroy(),t._drawCommand=void 0,t._clearCommand=void 0}Object.defineProperties(b.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}},colorGBuffer:{get:function(){return this._framebuffer.getColorTexture(0)}},depthGBuffer:{get:function(){return this._framebuffer.getColorTexture(1)}}});const g=new n["a"];function O(t,e){const i=new _["a"]({defines:["LOG_DEPTH_WRITE"],sources:[f["a"]]}),n={u_pointCloud_colorGBuffer:function(){return t.colorGBuffer},u_pointCloud_depthGBuffer:function(){return t.depthGBuffer},u_distanceAndEdlStrength:function(){return g.x=t._radius,g.y=t._strength,g}},o=u["a"].fromCache({blending:p["a"].ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:m["a"].setCesium3DTileBit(),stencilMask:m["a"].CESIUM_3D_TILE_MASK});t._drawCommand=e.createViewportQuadCommand(i,{uniformMap:n,renderState:o,pass:h["a"].CESIUM_3D_TILE,owner:t}),t._clearCommand=new c["a"]({framebuffer:t.framebuffer,color:new a["a"](0,0,0,0),depth:1,renderState:u["a"].fromCache(),pass:h["a"].CESIUM_3D_TILE,owner:t})}function S(t,e){const i=e.drawingBufferWidth,n=e.drawingBufferHeight;t._framebuffer.update(e,i,n),O(t,e)}function D(t){return t.drawBuffers&&t.fragmentDepth}function T(t,e){let i=t.shaderCache.getDerivedShaderProgram(e,"EC");if(!Object(o["a"])(i)){const n=e._attributeLocations,a=e.fragmentShaderSource.clone();a.sources=a.sources.map((function(t){return t=_["a"].replaceMain(t,"czm_point_cloud_post_process_main"),t=t.replace(/gl_FragColor/g,"gl_FragData[0]"),t})),a.sources.unshift("#extension GL_EXT_draw_buffers : enable \n"),a.sources.push("void main() \n{ \n    czm_point_cloud_post_process_main(); \n#ifdef LOG_DEPTH\n    czm_writeLogDepth();\n    gl_FragData[1] = czm_packDepth(gl_FragDepthEXT); \n#else\n    gl_FragData[1] = czm_packDepth(gl_FragCoord.z);\n#endif\n}"),i=t.shaderCache.createDerivedShaderProgram(e,"EC",{vertexShaderSource:e.vertexShaderSource,fragmentShaderSource:a,attributeLocations:n})}return i}b.isSupported=D,b.prototype.update=function(t,e,i,n){if(!D(t.context))return;let a;this._strength=i.eyeDomeLightingStrength,this._radius=i.eyeDomeLightingRadius*t.pixelRatio,S(this,t.context);const s=t.commandList,c=s.length;for(a=e;a<c;++a){const e=s[a];if(e.primitiveType!==r["a"].POINTS||e.pass===h["a"].TRANSLUCENT)continue;let i,n,c=e.derivedCommands.pointCloudProcessor;Object(o["a"])(c)&&(i=c.command,n=c.originalShaderProgram),Object(o["a"])(i)&&!e.dirty&&n===e.shaderProgram&&i.framebuffer===this.framebuffer||(i=l["a"].shallowClone(e,i),i.framebuffer=this.framebuffer,i.shaderProgram=T(t.context,e.shaderProgram),i.castShadows=!1,i.receiveShadows=!1,Object(o["a"])(c)||(c={command:i,originalShaderProgram:e.shaderProgram},e.derivedCommands.pointCloudProcessor=c),c.originalShaderProgram=e.shaderProgram),s[a]=i}const d=this._clearCommand,u=this._drawCommand;u.boundingVolume=n,s.push(u),s.push(d)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return y(this),Object(s["a"])(this)},e["a"]=b},"714a":function(t,e,i){"use strict";var n=i("8656"),a=i("dde0"),o=i("6b82"),s=i("ae9b"),r=i("44e9"),c=i("4051"),l=i("2fad"),d=i("cbf0"),h=i("1a5d"),u=i("61ad"),_=i("c937"),p=i("21b7"),m=i("b8b5"),f=i("722e"),b=i("e47d"),y=i("ec1a"),g=i("82ba"),O=i("e2aa"),S=i("6f7c"),D=i("6f54"),T=i("6ba7"),C=i("d5cf"),E=i("51f2"),A=i("5027"),I=i("8f7d"),P=i("dc15"),N=i("3c000"),v=i("da23"),L=i("8fcb"),B=i("5618"),w=i("0959"),x=i("1aeb"),j=i("2a6d"),R=i("dc6c"),z=i("ff3a"),U=i("66a6"),M=i("4d91"),V=i("8d2f");const q={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function G(t){s["a"].typeOf.object("options",t),s["a"].typeOf.object("options.arrayBuffer",t.arrayBuffer),this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=c["a"].clone(c["a"].DARKGRAY),this._highlightColor=c["a"].clone(c["a"].WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=q.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._readyPromise=Object(u["a"])(),this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=t.vertexShaderLoaded,this._fragmentShaderLoaded=t.fragmentShaderLoaded,this._uniformMapLoaded=t.uniformMapLoaded,this._batchTableLoaded=t.batchTableLoaded,this._pickIdLoaded=t.pickIdLoaded,this._opaquePass=Object(h["a"])(t.opaquePass,E["a"].OPAQUE),this._cull=Object(h["a"])(t.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=f["a"].clone(f["a"].IDENTITY),this._modelMatrix=f["a"].clone(f["a"].IDENTITY),this.time=0,this.shadows=z["a"].ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=Object(h["a"])(t.splitDirection,U["a"].NONE),this._splittingEnabled=!1,F(this,t)}function F(t,e){const i=j["a"].parse(e.arrayBuffer,e.byteOffset);if(t._parsedContent=i,t._rtcCenter=i.rtcCenter,t._hasNormals=i.hasNormals,t._hasColors=i.hasColors,t._hasBatchIds=i.hasBatchIds,t._isTranslucent=i.isTranslucent,!i.hasBatchIds&&Object(_["a"])(i.batchTableBinary)&&(i.styleableProperties=L["a"].getBinaryProperties(i.pointsLength,i.batchTableJson,i.batchTableBinary)),Object(_["a"])(i.draco)){const e=i.draco;t._decodingState=q.NEEDS_DECODE,e.dequantizeInShader=t._dequantizeInShader}const n=i.positions;Object(_["a"])(n)&&(t._isQuantized=n.isQuantized,t._quantizedVolumeScale=n.quantizedVolumeScale,t._quantizedVolumeOffset=n.quantizedVolumeOffset,t._quantizedRange=n.quantizedRange);const a=i.normals;Object(_["a"])(a)&&(t._isOctEncoded16P=a.octEncoded);const o=i.colors;Object(_["a"])(o)&&(Object(_["a"])(o.constantColor)&&(t._constantColor=c["a"].clone(o.constantColor,t._constantColor),t._hasColors=!1),t._isRGB565=o.isRGB565);const s=i.batchIds;Object(_["a"])(i.batchIds)&&(s.name="BATCH_ID",s.semantic="BATCH_ID",s.setIndex=void 0),i.hasBatchIds&&t._batchTableLoaded(i.batchLength,i.batchTableJson,i.batchTableBinary),t._pointsLength=i.pointsLength}Object.defineProperties(G.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},color:{get:function(){return c["a"].clone(this._highlightColor)},set:function(t){this._highlightColor=c["a"].clone(t,this._highlightColor)}},boundingSphere:{get:function(){if(Object(_["a"])(this._drawCommand))return this._drawCommand.boundingVolume},set:function(t){this._boundingSphere=n["a"].clone(t,this._boundingSphere)}}});const k=new a["a"],H=new a["a"],W=new a["a"];let Y,Q;function X(t){if(!Object(_["a"])(Q)){Y=new N["a"](0),Q=new Array(t);for(let e=0;e<t;++e)Q[e]=Y.random()}return Q}function Z(t){const e=20,i=t.length/3,o=Math.min(i,e),s=X(e),r=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=a["a"].fromElements(r,r,r,k),d=a["a"].fromElements(c,c,c,H);for(let n=0;n<o;++n){const e=Math.floor(s[n]*i),o=a["a"].unpack(t,3*e,W);a["a"].minimumByComponent(l,o,l),a["a"].maximumByComponent(d,o,d)}const h=n["a"].fromCornerPoints(l,d);return h.radius+=m["a"].EPSILON2,h}function J(t,e){const i=d["a"].fromTypedArray(t);return i===d["a"].INT||i===d["a"].UNSIGNED_INT||i===d["a"].DOUBLE?(Object(b["a"])("Cast pnts property to floats",`Point cloud property "${e}" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(t)):t}const $=new o["a"],K=new o["a"],tt=new c["a"],et=0,it=1,nt=2,at=3,ot=4,st=new f["a"],rt=new f["a"];function ct(t,e){const i=e.context,o=t._parsedContent,s=t._pointsLength,r=o.positions,c=o.colors,l=o.normals;let h=o.batchIds;const u=o.styleableProperties,p=Object(_["a"])(u),m=t._isQuantized,b=t._isQuantizedDraco,y=t._isOctEncoded16P,O=t._isOctEncodedDraco,S=t._quantizedRange,I=t._octEncodedRange,N=t._isRGB565,L=t._isTranslucent,B=t._hasColors,w=t._hasNormals,x=t._hasBatchIds;let j,R;const z=[],U={};if(t._styleableShaderAttributes=U,p){let e=ot;for(const n in u)if(u.hasOwnProperty(n)){const a=u[n],o=J(a.typedArray,n);j=a.componentCount,R=d["a"].fromTypedArray(o);const s=D["a"].createVertexBuffer({context:i,typedArray:o,usage:T["a"].STATIC_DRAW});t._geometryByteLength+=s.sizeInBytes;const r={index:e,vertexBuffer:s,componentsPerAttribute:j,componentDatatype:R,normalize:!1,offsetInBytes:0,strideInBytes:0};z.push(r),U[n]={location:e,componentCount:j},++e}}const M=D["a"].createVertexBuffer({context:i,typedArray:r.typedArray,usage:T["a"].STATIC_DRAW});let q,G,F;t._geometryByteLength+=M.sizeInBytes,B&&(q=D["a"].createVertexBuffer({context:i,typedArray:c.typedArray,usage:T["a"].STATIC_DRAW}),t._geometryByteLength+=q.sizeInBytes),w&&(G=D["a"].createVertexBuffer({context:i,typedArray:l.typedArray,usage:T["a"].STATIC_DRAW}),t._geometryByteLength+=G.sizeInBytes),x&&(h=J(h,"batchIds"),F=D["a"].createVertexBuffer({context:i,typedArray:h.typedArray,usage:T["a"].STATIC_DRAW}),t._geometryByteLength+=F.sizeInBytes);let k=[];if(R=m?d["a"].UNSIGNED_SHORT:b?S<=255?d["a"].UNSIGNED_BYTE:d["a"].UNSIGNED_SHORT:d["a"].FLOAT,k.push({index:et,vertexBuffer:M,componentsPerAttribute:3,componentDatatype:R,normalize:!1,offsetInBytes:0,strideInBytes:0}),t._cull&&(t._boundingSphere=m||b?n["a"].fromCornerPoints(a["a"].ZERO,t._quantizedVolumeScale):Z(r.typedArray)),B)if(N)k.push({index:it,vertexBuffer:q,componentsPerAttribute:1,componentDatatype:d["a"].UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{const t=L?4:3;k.push({index:it,vertexBuffer:q,componentsPerAttribute:t,componentDatatype:d["a"].UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}w&&(y?(j=2,R=d["a"].UNSIGNED_BYTE):O?(j=2,R=I<=255?d["a"].UNSIGNED_BYTE:d["a"].UNSIGNED_SHORT):(j=3,R=d["a"].FLOAT),k.push({index:nt,vertexBuffer:G,componentsPerAttribute:j,componentDatatype:R,normalize:!1,offsetInBytes:0,strideInBytes:0})),x&&k.push({index:at,vertexBuffer:F,componentsPerAttribute:1,componentDatatype:d["a"].fromTypedArray(h.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),p&&(k=k.concat(z));const H=new P["a"]({context:i,attributes:k}),W={depthTest:{enabled:!0}},Y={depthTest:{enabled:!0},depthMask:!1,blending:v["a"].ALPHA_BLEND};t._opaquePass===E["a"].CESIUM_3D_TILE&&(W.stencilTest=V["a"].setCesium3DTileBit(),W.stencilMask=V["a"].CESIUM_3D_TILE_MASK,Y.stencilTest=V["a"].setCesium3DTileBit(),Y.stencilMask=V["a"].CESIUM_3D_TILE_MASK),t._opaqueRenderState=A["a"].fromCache(W),t._translucentRenderState=A["a"].fromCache(Y),t._drawCommand=new C["a"]({boundingVolume:new n["a"],cull:t._cull,modelMatrix:new f["a"],primitiveType:g["a"].POINTS,vertexArray:H,count:s,shaderProgram:void 0,uniformMap:void 0,renderState:L?t._translucentRenderState:t._opaqueRenderState,pass:L?E["a"].TRANSLUCENT:t._opaquePass,owner:t,castShadows:!1,receiveShadows:!1,pickId:t._pickIdLoaded()})}function lt(t,e){const i=e.context,n=t._isQuantized,o=t._isQuantizedDraco,s=t._isOctEncodedDraco;let r={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){const n=$;if(n.x=t._attenuation?t.maximumAttenuation:t._pointSize,n.x*=e.pixelRatio,n.y=t.time,t._attenuation){const a=e.camera.frustum;let o;o=e.mode===R["a"].SCENE2D||a instanceof y["a"]?Number.POSITIVE_INFINITY:i.drawingBufferHeight/e.camera.frustum.sseDenominator,n.z=t.geometricError*t.geometricErrorScale,n.w=o}return n},u_highlightColor:function(){return t._highlightColor},u_constantColor:function(){return t._constantColor},u_clippingPlanes:function(){const e=t.clippingPlanes,n=t.isClipped;return n?e.texture:i.defaultTexture},u_clippingPlanesEdgeStyle:function(){const e=t.clippingPlanes;if(!Object(_["a"])(e))return c["a"].TRANSPARENT;const i=c["a"].clone(e.edgeColor,tt);return i.alpha=e.edgeWidth,i},u_clippingPlanesMatrix:function(){const e=t.clippingPlanes;if(!Object(_["a"])(e))return f["a"].IDENTITY;const n=Object(h["a"])(t.clippingPlanesOriginMatrix,t._modelMatrix);f["a"].multiply(i.uniformState.view3D,n,st);const a=f["a"].multiply(st,e.modelMatrix,st);return f["a"].inverseTranspose(a,rt)}};M["a"].addUniforms(t,r),(n||o||s)&&(r=Object(l["a"])(r,{u_quantizedVolumeScaleAndOctEncodedRange:function(){const e=K;if(Object(_["a"])(t._quantizedVolumeScale)){const i=a["a"].clone(t._quantizedVolumeScale,e);a["a"].divideByScalar(i,t._quantizedRange,e)}return e.w=t._octEncodedRange,e}})),Object(_["a"])(t._uniformMapLoaded)&&(r=t._uniformMapLoaded(r)),t._drawCommand.uniformMap=r}function dt(t,e){const i=/czm_3dtiles_property_(\d+)/g;let n=i.exec(t);while(null!==n){const a=parseInt(n[1]);-1===e.indexOf(a)&&e.push(a),n=i.exec(t)}}function ht(t,e){t=t.slice(t.indexOf("\n"));const i=/czm_3dtiles_builtin_property_(\w+)/g;let n=i.exec(t);while(null!==n){const a=n[1];-1===e.indexOf(a)&&e.push(a),n=i.exec(t)}}function ut(t,e){const i=t.numberOfAttributes;for(let n=0;n<i;++n){const i=t.getAttribute(n);if(i.index===e)return i}}const _t={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};function pt(t,e,i){let n,a,o;const s=e.context,c=Object(_["a"])(i),l=t._isQuantized,d=t._isQuantizedDraco,h=t._isOctEncoded16P,u=t._isOctEncodedDraco,p=t._isRGB565,m=t._isTranslucent,f=t._hasColors,b=t._hasNormals,y=t._hasBatchIds,g=t._backFaceCulling,S=t._normalShading,D=t._drawCommand.vertexArray,T=t.clippingPlanes,C=t._attenuation;let E,A,P,N=m;const v=Object(r["a"])(_t),L={},B=t._styleableShaderAttributes;for(a in B)B.hasOwnProperty(a)&&(o=B[a],v[a]="czm_3dtiles_property_"+o.location,L[o.location]=o);if(c){const t={translucent:!1},e="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";E=i.getColorShaderFunction("getColorFromStyle"+e,v,t),A=i.getShowShaderFunction("getShowFromStyle"+e,v,t),P=i.getPointSizeShaderFunction("getPointSizeFromStyle"+e,v,t),Object(_["a"])(E)&&t.translucent&&(N=!0)}t._styleTranslucent=N;const j=Object(_["a"])(E),R=Object(_["a"])(A),z=Object(_["a"])(P),V=t.isClipped,q=[],G=[];j&&(dt(E,q),ht(E,G)),R&&(dt(A,q),ht(A,G)),z&&(dt(P,q),ht(P,G));const F=G.indexOf("COLOR")>=0,k=G.indexOf("NORMAL")>=0;if(k&&!b)throw new O["a"]("Style references the NORMAL semantic but the point cloud does not have normals");for(a in B)if(B.hasOwnProperty(a)){o=B[a];const t=q.indexOf(o.location)>=0,e=ut(D,o.location);e.enabled=t}const H=f&&(!j||F);if(f){const t=ut(D,it);t.enabled=H}const W=b&&(S||g||k);if(b){const t=ut(D,nt);t.enabled=W}const Y={a_position:et};H&&(Y.a_color=it),W&&(Y.a_normal=nt),y&&(Y.a_batchId=at);let Q="";const X=q.length;for(n=0;n<X;++n){const t=q[n];o=L[t];const e=o.componentCount,i="czm_3dtiles_property_"+t;let a;a=1===e?"float":"vec"+e,Q+=`attribute ${a} ${i}; \n`,Y[i]=o.location}lt(t,e);let Z="attribute vec3 a_position; \nvarying vec4 v_color; \nuniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";Z+="float u_pointSize; \nfloat u_time; \n",C&&(Z+="float u_geometricError; \nfloat u_depthMultiplier; \n"),Z+=Q,H&&(Z+=m?"attribute vec4 a_color; \n":p?"attribute float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"attribute vec3 a_color; \n"),W&&(Z+=h||u?"attribute vec2 a_normal; \n":"attribute vec3 a_normal; \n"),y&&(Z+="attribute float a_batchId; \n"),(l||d||u)&&(Z+="uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; \n"),j&&(Z+=E),R&&(Z+=A),z&&(Z+=P),Z+="void main() \n{ \n    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; \n    u_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; \n",C&&(Z+="    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; \n"),Z+=H?m?"    vec4 color = a_color; \n":p?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",Z+=l||d?"    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; \n":"    vec3 position = a_position; \n",Z+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",W?(Z+=h?"    vec3 normal = czm_octDecode(a_normal); \n":u?"    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; \n":"    vec3 normal = a_normal; \n",Z+="    vec3 normalEC = czm_normal * normal; \n"):Z+="    vec3 normal = vec3(1.0); \n",j&&(Z+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),R&&(Z+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),Z+=z?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; \n":C?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",Z+="    color = color * u_highlightColor; \n",W&&S&&(Z+="    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength * czm_lightColor; \n"),Z+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",W&&g&&(Z+="    float visible = step(-normalEC.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),R&&(Z+="    gl_Position.w *= float(show); \n    gl_PointSize *= float(show); \n"),Z+="} \n";let J="varying vec4 v_color; \n";V&&(J+="uniform highp sampler2D u_clippingPlanes; \nuniform mat4 u_clippingPlanesMatrix; \nuniform vec4 u_clippingPlanesEdgeStyle; \n",J+="\n",J+=Object(x["a"])(T,s),J+="\n"),J+="void main() \n{ \n    gl_FragColor = czm_gammaCorrect(v_color); \n",V&&(J+=Object(w["a"])("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),J+="} \n",t.splitDirection!==U["a"].NONE&&(J=M["a"].modifyFragmentShader(J)),Object(_["a"])(t._vertexShaderLoaded)&&(Z=t._vertexShaderLoaded(Z)),Object(_["a"])(t._fragmentShaderLoaded)&&(J=t._fragmentShaderLoaded(J));const $=t._drawCommand;Object(_["a"])($.shaderProgram)&&$.shaderProgram.destroy(),$.shaderProgram=I["a"].fromCache({context:s,vertexShaderSource:Z,fragmentShaderSource:J,attributeLocations:Y});try{$.shaderProgram._bind()}catch(K){throw new O["a"]("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function mt(t,e){if(t._decodingState===q.READY)return!1;if(t._decodingState===q.NEEDS_DECODE){const i=t._parsedContent,n=i.draco,o=B["a"].decodePointCloud(n,e);Object(_["a"])(o)&&(t._decodingState=q.DECODING,o.then((function(e){t._decodingState=q.READY;const o=Object(_["a"])(e.POSITION)?e.POSITION.array:void 0,s=Object(_["a"])(e.RGB)?e.RGB.array:void 0,r=Object(_["a"])(e.RGBA)?e.RGBA.array:void 0,c=Object(_["a"])(e.NORMAL)?e.NORMAL.array:void 0,l=Object(_["a"])(e.BATCH_ID)?e.BATCH_ID.array:void 0,d=Object(_["a"])(o)&&Object(_["a"])(e.POSITION.data.quantization),u=Object(_["a"])(c)&&Object(_["a"])(e.NORMAL.data.quantization);if(d){const i=e.POSITION.data.quantization,n=i.range;t._quantizedVolumeScale=a["a"].fromElements(n,n,n),t._quantizedVolumeOffset=a["a"].unpack(i.minValues),t._quantizedRange=(1<<i.quantizationBits)-1,t._isQuantizedDraco=!0}u&&(t._octEncodedRange=(1<<e.NORMAL.data.quantization.quantizationBits)-1,t._isOctEncodedDraco=!0);let p=i.styleableProperties;const m=n.batchTableProperties;for(const t in m)if(m.hasOwnProperty(t)){const i=e[t];Object(_["a"])(p)||(p={}),p[t]={typedArray:i.array,componentCount:i.data.componentsPerAttribute}}Object(_["a"])(o)&&(i.positions={typedArray:o});const f=Object(h["a"])(r,s);Object(_["a"])(f)&&(i.colors={typedArray:f}),Object(_["a"])(c)&&(i.normals={typedArray:c}),Object(_["a"])(l)&&(i.batchIds={typedArray:l}),i.styleableProperties=p})).catch((function(e){t._decodingState=q.FAILED,t._readyPromise.reject(e)})))}return!0}const ft=new o["a"],bt=new a["a"];G.prototype.update=function(t){const e=t.context,i=mt(this,e);if(i)return;let s=!1,r=!f["a"].equals(this._modelMatrix,this.modelMatrix);if(this._mode!==t.mode&&(this._mode=t.mode,r=!0),Object(_["a"])(this._drawCommand)||(ct(this,t),r=!0,s=!0,this._ready=!0,this._readyPromise.resolve(this),this._parsedContent=void 0),r){f["a"].clone(this.modelMatrix,this._modelMatrix);const e=this._drawCommand.modelMatrix;if(f["a"].clone(this._modelMatrix,e),Object(_["a"])(this._rtcCenter)&&f["a"].multiplyByTranslation(e,this._rtcCenter,e),Object(_["a"])(this._quantizedVolumeOffset)&&f["a"].multiplyByTranslation(e,this._quantizedVolumeOffset,e),t.mode!==R["a"].SCENE3D){const i=t.mapProjection,n=f["a"].getColumn(e,3,ft);o["a"].equals(n,o["a"].UNIT_W)||S["a"].basisTo2D(i,e,e)}const i=this._drawCommand.boundingVolume;if(n["a"].clone(this._boundingSphere,i),this._cull){const t=i.center;f["a"].multiplyByPoint(e,t,t);const n=f["a"].getScale(e,bt);i.radius*=a["a"].maximumComponent(n)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,s=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,s=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,s=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,s=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,s=!0);const c=this.splitDirection!==U["a"].NONE;this._splittingEnabled!==c&&(this._splittingEnabled=c,s=!0),s&&pt(this,t,this._style),this._drawCommand.castShadows=z["a"].castShadows(this.shadows),this._drawCommand.receiveShadows=z["a"].receiveShadows(this.shadows);const l=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=l?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=l?E["a"].TRANSLUCENT:this._opaquePass;const d=t.commandList,h=t.passes;(h.render||h.pick)&&d.push(this._drawCommand)},G.prototype.isDestroyed=function(){return!1},G.prototype.destroy=function(){const t=this._drawCommand;return Object(_["a"])(t)&&(t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),Object(p["a"])(this)},e["a"]=G},b687:function(t,e,i){"use strict";var n=i("6af0"),a=i("85b2"),o=i("dde0"),s=i("6b82"),r=i("4051"),c=i("1a5d"),l=i("c937"),d=i("e2a6"),h=i("aecc"),u=i("722e"),_=i("d05a"),p=i("dc6c"),m=i("6a98");function f(t,e){if(t=Object(c["a"])(t,c["a"].EMPTY_OBJECT),Object(l["a"])(t.disableDepthTestDistance)&&t.disableDepthTestDistance<0)throw new d["a"]("disableDepthTestDistance must be greater than or equal to 0.0.");let i=t.translucencyByDistance,n=t.scaleByDistance,a=t.distanceDisplayCondition;if(Object(l["a"])(i)){if(i.far<=i.near)throw new d["a"]("translucencyByDistance.far must be greater than translucencyByDistance.near.");i=_["a"].clone(i)}if(Object(l["a"])(n)){if(n.far<=n.near)throw new d["a"]("scaleByDistance.far must be greater than scaleByDistance.near.");n=_["a"].clone(n)}if(Object(l["a"])(a)){if(a.far<=a.near)throw new d["a"]("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");a=h["a"].clone(a)}this._show=Object(c["a"])(t.show,!0),this._position=o["a"].clone(Object(c["a"])(t.position,o["a"].ZERO)),this._actualPosition=o["a"].clone(this._position),this._color=r["a"].clone(Object(c["a"])(t.color,r["a"].WHITE)),this._outlineColor=r["a"].clone(Object(c["a"])(t.outlineColor,r["a"].TRANSPARENT)),this._outlineWidth=Object(c["a"])(t.outlineWidth,0),this._pixelSize=Object(c["a"])(t.pixelSize,10),this._scaleByDistance=n,this._translucencyByDistance=i,this._distanceDisplayCondition=a,this._disableDepthTestDistance=Object(c["a"])(t.disableDepthTestDistance,0),this._id=t.id,this._collection=Object(c["a"])(t.collection,e),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=e,this._dirty=!1,this._index=-1}const b=f.SHOW_INDEX=0,y=f.POSITION_INDEX=1,g=f.COLOR_INDEX=2,O=f.OUTLINE_COLOR_INDEX=3,S=f.OUTLINE_WIDTH_INDEX=4,D=f.PIXEL_SIZE_INDEX=5,T=f.SCALE_BY_DISTANCE_INDEX=6,C=f.TRANSLUCENCY_BY_DISTANCE_INDEX=7,E=f.DISTANCE_DISPLAY_CONDITION_INDEX=8,A=f.DISABLE_DEPTH_DISTANCE_INDEX=9;function I(t,e){const i=t._pointPrimitiveCollection;Object(l["a"])(i)&&(i._updatePointPrimitive(t,e),t._dirty=!0)}f.NUMBER_OF_PROPERTIES=10,Object.defineProperties(f.prototype,{show:{get:function(){return this._show},set:function(t){if(!Object(l["a"])(t))throw new d["a"]("value is required.");this._show!==t&&(this._show=t,I(this,b))}},position:{get:function(){return this._position},set:function(t){if(!Object(l["a"])(t))throw new d["a"]("value is required.");const e=this._position;o["a"].equals(e,t)||(o["a"].clone(t,e),o["a"].clone(t,this._actualPosition),I(this,y))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){if(Object(l["a"])(t)&&t.far<=t.near)throw new d["a"]("far distance must be greater than near distance.");const e=this._scaleByDistance;_["a"].equals(e,t)||(this._scaleByDistance=_["a"].clone(t,e),I(this,T))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){if(Object(l["a"])(t)&&t.far<=t.near)throw new d["a"]("far distance must be greater than near distance.");const e=this._translucencyByDistance;_["a"].equals(e,t)||(this._translucencyByDistance=_["a"].clone(t,e),I(this,C))}},pixelSize:{get:function(){return this._pixelSize},set:function(t){if(!Object(l["a"])(t))throw new d["a"]("value is required.");this._pixelSize!==t&&(this._pixelSize=t,I(this,D))}},color:{get:function(){return this._color},set:function(t){if(!Object(l["a"])(t))throw new d["a"]("value is required.");const e=this._color;r["a"].equals(e,t)||(r["a"].clone(t,e),I(this,g))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){if(!Object(l["a"])(t))throw new d["a"]("value is required.");const e=this._outlineColor;r["a"].equals(e,t)||(r["a"].clone(t,e),I(this,O))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){if(!Object(l["a"])(t))throw new d["a"]("value is required.");this._outlineWidth!==t&&(this._outlineWidth=t,I(this,S))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){if(Object(l["a"])(t)&&t.far<=t.near)throw new d["a"]("far must be greater than near");h["a"].equals(this._distanceDisplayCondition,t)||(this._distanceDisplayCondition=h["a"].clone(t,this._distanceDisplayCondition),I(this,E))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){if(this._disableDepthTestDistance!==t){if(!Object(l["a"])(t)||t<0)throw new d["a"]("disableDepthTestDistance must be greater than or equal to 0.0.");this._disableDepthTestDistance=t,I(this,A)}}},id:{get:function(){return this._id},set:function(t){this._id=t,Object(l["a"])(this._pickId)&&(this._pickId.object.id=t)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(t){this._clusterShow!==t&&(this._clusterShow=t,I(this,b))}}}),f.prototype.getPickId=function(t){return Object(l["a"])(this._pickId)||(this._pickId=t.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},f.prototype._getActualPosition=function(){return this._actualPosition},f.prototype._setActualPosition=function(t){o["a"].clone(t,this._actualPosition),I(this,y)};const P=new s["a"];f._computeActualPosition=function(t,e,i){return e.mode===p["a"].SCENE3D?t:(u["a"].multiplyByPoint(i,t,P),m["a"].computeActualWgs84Position(e,P))};const N=new s["a"];f._computeScreenSpacePosition=function(t,e,i,n){const a=u["a"].multiplyByVector(t,s["a"].fromElements(e.x,e.y,e.z,1,N),N),o=m["a"].wgs84ToWindowCoordinates(i,a,n);return o},f.prototype.computeScreenSpacePosition=function(t,e){const i=this._pointPrimitiveCollection;if(Object(l["a"])(e)||(e=new a["a"]),!Object(l["a"])(i))throw new d["a"]("PointPrimitive must be in a collection.");if(!Object(l["a"])(t))throw new d["a"]("scene is required.");const n=i.modelMatrix,o=f._computeScreenSpacePosition(n,this._actualPosition,t,e);if(Object(l["a"])(o))return o.y=t.canvas.clientHeight-o.y,o},f.getScreenSpaceBoundingBox=function(t,e,i){const a=t.pixelSize,o=.5*a,s=e.x-o,r=e.y-o,c=a,d=a;return Object(l["a"])(i)||(i=new n["a"]),i.x=s,i.y=r,i.width=c,i.height=d,i},f.prototype.equals=function(t){return this===t||Object(l["a"])(t)&&this._id===t._id&&o["a"].equals(this._position,t._position)&&r["a"].equals(this._color,t._color)&&this._pixelSize===t._pixelSize&&this._outlineWidth===t._outlineWidth&&this._show===t._show&&r["a"].equals(this._outlineColor,t._outlineColor)&&_["a"].equals(this._scaleByDistance,t._scaleByDistance)&&_["a"].equals(this._translucencyByDistance,t._translucencyByDistance)&&h["a"].equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance},f.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0},e["a"]=f},d65c:function(t,e,i){"use strict";var n=i("8656"),a=i("4051"),o=i("cbf0"),s=i("1a5d"),r=i("c937"),c=i("21b7"),l=i("e2a6"),d=i("d809"),h=i("b8b5"),u=i("722e"),_=i("82ba"),p=i("cedf"),m=i("6ba7"),f=i("2341"),b=i("d5cf"),y=i("51f2"),g=i("5027"),O=i("8f7d"),S=i("b3ce"),D=i("6384"),T=i("f7a4"),C=i("8bdd"),E=i("da23"),A=i("33f6"),I=i("b687"),P=i("dc6c");const N=I["a"].SHOW_INDEX,v=I["a"].POSITION_INDEX,L=I["a"].COLOR_INDEX,B=I["a"].OUTLINE_COLOR_INDEX,w=I["a"].OUTLINE_WIDTH_INDEX,x=I["a"].PIXEL_SIZE_INDEX,j=I["a"].SCALE_BY_DISTANCE_INDEX,R=I["a"].TRANSLUCENCY_BY_DISTANCE_INDEX,z=I["a"].DISTANCE_DISPLAY_CONDITION_INDEX,U=I["a"].DISABLE_DEPTH_DISTANCE_INDEX,M=I["a"].NUMBER_OF_PROPERTIES,V={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function q(t){t=Object(s["a"])(t,s["a"].EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(M),this._maxPixelSize=1,this._baseVolume=new n["a"],this._baseVolumeWC=new n["a"],this._baseVolume2D=new n["a"],this._boundingVolume=new n["a"],this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=Object(s["a"])(t.show,!0),this.modelMatrix=u["a"].clone(Object(s["a"])(t.modelMatrix,u["a"].IDENTITY)),this._modelMatrix=u["a"].clone(u["a"].IDENTITY),this.debugShowBoundingVolume=Object(s["a"])(t.debugShowBoundingVolume,!1),this.blendOption=Object(s["a"])(t.blendOption,A["a"].OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=P["a"].SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW,m["a"].STATIC_DRAW];const e=this;this._uniforms={u_maxTotalPointSize:function(){return e._maxTotalPointSize}}}function G(t){const e=t.length;for(let i=0;i<e;++i)t[i]&&t[i]._destroy()}function F(t){if(t._pointPrimitivesRemoved){t._pointPrimitivesRemoved=!1;const e=[],i=t._pointPrimitives,n=i.length;for(let t=0,a=0;t<n;++t){const n=i[t];n&&(n._index=a++,e.push(n))}t._pointPrimitives=e}}function k(t,e,i){return new D["a"](t,[{index:V.positionHighAndSize,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[v]},{index:V.positionLowAndShow,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[v]},{index:V.compressedAttribute0,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[L]},{index:V.compressedAttribute1,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[R]},{index:V.scaleByDistance,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[j]},{index:V.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:o["a"].FLOAT,usage:i[z]}],e)}Object.defineProperties(q.prototype,{length:{get:function(){return F(this),this._pointPrimitives.length}}}),q.prototype.add=function(t){const e=new I["a"](t,this);return e._index=this._pointPrimitives.length,this._pointPrimitives.push(e),this._createVertexArray=!0,e},q.prototype.remove=function(t){return!!this.contains(t)&&(this._pointPrimitives[t._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,t._destroy(),!0)},q.prototype.removeAll=function(){G(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0},q.prototype._updatePointPrimitive=function(t,e){t._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=t),++this._propertiesChanged[e]},q.prototype.contains=function(t){return Object(r["a"])(t)&&t._pointPrimitiveCollection===this},q.prototype.get=function(t){if(!Object(r["a"])(t))throw new l["a"]("index is required.");return F(this),this._pointPrimitives[t]},q.prototype.computeNewBuffersUsage=function(){const t=this._buffersUsage;let e=!1;const i=this._propertiesChanged;for(let n=0;n<M;++n){const a=0===i[n]?m["a"].STATIC_DRAW:m["a"].STREAM_DRAW;e=e||t[n]!==a,t[n]=a}return e};const H=new d["a"];function W(t,e,i,a){const o=a._index,s=a._getActualPosition();t._mode===P["a"].SCENE3D&&(n["a"].expand(t._baseVolume,s,t._baseVolume),t._boundingVolumeDirty=!0),d["a"].fromCartesian(s,H);const r=a.pixelSize,c=a.outlineWidth;t._maxPixelSize=Math.max(t._maxPixelSize,r+c);const l=i[V.positionHighAndSize],h=H.high;l(o,h.x,h.y,h.z,r);const u=i[V.positionLowAndOutline],_=H.low;u(o,_.x,_.y,_.z,c)}const Y=65536,Q=256;function X(t,e,i,n){const o=n._index,s=n.color,r=n.getPickId(e).color,c=n.outlineColor;let l=a["a"].floatToByte(s.red),d=a["a"].floatToByte(s.green),h=a["a"].floatToByte(s.blue);const u=l*Y+d*Q+h;l=a["a"].floatToByte(c.red),d=a["a"].floatToByte(c.green),h=a["a"].floatToByte(c.blue);const _=l*Y+d*Q+h;l=a["a"].floatToByte(r.red),d=a["a"].floatToByte(r.green),h=a["a"].floatToByte(r.blue);const p=l*Y+d*Q+h,m=a["a"].floatToByte(s.alpha)*Y+a["a"].floatToByte(c.alpha)*Q+a["a"].floatToByte(r.alpha),f=i[V.compressedAttribute0];f(o,u,_,p,m)}function Z(t,e,i,n){const a=n._index;let o=0,s=1,c=1,l=1;const d=n.translucencyByDistance;Object(r["a"])(d)&&(o=d.near,s=d.nearValue,c=d.far,l=d.farValue,1===s&&1===l||(t._shaderTranslucencyByDistance=!0));let u=n.show&&n.clusterShow;0===n.color.alpha&&0===n.outlineColor.alpha&&(u=!1),s=h["a"].clamp(s,0,1),s=1===s?255:255*s|0;const _=(u?1:0)*Q+s;l=h["a"].clamp(l,0,1),l=1===l?255:255*l|0;const p=l,m=i[V.compressedAttribute1];m(a,_,p,o,c)}function J(t,e,i,n){const a=n._index,o=i[V.scaleByDistance];let s=0,c=1,l=1,d=1;const h=n.scaleByDistance;Object(r["a"])(h)&&(s=h.near,c=h.nearValue,l=h.far,d=h.farValue,1===c&&1===d||(t._shaderScaleByDistance=!0)),o(a,s,c,l,d)}function $(t,e,i,n){const a=n._index,o=i[V.distanceDisplayConditionAndDisableDepth];let s=0,c=Number.MAX_VALUE;const l=n.distanceDisplayCondition;Object(r["a"])(l)&&(s=l.near,c=l.far,s*=s,c*=c,t._shaderDistanceDisplayCondition=!0);let d=n.disableDepthTestDistance;d*=d,d>0&&(t._shaderDisableDepthDistance=!0,d===Number.POSITIVE_INFINITY&&(d=-1)),o(a,s,c,d)}function K(t,e,i,n){W(t,e,i,n),X(t,e,i,n),Z(t,e,i,n),J(t,e,i,n),$(t,e,i,n)}function tt(t,e,i,a,o,s){let c;a.mode===P["a"].SCENE3D?(c=t._baseVolume,t._boundingVolumeDirty=!0):c=t._baseVolume2D;const l=[];for(let d=0;d<i;++d){const t=e[d],i=t.position,h=I["a"]._computeActualPosition(i,a,o);Object(r["a"])(h)&&(t._setActualPosition(h),s?l.push(h):n["a"].expand(c,h,c))}s&&n["a"].fromPoints(l,c)}function et(t,e){const i=e.mode,n=t._pointPrimitives,a=t._pointPrimitivesToUpdate,o=t._modelMatrix;t._createVertexArray||t._mode!==i||i!==P["a"].SCENE3D&&!u["a"].equals(o,t.modelMatrix)?(t._mode=i,u["a"].clone(t.modelMatrix,o),t._createVertexArray=!0,i!==P["a"].SCENE3D&&i!==P["a"].SCENE2D&&i!==P["a"].COLUMBUS_VIEW||tt(t,n,n.length,e,o,!0)):i===P["a"].MORPHING?tt(t,n,n.length,e,o,!0):i!==P["a"].SCENE2D&&i!==P["a"].COLUMBUS_VIEW||tt(t,a,t._pointPrimitivesToUpdateIndex,e,o,!1)}function it(t,e,i){const n=e.camera.getPixelSize(i,e.context.drawingBufferWidth,e.context.drawingBufferHeight),a=n*t._maxPixelSize;i.radius+=a}const nt=[];q.prototype.update=function(t){if(F(this),!this.show)return;this._maxTotalPointSize=f["a"].maximumAliasedPointSize,et(this,t);const e=this._pointPrimitives,i=e.length,a=this._pointPrimitivesToUpdate,o=this._pointPrimitivesToUpdateIndex,s=this._propertiesChanged,c=this._createVertexArray;let l;const d=t.context,h=t.passes,m=h.pick;if(c||!m&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let t=0;t<M;++t)s[t]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=k(d,i,this._buffersUsage),l=this._vaf.writers;for(let t=0;t<i;++t){const e=this._pointPrimitives[t];e._dirty=!1,K(this,d,l,e)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){const t=nt;t.length=0,(s[v]||s[w]||s[x])&&t.push(W),(s[L]||s[B])&&t.push(X),(s[N]||s[R])&&t.push(Z),s[j]&&t.push(J),(s[z]||s[U])&&t.push($);const e=t.length;if(l=this._vaf.writers,o/i>.1){for(let i=0;i<o;++i){const n=a[i];n._dirty=!1;for(let i=0;i<e;++i)t[i](this,d,l,n)}this._vaf.commit()}else{for(let i=0;i<o;++i){const n=a[i];n._dirty=!1;for(let i=0;i<e;++i)t[i](this,d,l,n);this._vaf.subCommit(n._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>1.5*i&&(a.length=i),!Object(r["a"])(this._vaf)||!Object(r["a"])(this._vaf.va))return;let D;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,n["a"].transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let I=u["a"].IDENTITY;t.mode===P["a"].SCENE3D?(I=this.modelMatrix,D=n["a"].clone(this._baseVolumeWC,this._boundingVolume)):D=n["a"].clone(this._baseVolume2D,this._boundingVolume),it(this,t,D);const q=this._blendOption!==this.blendOption;let G,H,Y,Q,tt,at;this._blendOption=this.blendOption,q&&(this._blendOption===A["a"].OPAQUE||this._blendOption===A["a"].OPAQUE_AND_TRANSLUCENT?this._rsOpaque=g["a"].fromCache({depthTest:{enabled:!0,func:p["a"].LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===A["a"].TRANSLUCENT||this._blendOption===A["a"].OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=g["a"].fromCache({depthTest:{enabled:!0,func:p["a"].LEQUAL},depthMask:!1,blending:E["a"].ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==t.minimumDisableDepthTestDistance,(q||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(G=new S["a"]({sources:[C["a"]]}),this._shaderScaleByDistance&&G.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&G.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&G.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&G.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===A["a"].OPAQUE_AND_TRANSLUCENT&&(H=new S["a"]({defines:["OPAQUE"],sources:[T["a"]]}),this._sp=O["a"].replaceCache({context:d,shaderProgram:this._sp,vertexShaderSource:G,fragmentShaderSource:H,attributeLocations:V}),H=new S["a"]({defines:["TRANSLUCENT"],sources:[T["a"]]}),this._spTranslucent=O["a"].replaceCache({context:d,shaderProgram:this._spTranslucent,vertexShaderSource:G,fragmentShaderSource:H,attributeLocations:V})),this._blendOption===A["a"].OPAQUE&&(H=new S["a"]({sources:[T["a"]]}),this._sp=O["a"].replaceCache({context:d,shaderProgram:this._sp,vertexShaderSource:G,fragmentShaderSource:H,attributeLocations:V})),this._blendOption===A["a"].TRANSLUCENT&&(H=new S["a"]({sources:[T["a"]]}),this._spTranslucent=O["a"].replaceCache({context:d,shaderProgram:this._spTranslucent,vertexShaderSource:G,fragmentShaderSource:H,attributeLocations:V})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);const ot=t.commandList;if(h.render||m){const t=this._colorCommands,e=this._blendOption===A["a"].OPAQUE,i=this._blendOption===A["a"].OPAQUE_AND_TRANSLUCENT;Y=this._vaf.va,Q=Y.length,t.length=Q;const n=i?2*Q:Q;for(at=0;at<n;++at){const n=e||i&&at%2===0;tt=t[at],Object(r["a"])(tt)||(tt=t[at]=new b["a"]),tt.primitiveType=_["a"].POINTS,tt.pass=n||!i?y["a"].OPAQUE:y["a"].TRANSLUCENT,tt.owner=this;const a=i?Math.floor(at/2):at;tt.boundingVolume=D,tt.modelMatrix=I,tt.shaderProgram=n?this._sp:this._spTranslucent,tt.uniformMap=this._uniforms,tt.vertexArray=Y[a].va,tt.renderState=n?this._rsOpaque:this._rsTranslucent,tt.debugShowBoundingVolume=this.debugShowBoundingVolume,tt.pickId="v_pickColor",ot.push(tt)}}},q.prototype.isDestroyed=function(){return!1},q.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),G(this._pointPrimitives),Object(c["a"])(this)},e["a"]=q}}]);