(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~9108afd1"],{1551:function(t,e,i){"use strict";var n=i("f83b"),o=i("8656"),s=i("ae9b"),r=i("1a5d"),a=i("c937"),c=i("21b7"),l=i("f7b5"),h=i("08b7"),d=i("4a43"),u=i("72f3"),p=i("1f21"),_=i("ff3a"),f=i("8b02"),b=i("d40c"),y=i("b32b"),g=i("f698"),m=i("156c"),O=i("c0dd"),v=i("b090"),w=i("d08b"),C=i("2b83"),j=i("daee"),E=i("c98f"),P=i("fa24"),x=i("e7d6"),I=i("c3ce"),S=i("e955"),B=i("f28f"),M=i("a63c"),L=i("31b0"),T=i("1d8f");const D=[],A=[b["a"],m["a"],g["a"],v["a"],w["a"],j["a"],E["a"],P["a"],x["a"],T["a"]];function N(t,e){this.entity=t,this.scene=e;const i=new Array(A.length),n=new l["a"];function o(t){n.raiseEvent(t)}const s=new h["a"];for(let r=0;r<i.length;r++){const n=new A[r](t,e);s.add(n.geometryChanged,o),i[r]=n}this.updaters=i,this.geometryChanged=n,this.eventHelper=s,this._removeEntitySubscription=t.definitionChanged.addEventListener(N.prototype._onEntityPropertyChanged,this)}function k(t,e,i,o){s["a"].defined("scene",t),s["a"].defined("entityCollection",e),i=Object(r["a"])(i,t.primitives),o=Object(r["a"])(o,t.groundPrimitives),this._scene=t,this._primitives=i,this._groundPrimitives=o,this._entityCollection=void 0,this._addedObjects=new n["a"],this._removedObjects=new n["a"],this._changedObjects=new n["a"];const a=_["a"].NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(2*a),this._closedColorBatches=new Array(2*a),this._closedMaterialBatches=new Array(2*a),this._openColorBatches=new Array(2*a),this._openMaterialBatches=new Array(2*a);const c=C["a"].supportsMaterialsforEntitiesOnTerrain(t);let l;for(this._supportsMaterialsforEntitiesOnTerrain=c,l=0;l<a;++l)this._outlineBatches[l]=new L["a"](i,t,l,!1),this._outlineBatches[a+l]=new L["a"](i,t,l,!0),this._closedColorBatches[l]=new I["a"](i,p["a"],void 0,!0,l,!0),this._closedColorBatches[a+l]=new I["a"](i,p["a"],void 0,!0,l,!1),this._closedMaterialBatches[l]=new S["a"](i,u["a"],void 0,!0,l,!0),this._closedMaterialBatches[a+l]=new S["a"](i,u["a"],void 0,!0,l,!1),this._openColorBatches[l]=new I["a"](i,p["a"],void 0,!1,l,!0),this._openColorBatches[a+l]=new I["a"](i,p["a"],void 0,!1,l,!1),this._openMaterialBatches[l]=new S["a"](i,u["a"],void 0,!1,l,!0),this._openMaterialBatches[a+l]=new S["a"](i,u["a"],void 0,!1,l,!1);const h=d["a"].NUMBER_OF_CLASSIFICATION_TYPES,f=new Array(h),b=[];if(c)for(l=0;l<h;++l)b.push(new M["a"](o,l,u["a"])),f[l]=new B["a"](o,l);else for(l=0;l<h;++l)f[l]=new B["a"](o,l);this._groundColorBatches=f,this._groundMaterialBatches=b,this._dynamicBatch=new O["a"](i,o),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new n["a"],this._updaterSets=new n["a"],this._entityCollection=e,e.collectionChanged.addEventListener(k.prototype._onCollectionChanged,this),this._onCollectionChanged(e,e.values,D)}N.prototype._onEntityPropertyChanged=function(t,e,i,n){const o=this.updaters;for(let s=0;s<o.length;s++)o[s]._onEntityPropertyChanged(t,e,i,n)},N.prototype.forEach=function(t){const e=this.updaters;for(let i=0;i<e.length;i++)t(e[i])},N.prototype.destroy=function(){this.eventHelper.removeAll();const t=this.updaters;for(let e=0;e<t.length;e++)t[e].destroy();this._removeEntitySubscription(),Object(c["a"])(this)},k.prototype.update=function(t){s["a"].defined("time",t);const e=this._addedObjects,i=e.values,n=this._removedObjects,o=n.values,r=this._changedObjects,a=r.values;let c,l,h,d;const u=this;for(c=a.length-1;c>-1;c--)l=a[c],h=l.id,d=this._updaterSets.get(h),d.entity===l?d.forEach((function(e){u._removeUpdater(e),u._insertUpdaterIntoBatch(t,e)})):(o.push(l),i.push(l));for(c=o.length-1;c>-1;c--)l=o[c],h=l.id,d=this._updaterSets.get(h),d.forEach(this._removeUpdater.bind(this)),d.destroy(),this._updaterSets.remove(h),this._subscriptions.get(h)(),this._subscriptions.remove(h);for(c=i.length-1;c>-1;c--)l=i[c],h=l.id,d=new N(l,this._scene),this._updaterSets.set(h,d),d.forEach((function(e){u._insertUpdaterIntoBatch(t,e)})),this._subscriptions.set(h,d.geometryChanged.addEventListener(k._onGeometryChanged,this));e.removeAll(),n.removeAll(),r.removeAll();let p=!0;const _=this._batches,f=_.length;for(c=0;c<f;c++)p=_[c].update(t)&&p;return p};const U=[],V=new o["a"];k.prototype.getBoundingSphere=function(t,e){s["a"].defined("entity",t),s["a"].defined("result",e);const i=U,n=V;let r=0,a=f["a"].DONE;const c=this._batches,l=c.length,h=t.id,d=this._updaterSets.get(h).updaters;for(let s=0;s<d.length;s++){const t=d[s];for(let e=0;e<l;e++){if(a=c[e].getBoundingSphere(t,n),a===f["a"].PENDING)return f["a"].PENDING;a===f["a"].DONE&&(i[r]=o["a"].clone(n,i[r]),r++)}}return 0===r?f["a"].FAILED:(i.length=r,o["a"].fromBoundingSpheres(i,e),f["a"].DONE)},k.prototype.isDestroyed=function(){return!1},k.prototype.destroy=function(){let t;this._entityCollection.collectionChanged.removeEventListener(k.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();const e=this._batches;let i=e.length;for(t=0;t<i;t++)e[t].removeAllPrimitives();const n=this._subscriptions.values;for(i=n.length,t=0;t<i;t++)n[t]();this._subscriptions.removeAll();const o=this._updaterSets.values;for(i=o.length,t=0;t<i;t++)o[t].destroy();return this._updaterSets.removeAll(),Object(c["a"])(this)},k.prototype._removeUpdater=function(t){const e=this._batches,i=e.length;for(let n=0;n<i;n++)e[n].remove(t)},k.prototype._insertUpdaterIntoBatch=function(t,e){if(e.isDynamic)return void this._dynamicBatch.add(t,e);let i;(e.outlineEnabled||e.fillEnabled)&&(i=e.shadowsProperty.getValue(t));const n=_["a"].NUMBER_OF_SHADOW_MODES;if(e.outlineEnabled&&(Object(a["a"])(e.terrainOffsetProperty)?this._outlineBatches[n+i].add(t,e):this._outlineBatches[i].add(t,e)),e.fillEnabled)if(e.onTerrain){const i=e.classificationTypeProperty.getValue(t);e.fillMaterialProperty instanceof y["a"]?this._groundColorBatches[i].add(t,e):this._groundMaterialBatches[i].add(t,e)}else e.isClosed?e.fillMaterialProperty instanceof y["a"]?Object(a["a"])(e.terrainOffsetProperty)?this._closedColorBatches[n+i].add(t,e):this._closedColorBatches[i].add(t,e):Object(a["a"])(e.terrainOffsetProperty)?this._closedMaterialBatches[n+i].add(t,e):this._closedMaterialBatches[i].add(t,e):e.fillMaterialProperty instanceof y["a"]?Object(a["a"])(e.terrainOffsetProperty)?this._openColorBatches[n+i].add(t,e):this._openColorBatches[i].add(t,e):Object(a["a"])(e.terrainOffsetProperty)?this._openMaterialBatches[n+i].add(t,e):this._openMaterialBatches[i].add(t,e)},k._onGeometryChanged=function(t){const e=this._removedObjects,i=this._changedObjects,n=t.entity,o=n.id;Object(a["a"])(e.get(o))||Object(a["a"])(i.get(o))||i.set(o,n)},k.prototype._onCollectionChanged=function(t,e,i){const n=this._addedObjects,o=this._removedObjects,s=this._changedObjects;let r,a,c;for(r=i.length-1;r>-1;r--)c=i[r],a=c.id,n.remove(a)||(o.set(a,c),s.remove(a));for(r=e.length-1;r>-1;r--)c=e[r],a=c.id,o.remove(a)?s.set(a,c):n.set(a,c)},e["a"]=k},"2b83":function(t,e,i){"use strict";var n=i("dde0"),o=i("8d54"),s=i("ae9b"),r=i("0b4a"),a=i("1a5d"),c=i("c937"),l=i("e2a6"),h=i("f7b5"),d=i("b8b5"),u=i("d767"),p=i("722e"),_=i("1b9c"),f=i("6f7c"),b=i("df0d"),y=i("97f6"),g=i("3522"),m=i("d911"),O=i("984e"),v=i("e34c"),w=i("7e89"),C=i("15ae"),j=i("e91d"),E=i("bd1b"),P=i("4627"),x=i("c4b4"),I=i("3a8e5"),S=i("0400"),B=i("b054"),M=i("b816"),L=i("e7e1"),T=i("64ee"),D=i("c0c5"),A=i("c81d"),N=i("7390"),k=i("a724"),U=i("c03f"),V=i("9184"),R=i("ae81");const G=new o["a"];function H(t){return new v["a"](t)}function q(t){return Object(C["a"])(t,void 0,H)}function F(t,e){return Object(C["a"])(t,void 0,(function(t){return t instanceof e?t:new e(t)}))}function z(t){t=Object(a["a"])(t,a["a"].EMPTY_OBJECT);let e=t.id;Object(c["a"])(e)||(e=Object(r["a"])()),this._availability=void 0,this._id=e,this._definitionChanged=new h["a"],this._name=t.name,this._show=Object(a["a"])(t.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","tileset","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._tileset=void 0,this._tilesetSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=t.parent,this.merge(t)}function W(t,e,i){const n=e.length;for(let o=0;o<n;o++){const t=e[o],n=t._show,s=!i&&n,r=i&&n;s!==r&&W(t,t._children,i)}t._definitionChanged.raiseEvent(t,"isShowing",i,!i)}Object.defineProperties(z.prototype,{availability:Object(j["a"])("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:Object(j["a"])("name"),show:{get:function(){return this._show},set:function(t){if(!Object(c["a"])(t))throw new l["a"]("value is required.");if(t===this._show)return;const e=this.isShowing;this._show=t;const i=this.isShowing;e!==i&&W(this,this._children,i),this._definitionChanged.raiseEvent(this,"show",t,!t)}},isShowing:{get:function(){return this._show&&(!Object(c["a"])(this.entityCollection)||this.entityCollection.show)&&(!Object(c["a"])(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(t){const e=this._parent;if(e===t)return;const i=this.isShowing;if(Object(c["a"])(e)){const t=e._children.indexOf(this);e._children.splice(t,1)}this._parent=t,Object(c["a"])(t)&&t._children.push(this);const n=this.isShowing;i!==n&&W(this,this._children,n),this._definitionChanged.raiseEvent(this,"parent",t,e)}},propertyNames:{get:function(){return this._propertyNames}},billboard:F("billboard",m["a"]),box:F("box",O["a"]),corridor:F("corridor",w["a"]),cylinder:F("cylinder",E["a"]),description:Object(C["a"])("description"),ellipse:F("ellipse",P["a"]),ellipsoid:F("ellipsoid",x["a"]),label:F("label",I["a"]),model:F("model",S["a"]),tileset:F("tileset",B["a"]),orientation:Object(C["a"])("orientation"),path:F("path",M["a"]),plane:F("plane",L["a"]),point:F("point",T["a"]),polygon:F("polygon",D["a"]),polyline:F("polyline",A["a"]),polylineVolume:F("polylineVolume",N["a"]),properties:F("properties",U["a"]),position:q("position"),rectangle:F("rectangle",V["a"]),viewFrom:Object(C["a"])("viewFrom"),wall:F("wall",R["a"])}),z.prototype.isAvailable=function(t){if(!Object(c["a"])(t))throw new l["a"]("time is required.");const e=this._availability;return!Object(c["a"])(e)||e.contains(t)},z.prototype.addProperty=function(t){const e=this._propertyNames;if(!Object(c["a"])(t))throw new l["a"]("propertyName is required.");if(-1!==e.indexOf(t))throw new l["a"](t+" is already a registered property.");if(t in this)throw new l["a"](t+" is a reserved property name.");e.push(t),Object.defineProperty(this,t,Object(j["a"])(t,!0))},z.prototype.removeProperty=function(t){const e=this._propertyNames,i=e.indexOf(t);if(!Object(c["a"])(t))throw new l["a"]("propertyName is required.");if(-1===i)throw new l["a"](t+" is not a registered property.");this._propertyNames.splice(i,1),delete this[t]},z.prototype.merge=function(t){if(!Object(c["a"])(t))throw new l["a"]("source is required.");this.name=Object(a["a"])(this.name,t.name),this.availability=Object(a["a"])(this.availability,t.availability);const e=this._propertyNames,i=Object(c["a"])(t._propertyNames)?t._propertyNames:Object.keys(t),n=i.length;for(let o=0;o<n;o++){const n=i[o];if("parent"===n||"name"===n||"availability"===n)continue;const s=this[n],r=t[n];Object(c["a"])(s)||-1!==e.indexOf(n)||this.addProperty(n),Object(c["a"])(r)&&(Object(c["a"])(s)?Object(c["a"])(s.merge)&&s.merge(r):Object(c["a"])(r.merge)&&Object(c["a"])(r.clone)?this[n]=r.clone():this[n]=r)}};const $=new u["a"],Y=new n["a"],J=new _["a"];z.prototype.computeModelMatrix=function(t,e){s["a"].typeOf.object("time",t);const i=k["a"].getValueOrUndefined(this._position,t,Y);if(!Object(c["a"])(i))return;const n=k["a"].getValueOrUndefined(this._orientation,t,J);return e=Object(c["a"])(n)?p["a"].fromRotationTranslation(u["a"].fromQuaternion(n,$),i,e):f["a"].eastNorthUpToFixedFrame(i,void 0,e),e},z.prototype.computeModelMatrixForHeightReference=function(t,e,i,o,r){s["a"].typeOf.object("time",t);const a=k["a"].getValueOrDefault(e,t,g["a"].NONE);let l=k["a"].getValueOrUndefined(this._position,t,Y);if(a===g["a"].NONE||!Object(c["a"])(l)||n["a"].equalsEpsilon(l,n["a"].ZERO,d["a"].EPSILON8))return this.computeModelMatrix(t,r);const h=o.cartesianToCartographic(l,G);a===g["a"].CLAMP_TO_GROUND?h.height=i:h.height+=i,l=o.cartographicToCartesian(h,l);const _=k["a"].getValueOrUndefined(this._orientation,t,J);return r=Object(c["a"])(_)?p["a"].fromRotationTranslation(u["a"].fromQuaternion(_,$),l,r):f["a"].eastNorthUpToFixedFrame(l,void 0,r),r},z.supportsMaterialsforEntitiesOnTerrain=function(t){return y["a"].supportsMaterials(t)},z.supportsPolylinesOnTerrain=function(t){return b["a"].isSupported(t)},e["a"]=z},"4f1a":function(t,e,i){"use strict";var n=i("dde0"),o=i("ae9b"),s=i("1a5d"),r=i("c937"),a=i("e107"),c=i("aec1"),l=i("6247"),h=i("b8b5"),d=i("d767"),u=i("722e"),p=i("6f7c"),_=i("dc6c");const f=new d["a"],b=new d["a"],y=new d["a"],g=new u["a"],m=new n["a"],O=new n["a"],v=new n["a"],w=new n["a"],C=new n["a"],j=new n["a"],E=new l["a"],P=1.25;function x(t,e,i,o,s,a,c){const u=t.scene.mode;let x=s.getValue(a,t._lastCartesian);if(Object(r["a"])(x)){let i,I,S,B,M,L,T=!1,D=!1;if(u===_["a"].SCENE3D){l["a"].addSeconds(a,.001,E);let t=s.getValue(E,m);if(Object(r["a"])(t)||(l["a"].addSeconds(a,-.001,E),t=s.getValue(E,m),D=!0),Object(r["a"])(t)){let e,o=p["a"].computeFixedToIcrfMatrix(a,f),s=p["a"].computeFixedToIcrfMatrix(E,b);Object(r["a"])(o)&&Object(r["a"])(s)?e=d["a"].transpose(o,y):(e=p["a"].computeTemeToPseudoFixedMatrix(a,y),o=d["a"].transpose(e,f),s=p["a"].computeTemeToPseudoFixedMatrix(E,b),d["a"].transpose(s,s));const l=d["a"].multiplyByVector(o,x,C),u=d["a"].multiplyByVector(s,t,j);n["a"].subtract(l,u,w);const _=1e3*n["a"].magnitude(w),g=h["a"].GRAVITATIONALPARAMETER,B=-g/(_*_-2*g/n["a"].magnitude(l));B<0||B>P*c.maximumRadius?(i=O,n["a"].normalize(x,i),n["a"].negate(i,i),S=n["a"].clone(n["a"].UNIT_Z,v),I=n["a"].cross(S,i,m),n["a"].magnitude(I)>h["a"].EPSILON7&&(n["a"].normalize(i,i),n["a"].normalize(I,I),S=n["a"].cross(i,I,v),n["a"].normalize(S,S),T=!0)):n["a"].equalsEpsilon(x,t,h["a"].EPSILON7)||(S=O,n["a"].normalize(l,S),n["a"].normalize(u,u),I=n["a"].cross(S,u,v),D&&(I=n["a"].multiplyByScalar(I,-1,I)),n["a"].equalsEpsilon(I,n["a"].ZERO,h["a"].EPSILON7)||(i=n["a"].cross(I,S,m),d["a"].multiplyByVector(e,i,i),d["a"].multiplyByVector(e,I,I),d["a"].multiplyByVector(e,S,S),n["a"].normalize(i,i),n["a"].normalize(I,I),n["a"].normalize(S,S),T=!0))}}Object(r["a"])(t.boundingSphere)&&(x=t.boundingSphere.center),o&&(B=n["a"].clone(e.position,w),M=n["a"].clone(e.direction,C),L=n["a"].clone(e.up,j));const A=g;T?(A[0]=i.x,A[1]=i.y,A[2]=i.z,A[3]=0,A[4]=I.x,A[5]=I.y,A[6]=I.z,A[7]=0,A[8]=S.x,A[9]=S.y,A[10]=S.z,A[11]=0,A[12]=x.x,A[13]=x.y,A[14]=x.z,A[15]=0):p["a"].eastNorthUpToFixedFrame(x,c,A),e._setTransform(A),o&&(n["a"].clone(B,e.position),n["a"].clone(M,e.direction),n["a"].clone(L,e.up),n["a"].cross(M,L,e.right))}if(i){const i=u===_["a"].SCENE2D||n["a"].equals(t._offset3D,n["a"].ZERO)?void 0:t._offset3D;e.lookAtTransform(e.transform,i)}}function I(t,e,i){o["a"].defined("entity",t),o["a"].defined("scene",e),this.entity=t,this.scene=e,this.ellipsoid=Object(s["a"])(i,a["a"].WGS84),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new n["a"],this._defaultOffset3D=void 0,this._offset3D=new n["a"]}Object.defineProperties(I,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(t){this._defaultOffset3D=n["a"].clone(t,new n["a"])}}}),I.defaultOffset3D=new n["a"](-14e3,3500,3500);const S=new c["a"],B=new n["a"];I.prototype.update=function(t,e){o["a"].defined("time",t);const i=this.scene,s=this.ellipsoid,a=i.mode;if(a===_["a"].MORPHING)return;const c=this.entity,l=c.position;if(!Object(r["a"])(l))return;const d=c!==this._lastEntity,u=a!==this._mode,p=i.camera;let f=d||u,b=!0;if(d){const i=c.viewFrom,o=Object(r["a"])(i);if(!o&&Object(r["a"])(e)){S.pitch=-h["a"].PI_OVER_FOUR,S.range=0;const i=l.getValue(t,B);if(Object(r["a"])(i)){const t=2-1/Math.max(1,n["a"].magnitude(i)/s.maximumRadius);S.pitch*=t}p.viewBoundingSphere(e,S),this.boundingSphere=e,f=!1,b=!1}else o&&Object(r["a"])(i.getValue(t,this._offset3D))||n["a"].clone(I._defaultOffset3D,this._offset3D)}else u||this._mode===_["a"].SCENE2D||n["a"].clone(p.position,this._offset3D);this._lastEntity=c,this._mode=a,x(this,p,f,b,l,t,s)},e["a"]=I},6318:function(t,e,i){"use strict";var n=i("6af0"),o=i("85b2"),s=i("dde0"),r=i("1a5d"),a=i("c937"),c=i("a76e"),l=i("f7b5"),h=i("722e"),d=i("bbc8"),u=i("a3ad"),p=i("7aa8"),_=i("8a01"),f=i("b687"),b=i("d65c"),y=i("dc6c"),g=i("f019");function m(t){t=Object(r["a"])(t,r["a"].EMPTY_OBJECT),this._enabled=Object(r["a"])(t.enabled,!1),this._pixelRange=Object(r["a"])(t.pixelRange,80),this._minimumClusterSize=Object(r["a"])(t.minimumClusterSize,2),this._clusterBillboards=Object(r["a"])(t.clusterBillboards,!0),this._clusterLabels=Object(r["a"])(t.clusterLabels,!0),this._clusterPoints=Object(r["a"])(t.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new l["a"],this.show=Object(r["a"])(t.show,!0)}function O(t){return t.coord.x}function v(t){return t.coord.y}function w(t,e){t.x-=e,t.y-=e,t.width+=2*e,t.height+=2*e}const C=new n["a"];function j(t,e,i,o,s){if(Object(a["a"])(t._labelCollection)&&o._clusterLabels?s=p["a"].getScreenSpaceBoundingBox(t,e,s):Object(a["a"])(t._billboardCollection)&&o._clusterBillboards?s=d["a"].getScreenSpaceBoundingBox(t,e,s):Object(a["a"])(t._pointPrimitiveCollection)&&o._clusterPoints&&(s=f["a"].getScreenSpaceBoundingBox(t,e,s)),w(s,i),o._clusterLabels&&!Object(a["a"])(t._labelCollection)&&Object(a["a"])(t.id)&&x(o,t.id.id)&&Object(a["a"])(t.id._label)){const r=o._collectionIndicesByEntity[t.id.id].labelIndex,a=o._labelCollection.get(r),c=p["a"].getScreenSpaceBoundingBox(a,e,C);w(c,i),s=n["a"].union(s,c,s)}return s}function E(t,e){if(t.clusterShow=!0,!Object(a["a"])(t._labelCollection)&&Object(a["a"])(t.id)&&x(e,t.id.id)&&Object(a["a"])(t.id._label)){const i=e._collectionIndicesByEntity[t.id.id].labelIndex,n=e._labelCollection.get(i);n.clusterShow=!0}}function P(t,e,i,n){const o={billboard:n._clusterBillboardCollection.add(),label:n._clusterLabelCollection.add(),point:n._clusterPointCollection.add()};o.billboard.show=!1,o.point.show=!1,o.label.show=!0,o.label.text=e.toLocaleString(),o.label.id=i,o.billboard.position=o.label.position=o.point.position=t,n._clusterEvent.raiseEvent(i,o)}function x(t,e){return Object(a["a"])(t)&&Object(a["a"])(t._collectionIndicesByEntity[e])&&Object(a["a"])(t._collectionIndicesByEntity[e].labelIndex)}function I(t,e,i,n,o){if(!Object(a["a"])(t))return;const s=t.length;for(let r=0;r<s;++r){const s=t.get(r);if(s.clusterShow=!1,!s.show||o._scene.mode===y["a"].SCENE3D&&!n.isPointVisible(s.position))continue;const c=o._clusterLabels&&Object(a["a"])(s._labelCollection),l=o._clusterBillboards&&Object(a["a"])(s.id._billboard),h=o._clusterPoints&&Object(a["a"])(s.id._point);if(c&&(h||l))continue;const d=s.computeScreenSpacePosition(i);Object(a["a"])(d)&&e.push({index:r,collection:t,clustered:!1,coord:d})}}const S=new n["a"],B=new n["a"],M=new n["a"];function L(t){return function(e){if(Object(a["a"])(e)&&e<.05||!t.enabled)return;const i=t._scene,r=t._labelCollection,l=t._billboardCollection,p=t._pointCollection;if(!Object(a["a"])(r)&&!Object(a["a"])(l)&&!Object(a["a"])(p)||!t._clusterBillboards&&!t._clusterLabels&&!t._clusterPoints)return;let f=t._clusterLabelCollection,y=t._clusterBillboardCollection,m=t._clusterPointCollection;Object(a["a"])(f)?f.removeAll():f=t._clusterLabelCollection=new _["a"]({scene:i}),Object(a["a"])(y)?y.removeAll():y=t._clusterBillboardCollection=new u["a"]({scene:i}),Object(a["a"])(m)?m.removeAll():m=t._clusterPointCollection=new b["a"];const w=t._pixelRange,C=t._minimumClusterSize,x=t._previousClusters,L=[],T=t._previousHeight,D=i.camera.positionCartographic.height,A=i.mapProjection.ellipsoid,N=i.camera.positionWC,k=new c["a"](A,N),U=[];let V,R,G,H,q,F,z,W,$,Y,J,X;t._clusterLabels&&I(r,U,i,k,t),t._clusterBillboards&&I(l,U,i,k,t),t._clusterPoints&&I(p,U,i,k,t);const Z=new g["a"](U,O,v,64,Int32Array);if(D<T)for(G=x.length,V=0;V<G;++V){const e=x[V];if(!k.isPointVisible(e.position))continue;const n=d["a"]._computeScreenSpacePosition(h["a"].IDENTITY,e.position,s["a"].ZERO,o["a"].ZERO,i);if(!Object(a["a"])(n))continue;const r=1-D/T;let c=e.width=e.width*r,l=e.height=e.height*r;c=Math.max(c,e.minimumWidth),l=Math.max(l,e.minimumHeight);const u=n.x-.5*c,p=n.y-.5*l,_=n.x+c,f=n.y+l;for(q=Z.range(u,p,_,f),F=q.length,Y=0,$=[],R=0;R<F;++R)z=q[R],W=U[z],W.clustered||(++Y,J=W.collection,X=W.index,$.push(J.get(X).id));if(Y>=C)for(P(e.position,Y,$,t),L.push(e),R=0;R<F;++R)U[q[R]].clustered=!0}for(G=U.length,V=0;V<G;++V){const e=U[V];if(e.clustered)continue;e.clustered=!0,J=e.collection,X=e.index;const i=J.get(X);H=j(i,e.coord,w,t,S);const o=n["a"].clone(H,B);q=Z.range(H.x,H.y,H.x+H.width,H.y+H.height),F=q.length;const r=s["a"].clone(i.position);for(Y=1,$=[i.id],R=0;R<F;++R)if(z=q[R],W=U[z],!W.clustered){const e=W.collection.get(W.index),i=j(e,W.coord,w,t,M);s["a"].add(e.position,r,r),n["a"].union(o,i,o),++Y,$.push(e.id)}if(Y>=C){const e=s["a"].multiplyByScalar(r,1/Y,r);for(P(e,Y,$,t),L.push({position:e,width:o.width,height:o.height,minimumWidth:H.width,minimumHeight:H.height}),R=0;R<F;++R)U[q[R]].clustered=!0}else E(i,t)}0===f.length&&(f.destroy(),t._clusterLabelCollection=void 0),0===y.length&&(y.destroy(),t._clusterBillboardCollection=void 0),0===m.length&&(m.destroy(),t._clusterPointCollection=void 0),t._previousClusters=L,t._previousHeight=D}}function T(t,e,i,n){return function(o){let s=this[t];Object(a["a"])(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let r,c,l=this._collectionIndicesByEntity[o.id];if(Object(a["a"])(l)||(l=this._collectionIndicesByEntity[o.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),Object(a["a"])(s)&&Object(a["a"])(l[n]))return s.get(l[n]);Object(a["a"])(s)||(s=this[t]=new e({scene:this._scene}));const h=this[i];h.length>0?(r=h.pop(),c=s.get(r)):(c=s.add(),r=s.length-1),l[n]=r;const d=this;return Promise.resolve().then((function(){d._clusterDirty=!0})),c}}function D(t,e){const i=t._collectionIndicesByEntity[e];Object(a["a"])(i.billboardIndex)||Object(a["a"])(i.labelIndex)||Object(a["a"])(i.pointIndex)||delete t._collectionIndicesByEntity[e]}function A(t){if(!Object(a["a"])(t))return;const e=t.length;for(let i=0;i<e;++i)t.get(i).clusterShow=!0}function N(t){t.enabled||(Object(a["a"])(t._clusterLabelCollection)&&t._clusterLabelCollection.destroy(),Object(a["a"])(t._clusterBillboardCollection)&&t._clusterBillboardCollection.destroy(),Object(a["a"])(t._clusterPointCollection)&&t._clusterPointCollection.destroy(),t._clusterLabelCollection=void 0,t._clusterBillboardCollection=void 0,t._clusterPointCollection=void 0,A(t._labelCollection),A(t._billboardCollection),A(t._pointCollection))}m.prototype._initialize=function(t){this._scene=t;const e=L(this);this._cluster=e,this._removeEventListener=t.camera.changed.addEventListener(e)},Object.defineProperties(m.prototype,{enabled:{get:function(){return this._enabled},set:function(t){this._enabledDirty=t!==this._enabled,this._enabled=t}},pixelRange:{get:function(){return this._pixelRange},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._pixelRange,this._pixelRange=t}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._minimumClusterSize,this._minimumClusterSize=t}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._clusterBillboards,this._clusterBillboards=t}},clusterLabels:{get:function(){return this._clusterLabels},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._clusterLabels,this._clusterLabels=t}},clusterPoints:{get:function(){return this._clusterPoints},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._clusterPoints,this._clusterPoints=t}}}),m.prototype.getLabel=T("_labelCollection",_["a"],"_unusedLabelIndices","labelIndex"),m.prototype.removeLabel=function(t){const e=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[t.id];if(!Object(a["a"])(this._labelCollection)||!Object(a["a"])(e)||!Object(a["a"])(e.labelIndex))return;const i=e.labelIndex;e.labelIndex=void 0,D(this,t.id);const n=this._labelCollection.get(i);n.show=!1,n.text="",n.id=void 0,this._unusedLabelIndices.push(i),this._clusterDirty=!0},m.prototype.getBillboard=T("_billboardCollection",u["a"],"_unusedBillboardIndices","billboardIndex"),m.prototype.removeBillboard=function(t){const e=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[t.id];if(!Object(a["a"])(this._billboardCollection)||!Object(a["a"])(e)||!Object(a["a"])(e.billboardIndex))return;const i=e.billboardIndex;e.billboardIndex=void 0,D(this,t.id);const n=this._billboardCollection.get(i);n.id=void 0,n.show=!1,n.image=void 0,this._unusedBillboardIndices.push(i),this._clusterDirty=!0},m.prototype.getPoint=T("_pointCollection",b["a"],"_unusedPointIndices","pointIndex"),m.prototype.removePoint=function(t){const e=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[t.id];if(!Object(a["a"])(this._pointCollection)||!Object(a["a"])(e)||!Object(a["a"])(e.pointIndex))return;const i=e.pointIndex;e.pointIndex=void 0,D(this,t.id);const n=this._pointCollection.get(i);n.show=!1,n.id=void 0,this._unusedPointIndices.push(i),this._clusterDirty=!0},m.prototype.update=function(t){if(!this.show)return;let e;Object(a["a"])(this._labelCollection)&&this._labelCollection.length>0&&0===this._labelCollection.get(0)._glyphs.length&&(e=t.commandList,t.commandList=[],this._labelCollection.update(t),t.commandList=e),Object(a["a"])(this._billboardCollection)&&this._billboardCollection.length>0&&!Object(a["a"])(this._billboardCollection.get(0).width)&&(e=t.commandList,t.commandList=[],this._billboardCollection.update(t),t.commandList=e),this._enabledDirty&&(this._enabledDirty=!1,N(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),Object(a["a"])(this._clusterLabelCollection)&&this._clusterLabelCollection.update(t),Object(a["a"])(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(t),Object(a["a"])(this._clusterPointCollection)&&this._clusterPointCollection.update(t),Object(a["a"])(this._labelCollection)&&this._labelCollection.update(t),Object(a["a"])(this._billboardCollection)&&this._billboardCollection.update(t),Object(a["a"])(this._pointCollection)&&this._pointCollection.update(t)},m.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),Object(a["a"])(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1},e["a"]=m},"671f":function(t,e,i){"use strict";var n=i("85b2"),o=i("4051"),s=i("1a5d"),r=i("c937"),a=i("f7b5"),c=i("15ae"),l=i("a724");const h=o["a"].WHITE,d=.1,u=new n["a"](8,8),p=new n["a"](0,0),_=new n["a"](1,1);function f(t){t=Object(s["a"])(t,s["a"].EMPTY_OBJECT),this._definitionChanged=new a["a"],this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=t.color,this.cellAlpha=t.cellAlpha,this.lineCount=t.lineCount,this.lineThickness=t.lineThickness,this.lineOffset=t.lineOffset}Object.defineProperties(f.prototype,{isConstant:{get:function(){return l["a"].isConstant(this._color)&&l["a"].isConstant(this._cellAlpha)&&l["a"].isConstant(this._lineCount)&&l["a"].isConstant(this._lineThickness)&&l["a"].isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:Object(c["a"])("color"),cellAlpha:Object(c["a"])("cellAlpha"),lineCount:Object(c["a"])("lineCount"),lineThickness:Object(c["a"])("lineThickness"),lineOffset:Object(c["a"])("lineOffset")}),f.prototype.getType=function(t){return"Grid"},f.prototype.getValue=function(t,e){return Object(r["a"])(e)||(e={}),e.color=l["a"].getValueOrClonedDefault(this._color,t,h,e.color),e.cellAlpha=l["a"].getValueOrDefault(this._cellAlpha,t,d),e.lineCount=l["a"].getValueOrClonedDefault(this._lineCount,t,u,e.lineCount),e.lineThickness=l["a"].getValueOrClonedDefault(this._lineThickness,t,_,e.lineThickness),e.lineOffset=l["a"].getValueOrClonedDefault(this._lineOffset,t,p,e.lineOffset),e},f.prototype.equals=function(t){return this===t||t instanceof f&&l["a"].equals(this._color,t._color)&&l["a"].equals(this._cellAlpha,t._cellAlpha)&&l["a"].equals(this._lineCount,t._lineCount)&&l["a"].equals(this._lineThickness,t._lineThickness)&&l["a"].equals(this._lineOffset,t._lineOffset)},e["a"]=f},"6ec6":function(t,e,i){"use strict";var n=i("f83b"),o=i("0b4a"),s=i("c937"),r=i("e2a6"),a=i("f7b5"),c=i("fff3"),l=i("6247"),h=i("e2aa"),d=i("1b98"),u=i("2b83");const p={id:void 0};function _(t){if(t._firing)t._refire=!0;else if(0===t._suspendCount){const e=t._addedEntities,i=t._removedEntities,n=t._changedEntities;if(0!==n.length||0!==e.length||0!==i.length){t._firing=!0;do{t._refire=!1;const o=e.values.slice(0),s=i.values.slice(0),r=n.values.slice(0);e.removeAll(),i.removeAll(),n.removeAll(),t._collectionChanged.raiseEvent(t,o,s,r)}while(t._refire);t._firing=!1}}}function f(t){this._owner=t,this._entities=new n["a"],this._addedEntities=new n["a"],this._removedEntities=new n["a"],this._changedEntities=new n["a"],this._suspendCount=0,this._collectionChanged=new a["a"],this._id=Object(o["a"])(),this._show=!0,this._firing=!1,this._refire=!1}f.prototype.suspendEvents=function(){this._suspendCount++},f.prototype.resumeEvents=function(){if(0===this._suspendCount)throw new r["a"]("resumeEvents can not be called before suspendEvents.");this._suspendCount--,_(this)},f.collectionChangedEventCallback=void 0,Object.defineProperties(f.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(t){if(!Object(s["a"])(t))throw new r["a"]("value is required.");if(t===this._show)return;let e;this.suspendEvents();const i=[],n=this._entities.values,o=n.length;for(e=0;e<o;e++)i.push(n[e].isShowing);for(this._show=t,e=0;e<o;e++){const t=i[e],o=n[e];t!==o.isShowing&&o.definitionChanged.raiseEvent(o,"isShowing",o.isShowing,t)}this.resumeEvents()}},owner:{get:function(){return this._owner}}}),f.prototype.computeAvailability=function(){let t=c["a"].MAXIMUM_VALUE,e=c["a"].MINIMUM_VALUE;const i=this._entities.values;for(let n=0,o=i.length;n<o;n++){const o=i[n],r=o.availability;if(Object(s["a"])(r)){const i=r.start,n=r.stop;l["a"].lessThan(i,t)&&!i.equals(c["a"].MINIMUM_VALUE)&&(t=i),l["a"].greaterThan(n,e)&&!n.equals(c["a"].MAXIMUM_VALUE)&&(e=n)}}return c["a"].MAXIMUM_VALUE.equals(t)&&(t=c["a"].MINIMUM_VALUE),c["a"].MINIMUM_VALUE.equals(e)&&(e=c["a"].MAXIMUM_VALUE),new d["a"]({start:t,stop:e})},f.prototype.add=function(t){if(!Object(s["a"])(t))throw new r["a"]("entity is required.");t instanceof u["a"]||(t=new u["a"](t));const e=t.id,i=this._entities;if(i.contains(e))throw new h["a"](`An entity with id ${e} already exists in this collection.`);return t.entityCollection=this,i.set(e,t),this._removedEntities.remove(e)||this._addedEntities.set(e,t),t.definitionChanged.addEventListener(f.prototype._onEntityDefinitionChanged,this),_(this),t},f.prototype.remove=function(t){return!!Object(s["a"])(t)&&this.removeById(t.id)},f.prototype.contains=function(t){if(!Object(s["a"])(t))throw new r["a"]("entity is required");return this._entities.get(t.id)===t},f.prototype.removeById=function(t){if(!Object(s["a"])(t))return!1;const e=this._entities,i=e.get(t);return!!this._entities.remove(t)&&(this._addedEntities.remove(t)||(this._removedEntities.set(t,i),this._changedEntities.remove(t)),this._entities.remove(t),i.definitionChanged.removeEventListener(f.prototype._onEntityDefinitionChanged,this),_(this),!0)},f.prototype.removeAll=function(){const t=this._entities,e=t.length,i=t.values,n=this._addedEntities,o=this._removedEntities;for(let r=0;r<e;r++){const t=i[r],e=t.id,a=n.get(e);Object(s["a"])(a)||(t.definitionChanged.removeEventListener(f.prototype._onEntityDefinitionChanged,this),o.set(e,t))}t.removeAll(),n.removeAll(),this._changedEntities.removeAll(),_(this)},f.prototype.getById=function(t){if(!Object(s["a"])(t))throw new r["a"]("id is required.");return this._entities.get(t)},f.prototype.getOrCreateEntity=function(t){if(!Object(s["a"])(t))throw new r["a"]("id is required.");let e=this._entities.get(t);return Object(s["a"])(e)||(p.id=t,e=new u["a"](p),this.add(e)),e},f.prototype._onEntityDefinitionChanged=function(t){const e=t.id;this._addedEntities.contains(e)||this._changedEntities.set(e,t),_(this)},e["a"]=f},7148:function(t,e,i){"use strict";var n=i("ae9b"),o=i("1a5d"),s=i("c937"),r=i("e2a6"),a=i("e148"),c=i("e47d"),l=i("97f6"),h=i("3522"),d=i("2cae"),u=i("63c1"),p=i("ca1b"),_=i("a59b");const f=new u["a"](0);function b(t){p["a"].call(this,t),this._zIndex=0,this._terrainOffsetProperty=void 0}Object(s["a"])(Object.create)&&(b.prototype=Object.create(p["a"].prototype),b.prototype.constructor=b),Object.defineProperties(b.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),b.prototype._isOnTerrain=function(t,e){return this._fillEnabled&&!Object(s["a"])(e.height)&&!Object(s["a"])(e.extrudedHeight)&&l["a"].isSupported(this._scene)},b.prototype._getIsClosed=function(t){const e=t.height,i=t.extrudedHeight;return 0===e||Object(s["a"])(i)&&i!==e},b.prototype._computeCenter=r["a"].throwInstantiationError,b.prototype._onEntityPropertyChanged=function(t,e,i,n){if(p["a"].prototype._onEntityPropertyChanged.call(this,t,e,i,n),-1===this._observedPropertyNames.indexOf(e))return;const r=this._entity[this._geometryPropertyName];if(!Object(s["a"])(r))return;Object(s["a"])(r.zIndex)&&(Object(s["a"])(r.height)||Object(s["a"])(r.extrudedHeight))&&Object(c["a"])(c["a"].geometryZIndex),this._zIndex=Object(o["a"])(r.zIndex,f),Object(s["a"])(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);const a=r.heightReference,l=r.extrudedHeightReference;if(Object(s["a"])(a)||Object(s["a"])(l)){const t=new d["a"](this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new _["a"](this._scene,t,a,l)}},b.prototype.destroy=function(){Object(s["a"])(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),p["a"].prototype.destroy.call(this)},b.getGeometryHeight=function(t,e){if(n["a"].defined("heightReference",e),Object(s["a"])(t))return e!==h["a"].CLAMP_TO_GROUND?t:0;e!==h["a"].NONE&&Object(c["a"])(c["a"].geometryHeightReference)},b.getGeometryExtrudedHeight=function(t,e){if(n["a"].defined("extrudedHeightReference",e),Object(s["a"])(t))return e!==h["a"].CLAMP_TO_GROUND?t:b.CLAMP_TO_GROUND;e!==h["a"].NONE&&Object(c["a"])(c["a"].geometryExtrudedHeightReference)},b.CLAMP_TO_GROUND="clamp",b.computeGeometryOffsetAttribute=function(t,e,i,n){Object(s["a"])(t)&&Object(s["a"])(e)||(e=h["a"].NONE),Object(s["a"])(i)&&Object(s["a"])(n)||(n=h["a"].NONE);let o=0;return e!==h["a"].NONE&&o++,n===h["a"].RELATIVE_TO_GROUND&&o++,2===o?a["a"].ALL:1===o?a["a"].TOP:void 0},e["a"]=b},"83f5":function(t,e,i){"use strict";var n=i("0e04"),o=i("dde0"),s=i("4051"),r=i("0b4a"),a=i("3736"),c=i("1a5d"),l=i("c937"),h=i("e2a6"),d=i("f7b5"),u=i("478e"),p=i("aea3"),_=i("7860"),f=i("9f38"),b=i("e2aa"),y=i("3522"),g=i("c9db"),m=i("3a54"),O=i("d911"),v=i("2cae"),w=i("b32b"),C=i("e34c"),j=i("63c1"),E=i("0b0b"),P=i("6318"),x=i("6ec6"),I=i("c0c5"),S=i("c81d");function B(t){return o["a"].fromDegrees(t[0],t[1],t[2])}const M={"urn:ogc:def:crs:OGC:1.3:CRS84":B,"EPSG:4326":B,"urn:ogc:def:crs:EPSG::4326":B},L={},T={};let D,A=48,N=s["a"].ROYALBLUE,k=s["a"].YELLOW,U=2,V=s["a"].fromBytes(255,255,0,100),R=!1;const G={small:24,medium:48,large:64},H=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function q(t,e){let i="";for(const n in t)if(t.hasOwnProperty(n)){if(n===e||-1!==H.indexOf(n))continue;const o=t[n];Object(l["a"])(o)&&(i+="object"===typeof o?`<tr><th>${n}</th><td>${q(o)}</td></tr>`:`<tr><th>${n}</th><td>${o}</td></tr>`)}return i.length>0&&(i=`<table class="cesium-infoBox-defaultTable"><tbody>${i}</tbody></table>`),i}function F(t,e,i){let n;return function(o,s){return Object(l["a"])(n)||(n=t(e,i)),n}}function z(t,e){return new v["a"](F(q,t,e),!0)}function W(t,e,i){let n=t.id;if(Object(l["a"])(n)&&"Feature"===t.type){let t=2,i=n;while(Object(l["a"])(e.getById(i)))i=`${n}_${t}`,t++;n=i}else n=Object(r["a"])();const o=e.getOrCreateEntity(n),s=t.properties;if(Object(l["a"])(s)){let t;o.properties=s;const e=s.title;if(Object(l["a"])(e))o.name=e,t="title";else{let e=Number.MAX_VALUE;for(const i in s)if(s.hasOwnProperty(i)&&s[i]){const n=i.toLowerCase();if(e>1&&"title"===n){e=1,t=i;break}e>2&&"name"===n?(e=2,t=i):e>3&&/title/i.test(i)?(e=3,t=i):e>4&&/name/i.test(i)&&(e=4,t=i)}Object(l["a"])(t)&&(o.name=s[t])}const n=s.description;null!==n&&(o.description=Object(l["a"])(n)?new j["a"](n):i(s,t))}return o}function $(t,e){const i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=e(t[n]);return i}const Y={Feature:X,FeatureCollection:Z,GeometryCollection:K,LineString:nt,MultiLineString:ot,MultiPoint:et,MultiPolygon:at,Point:tt,Polygon:rt,Topology:ct},J={GeometryCollection:K,LineString:nt,MultiLineString:ot,MultiPoint:et,MultiPolygon:at,Point:tt,Polygon:rt,Topology:ct};function X(t,e,i,n,o){if(null===e.geometry)return void W(e,t._entityCollection,o.describe);if(!Object(l["a"])(e.geometry))throw new b["a"]("feature.geometry is required.");const s=e.geometry.type,r=J[s];if(!Object(l["a"])(r))throw new b["a"]("Unknown geometry type: "+s);r(t,e,e.geometry,n,o)}function Z(t,e,i,n,o){const s=e.features;for(let r=0,a=s.length;r<a;r++)X(t,s[r],void 0,n,o)}function K(t,e,i,n,o){const s=i.geometries;for(let r=0,a=s.length;r<a;r++){const i=s[r],a=i.type,c=J[a];if(!Object(l["a"])(c))throw new b["a"]("Unknown geometry type: "+a);c(t,e,i,n,o)}}function Q(t,e,i,n,o){let r=o.markerSymbol,a=o.markerColor,h=o.markerSize;const d=e.properties;if(Object(l["a"])(d)){const t=d["marker-color"];Object(l["a"])(t)&&(a=s["a"].fromCssColorString(t)),h=Object(c["a"])(G[d["marker-size"]],h);const e=d["marker-symbol"];Object(l["a"])(e)&&(r=e)}let u;u=Object(l["a"])(r)?1===r.length?t._pinBuilder.fromText(r.toUpperCase(),a,h):t._pinBuilder.fromMakiIconId(r,a,h):t._pinBuilder.fromColor(a,h);const p=new O["a"];p.verticalOrigin=new j["a"](g["a"].BOTTOM),2===n.length&&o.clampToGround&&(p.heightReference=y["a"].CLAMP_TO_GROUND);const _=W(e,t._entityCollection,o.describe);_.billboard=p,_.position=new C["a"](i(n));const f=Promise.resolve(u).then((function(t){p.image=new j["a"](t)})).catch((function(){p.image=new j["a"](t._pinBuilder.fromColor(a,h))}));t._promises.push(f)}function tt(t,e,i,n,o){Q(t,e,n,i.coordinates,o)}function et(t,e,i,n,o){const s=i.coordinates;for(let r=0;r<s.length;r++)Q(t,e,n,s[r],o)}function it(t,e,i,o,r){let a=r.strokeMaterialProperty,c=r.strokeWidthProperty;const h=e.properties;if(Object(l["a"])(h)){const t=h["stroke-width"];let e;Object(l["a"])(t)&&(c=new j["a"](t));const i=h.stroke;Object(l["a"])(i)&&(e=s["a"].fromCssColorString(i));const n=h["stroke-opacity"];Object(l["a"])(n)&&1!==n&&(Object(l["a"])(e)||(e=a.color.getValue().clone()),e.alpha=n),Object(l["a"])(e)&&(a=new w["a"](e))}const d=W(e,t._entityCollection,r.describe),u=new S["a"];d.polyline=u,u.clampToGround=r.clampToGround,u.material=a,u.width=c,u.positions=new j["a"]($(o,i)),u.arcType=n["a"].RHUMB}function nt(t,e,i,n,o){it(t,e,n,i.coordinates,o)}function ot(t,e,i,n,o){const s=i.coordinates;for(let r=0;r<s.length;r++)it(t,e,n,s[r],o)}function st(t,e,i,o,r){if(0===o.length||0===o[0].length)return;let a=r.strokeMaterialProperty.color,c=r.fillMaterialProperty,h=r.strokeWidthProperty;const d=e.properties;if(Object(l["a"])(d)){const t=d["stroke-width"];let e;Object(l["a"])(t)&&(h=new j["a"](t));const i=d.stroke;Object(l["a"])(i)&&(e=s["a"].fromCssColorString(i));let n,o=d["stroke-opacity"];Object(l["a"])(o)&&1!==o&&(Object(l["a"])(e)||(e=a.getValue().clone()),e.alpha=o),Object(l["a"])(e)&&(a=new j["a"](e));const r=d.fill,u=c.color.getValue();Object(l["a"])(r)&&(n=s["a"].fromCssColorString(r),n.alpha=u.alpha),o=d["fill-opacity"],Object(l["a"])(o)&&o!==u.alpha&&(Object(l["a"])(n)||(n=u.clone()),n.alpha=o),Object(l["a"])(n)&&(c=new w["a"](n))}const u=new I["a"];u.outline=new j["a"](!0),u.outlineColor=a,u.outlineWidth=h,u.material=c,u.arcType=n["a"].RHUMB;const p=[];for(let n=1,s=o.length;n<s;n++)p.push(new _["a"]($(o[n],i)));const f=o[0];u.hierarchy=new j["a"](new _["a"]($(f,i),p)),f[0].length>2?u.perPositionHeight=new j["a"](!0):r.clampToGround||(u.height=0);const b=W(e,t._entityCollection,r.describe);b.polygon=u}function rt(t,e,i,n,o){st(t,e,n,i.coordinates,o)}function at(t,e,i,n,o){const s=i.coordinates;for(let r=0;r<s.length;r++)st(t,e,n,s[r],o)}function ct(t,e,i,n,o){for(const s in i.objects)if(i.objects.hasOwnProperty(s)){const e=m["a"].feature(i,i.objects[s]),r=Y[e.type];r(t,e,e,n,o)}}function lt(t){this._name=t,this._changed=new d["a"],this._error=new d["a"],this._isLoading=!1,this._loading=new d["a"],this._entityCollection=new x["a"](this),this._promises=[],this._pinBuilder=new p["a"],this._entityCluster=new P["a"],this._credit=void 0,this._resourceCredits=[]}function ht(t,e,i,n){let o;Object(l["a"])(n)&&(o=Object(u["a"])(n)),Object(l["a"])(o)&&t._name!==o&&(t._name=o,t._changed.raiseEvent(t));const s=Y[e.type];if(!Object(l["a"])(s))throw new b["a"]("Unsupported GeoJSON object type: "+e.type);const r=e.crs;let a=null!==r?B:null;if(Object(l["a"])(r)){if(!Object(l["a"])(r.properties))throw new b["a"]("crs.properties is undefined.");const t=r.properties;if("name"===r.type){if(a=M[t.name],!Object(l["a"])(a))throw new b["a"]("Unknown crs name: "+t.name)}else if("link"===r.type){let e=L[t.href];if(Object(l["a"])(e)||(e=T[t.type]),!Object(l["a"])(e))throw new b["a"]("Unable to resolve crs link: "+JSON.stringify(t));a=e(t)}else{if("EPSG"!==r.type)throw new b["a"]("Unknown crs type: "+r.type);if(a=M["EPSG:"+t.code],!Object(l["a"])(a))throw new b["a"]("Unknown crs EPSG code: "+t.code)}}return Promise.resolve(a).then((function(n){return t._entityCollection.removeAll(),null!==n&&s(t,e,e,n,i),Promise.all(t._promises).then((function(){return t._promises.length=0,E["a"].setLoading(t,!1),t}))}))}lt.load=function(t,e){return(new lt).load(t,e)},Object.defineProperties(lt,{markerSize:{get:function(){return A},set:function(t){A=t}},markerSymbol:{get:function(){return D},set:function(t){D=t}},markerColor:{get:function(){return N},set:function(t){N=t}},stroke:{get:function(){return k},set:function(t){k=t}},strokeWidth:{get:function(){return U},set:function(t){U=t}},fill:{get:function(){return V},set:function(t){V=t}},clampToGround:{get:function(){return R},set:function(t){R=t}},crsNames:{get:function(){return M}},crsLinkHrefs:{get:function(){return L}},crsLinkTypes:{get:function(){return T}}}),Object.defineProperties(lt.prototype,{name:{get:function(){return this._name},set:function(t){this._name!==t&&(this._name=t,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){if(!Object(l["a"])(t))throw new h["a"]("value must be defined.");this._entityCluster=t}},credit:{get:function(){return this._credit}}}),lt.prototype.load=function(t,e){if(!Object(l["a"])(t))throw new h["a"]("data is required.");E["a"].setLoading(this,!0),e=Object(c["a"])(e,c["a"].EMPTY_OBJECT);let i=e.credit;"string"===typeof i&&(i=new a["a"](i)),this._credit=i;let n=t,o=e.sourceUri;if("string"===typeof t||t instanceof f["a"]){t=f["a"].createIfNeeded(t),n=t.fetchJson(),o=Object(c["a"])(o,t.getUrlComponent());const e=this._resourceCredits,i=t.credits;if(Object(l["a"])(i)){const t=i.length;for(let n=0;n<t;n++)e.push(i[n])}}e={describe:Object(c["a"])(e.describe,z),markerSize:Object(c["a"])(e.markerSize,A),markerSymbol:Object(c["a"])(e.markerSymbol,D),markerColor:Object(c["a"])(e.markerColor,N),strokeWidthProperty:new j["a"](Object(c["a"])(e.strokeWidth,U)),strokeMaterialProperty:new w["a"](Object(c["a"])(e.stroke,k)),fillMaterialProperty:new w["a"](Object(c["a"])(e.fill,V)),clampToGround:Object(c["a"])(e.clampToGround,R)};const s=this;return Promise.resolve(n).then((function(t){return ht(s,t,e,o)})).catch((function(t){return E["a"].setLoading(s,!1),s._error.raiseEvent(s,t),console.log(t),Promise.reject(t)}))},lt.prototype.update=function(t){return!0},e["a"]=lt},ca1b:function(t,e,i){"use strict";var n=i("ae9b"),o=i("4051"),s=i("1a5d"),r=i("c937"),a=i("21b7"),c=i("e2a6"),l=i("aecc"),h=i("f7b5"),d=i("fff3"),u=i("e47d"),p=i("4a43"),_=i("ff3a"),f=i("b32b"),b=i("63c1"),y=i("2b83"),g=i("a724");const m=new f["a"](o["a"].WHITE),O=new b["a"](!0),v=new b["a"](!0),w=new b["a"](!1),C=new b["a"](o["a"].BLACK),j=new b["a"](_["a"].DISABLED),E=new b["a"](new l["a"]),P=new b["a"](p["a"].BOTH);function x(t){n["a"].defined("options.entity",t.entity),n["a"].defined("options.scene",t.scene),n["a"].defined("options.geometryOptions",t.geometryOptions),n["a"].defined("options.geometryPropertyName",t.geometryPropertyName),n["a"].defined("options.observedPropertyNames",t.observedPropertyNames);const e=t.entity,i=t.geometryPropertyName;this._entity=e,this._scene=t.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new h["a"],this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=t.geometryOptions,this._geometryPropertyName=i,this._id=`${i}-${e.id}`,this._observedPropertyNames=t.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=y["a"].supportsMaterialsforEntitiesOnTerrain(t.scene)}Object.defineProperties(x.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!Object(r["a"])(this._entity.availability)&&g["a"].isConstant(this._showProperty)&&g["a"].isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!Object(r["a"])(this._entity.availability)&&g["a"].isConstant(this._showProperty)&&g["a"].isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),x.prototype.isOutlineVisible=function(t){const e=this._entity,i=this._outlineEnabled&&e.isAvailable(t)&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t);return Object(s["a"])(i,!1)},x.prototype.isFilled=function(t){const e=this._entity,i=this._fillEnabled&&e.isAvailable(t)&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t);return Object(s["a"])(i,!1)},x.prototype.createFillGeometryInstance=c["a"].throwInstantiationError,x.prototype.createOutlineGeometryInstance=c["a"].throwInstantiationError,x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){Object(a["a"])(this)},x.prototype._isHidden=function(t,e){const i=e.show;return Object(r["a"])(i)&&i.isConstant&&!i.getValue(d["a"].MINIMUM_VALUE)},x.prototype._isOnTerrain=function(t,e){return!1},x.prototype._getIsClosed=function(t){return!0},x.prototype._isDynamic=c["a"].throwInstantiationError,x.prototype._setStaticOptions=c["a"].throwInstantiationError,x.prototype._onEntityPropertyChanged=function(t,e,i,n){if(-1===this._observedPropertyNames.indexOf(e))return;const o=this._entity[this._geometryPropertyName];if(!Object(r["a"])(o))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));const a=o.fill,c=!Object(r["a"])(a)||!a.isConstant||a.getValue(d["a"].MINIMUM_VALUE),l=o.outline;let h=Object(r["a"])(l);if(h&&l.isConstant&&(h=l.getValue(d["a"].MINIMUM_VALUE)),!c&&!h)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));const p=o.show;if(this._isHidden(t,o))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));this._materialProperty=Object(s["a"])(o.material,m),this._fillProperty=Object(s["a"])(a,v),this._showProperty=Object(s["a"])(p,O),this._showOutlineProperty=Object(s["a"])(o.outline,w),this._outlineColorProperty=h?Object(s["a"])(o.outlineColor,C):void 0,this._shadowsProperty=Object(s["a"])(o.shadows,j),this._distanceDisplayConditionProperty=Object(s["a"])(o.distanceDisplayCondition,E),this._classificationTypeProperty=Object(s["a"])(o.classificationType,P),this._fillEnabled=c;const _=this._isOnTerrain(t,o)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof f["a"]);if(h&&_&&(Object(u["a"])(u["a"].geometryOutlines),h=!1),this._onTerrain=_,this._outlineEnabled=h,this._isDynamic(t,o))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(t,o),this._isClosed=this._getIsClosed(this._options);const e=o.outlineWidth;this._outlineWidth=Object(r["a"])(e)?e.getValue(d["a"].MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}},x.prototype.createDynamicUpdater=function(t,e){if(n["a"].defined("primitives",t),n["a"].defined("groundPrimitives",e),!this._dynamic)throw new c["a"]("This instance does not represent dynamic geometry.");return new this.constructor.DynamicGeometryUpdater(this,t,e)},e["a"]=x},d760:function(t,e,i){"use strict";var n=i("85b2"),o=i("dde0"),s=i("b975"),r=i("991b"),a=i("4051"),c=i("0b4a"),l=i("1a5d"),h=i("61ad"),d=i("c937"),u=i("e2a6"),p=i("f7b5"),_=i("fff3"),f=i("6247"),b=i("d05a"),y=i("aea3"),g=i("9f38"),m=i("e2aa"),O=i("1b98"),v=i("3368"),w=i("3522"),C=i("2a50"),j=i("be66"),E=i("c9db"),P=i("a34e"),x=i("d911"),I=i("63c1"),S=i("0b0b"),B=i("8a61"),M=i("6318"),L=i("6ec6"),T=i("3a8e5"),D=i("c81d"),A=i("ac78"),N=i("d5d1");let k;"undefined"!==typeof DOMParser&&(k=new DOMParser);const U=new P["a"]({stripPrefix:!1,email:!1,replaceFn:function(t,e){if(!e.protocolUrlMatch)return!1}}),V=32,R=2414016,G=1,H=16093e3,q=.1,F=[null,void 0,"http://www.topografix.com/GPX/1/1"],z={gpx:F};function W(t){const e=Object(h["a"])(),i=new FileReader;return i.addEventListener("load",(function(){e.resolve(i.result)})),i.addEventListener("error",(function(){e.reject(i.error)})),i.readAsText(t),e.promise}function $(t,e){let i=X(t,"id");i=Object(d["a"])(i)?i:Object(c["a"])();const n=e.getOrCreateEntity(i);return n}function Y(t){const e=J(t,"lon"),i=J(t,"lat"),n=Q(t,"ele",z.gpx);return o["a"].fromDegrees(e,i,n)}function J(t,e){if(!Object(d["a"])(t))return;const i=t.getAttribute(e);if(null!==i){const t=parseFloat(i);return isNaN(t)?void 0:t}}function X(t,e){if(!Object(d["a"])(t))return;const i=t.getAttribute(e);return null!==i?i:void 0}function Z(t,e,i){if(!Object(d["a"])(t))return;const n=t.childNodes,o=n.length;for(let s=0;s<o;s++){const t=n[s];if(t.localName===e&&-1!==i.indexOf(t.namespaceURI))return t}}function K(t,e,i){if(!Object(d["a"])(t))return;const n=[],o=t.getElementsByTagName(e),s=o.length;for(let r=0;r<s;r++){const t=o[r];t.localName===e&&-1!==i.indexOf(t.namespaceURI)&&n.push(t)}return n}function Q(t,e,i){const n=Z(t,e,i);if(Object(d["a"])(n)){const t=parseFloat(n.textContent);return isNaN(t)?void 0:t}}function tt(t,e,i){const n=Z(t,e,i);if(Object(d["a"])(n))return n.textContent.trim()}function et(t){const e=new x["a"];return e.width=V,e.height=V,e.scaleByDistance=new b["a"](R,G,H,q),e.pixelOffsetScaleByDistance=new b["a"](R,G,H,q),e.verticalOrigin=new I["a"](E["a"].BOTTOM),e.image=t,e}function it(){const t=new T["a"];return t.translucencyByDistance=new b["a"](3e6,1,5e6,0),t.pixelOffset=new n["a"](17,0),t.horizontalOrigin=C["a"].LEFT,t.font="16px sans-serif",t.style=j["a"].FILL_AND_OUTLINE,t}function nt(t){const e=new D["a"];return e.width=4,e.material=new A["a"],e.material.color=Object(d["a"])(t)?t:a["a"].RED,e.material.outlineWidth=2,e.material.outlineColor=a["a"].BLACK,e}const ot={time:{text:"Time",tag:"time"},comment:{text:"Comment",tag:"cmt"},description:{text:"Description",tag:"desc"},source:{text:"Source",tag:"src"},number:{text:"GPS track/route number",tag:"number"},type:{text:"Type",tag:"type"}};let st;function rt(t,e){let i,n="";const o=Object.keys(ot),s=o.length;for(i=0;i<s;i++){const e=o[i],s=ot[e];s.value=Object(l["a"])(tt(t,s.tag,z.gpx),""),Object(d["a"])(s.value)&&""!==s.value&&(n=`${n}<p>${s.text}: ${s.value}</p>`)}if(!Object(d["a"])(n)||""===n)return;n=U.link(n),st.innerHTML=n;const r=st.querySelectorAll("a");for(i=0;i<r.length;i++)r[i].setAttribute("target","_blank");const c=a["a"].WHITE,h=a["a"].BLACK;let u='<div class="cesium-infoBox-description-lighter" style="';return u+="overflow:auto;",u+="word-wrap:break-word;",u+=`background-color:${c.toCssColorString()};`,u+=`color:${h.toCssColorString()};`,u+='">',u+=st.innerHTML+"</div>",st.innerHTML="",u}function at(t,e,i,n){const o=Y(e),s=$(e,i);s.position=o;const r=Object(d["a"])(n.waypointImage)?n.waypointImage:t._pinBuilder.fromMakiIconId("marker",a["a"].RED,V);s.billboard=et(r);const c=tt(e,"name",z.gpx);s.name=c,s.label=it(),s.label.text=c,s.description=rt(e,s),n.clampToGround&&(s.billboard.heightReference=w["a"].CLAMP_TO_GROUND,s.label.heightReference=w["a"].CLAMP_TO_GROUND)}function ct(t,e,i,n){const o=$(e,i);o.description=rt(e,o);const s=K(e,"rtept",z.gpx),r=new Array(s.length);for(let a=0;a<s.length;a++)at(t,s[a],i,n),r[a]=Y(s[a]);o.polyline=nt(n.routeColor),n.clampToGround&&(o.polyline.clampToGround=!0),o.polyline.positions=r}function lt(t,e,i,n){const o=$(e,i);o.description=rt(e,o);const s=K(e,"trkseg",z.gpx);let r,c=[],l=[],h=!0;const u=new N["a"];for(let a=0;a<s.length;a++)r=ht(s[a]),c=c.concat(r.positions),r.times.length>0?(l=l.concat(r.times),u.addSamples(l,c),h=h&&!0):h=!1;if(h){const e=Object(d["a"])(n.waypointImage)?n.waypointImage:t._pinBuilder.fromMakiIconId("marker",a["a"].RED,V);o.billboard=et(e),o.position=u,n.clampToGround&&(o.billboard.heightReference=w["a"].CLAMP_TO_GROUND),o.availability=new v["a"],o.availability.addInterval(new O["a"]({start:l[0],stop:l[l.length-1]}))}o.polyline=nt(n.trackColor),o.polyline.positions=c,n.clampToGround&&(o.polyline.clampToGround=!0)}function ht(t){const e={positions:[],times:[]},i=K(t,"trkpt",z.gpx);let n;for(let o=0;o<i.length;o++){const t=Y(i[o]);e.positions.push(t),n=tt(i[o],"time",z.gpx),Object(d["a"])(n)&&e.times.push(f["a"].fromIso8601(n))}return e}function dt(t){const e=Z(t,"metadata",z.gpx);if(Object(d["a"])(e)){const t={name:tt(e,"name",z.gpx),desc:tt(e,"desc",z.gpx),author:ut(e),copyright:ft(e),link:_t(e),time:tt(e,"time",z.gpx),keywords:tt(e,"keywords",z.gpx),bounds:bt(e)};if(Object(d["a"])(t.name)||Object(d["a"])(t.desc)||Object(d["a"])(t.author)||Object(d["a"])(t.copyright)||Object(d["a"])(t.link)||Object(d["a"])(t.time)||Object(d["a"])(t.keywords)||Object(d["a"])(t.bounds))return t}}function ut(t){const e=Z(t,"author",z.gpx);if(Object(d["a"])(e)){const t={name:tt(e,"name",z.gpx),email:pt(e),link:_t(e)};if(Object(d["a"])(t.name)||Object(d["a"])(t.email)||Object(d["a"])(t.link))return t}}function pt(t){const e=Z(t,"email",z.gpx);if(Object(d["a"])(e)){const t=tt(e,"id",z.gpx),i=tt(e,"domain",z.gpx);return`${t}@${i}`}}function _t(t){const e=Z(t,"link",z.gpx);if(Object(d["a"])(e)){const t={href:X(e,"href"),text:tt(e,"text",z.gpx),mimeType:tt(e,"type",z.gpx)};if(Object(d["a"])(t.href)||Object(d["a"])(t.text)||Object(d["a"])(t.mimeType))return t}}function ft(t){const e=Z(t,"copyright",z.gpx);if(Object(d["a"])(e)){const t={author:X(e,"author"),year:tt(e,"year",z.gpx),license:tt(e,"license",z.gpx)};if(Object(d["a"])(t.author)||Object(d["a"])(t.year)||Object(d["a"])(t.license))return t}}function bt(t){const e=Z(t,"bounds",z.gpx);if(Object(d["a"])(e)){const t={minLat:Q(e,"minlat",z.gpx),maxLat:Q(e,"maxlat",z.gpx),minLon:Q(e,"minlon",z.gpx),maxLon:Q(e,"maxlon",z.gpx)};if(Object(d["a"])(t.minLat)||Object(d["a"])(t.maxLat)||Object(d["a"])(t.minLon)||Object(d["a"])(t.maxLon))return t}}"undefined"!==typeof document&&(st=document.createElement("div"));const yt={wpt:at,rte:ct,trk:lt};function gt(t,e,i,n){const o=Object.keys(yt),s=o.length;for(let r=0;r<s;r++){const s=o[r],a=yt[s],c=e.childNodes,l=c.length;for(let e=0;e<l;e++){const o=c[e];o.localName===s&&-1!==z.gpx.indexOf(o.namespaceURI)&&a(t,o,i,n)}}}function mt(t,e,i){const n=t._entityCollection;n.removeAll();const o=e.documentElement,a=X(o,"version"),c=X(o,"creator");let l;const h=dt(o);let u;Object(d["a"])(h)&&(l=h.name),"gpx"===o.localName?gt(t,o,n,i):console.log("GPX - Unsupported node: "+o.localName);const p=n.computeAvailability();let b=p.start,y=p.stop;const g=f["a"].equals(b,_["a"].MINIMUM_VALUE),m=f["a"].equals(y,_["a"].MAXIMUM_VALUE);if(!g||!m){let t;g&&(t=new Date,t.setHours(0,0,0,0),b=f["a"].fromDate(t)),m&&(t=new Date,t.setHours(24,0,0,0),y=f["a"].fromDate(t)),u=new B["a"],u.startTime=b,u.stopTime=y,u.currentTime=f["a"].clone(b),u.clockRange=s["a"].LOOP_STOP,u.clockStep=r["a"].SYSTEM_CLOCK_MULTIPLIER,u.multiplier=Math.round(Math.min(Math.max(f["a"].secondsDifference(y,b)/60,1),31556900))}let O=!1;return t._name!==l&&(t._name=l,O=!0),t._creator!==c&&(t._creator=c,O=!0),Ot(t._metadata,h)&&(t._metadata=h,O=!0),t._version!==a&&(t._version=a,O=!0),u!==t._clock&&(O=!0,t._clock=u),O&&t._changed.raiseEvent(t),S["a"].setLoading(t,!1),t}function Ot(t,e){return!(!Object(d["a"])(t)&&!Object(d["a"])(e))&&(!Object(d["a"])(t)||!Object(d["a"])(e)||(t.name!==e.name||t.dec!==e.desc||t.src!==e.src||t.author!==e.author||t.copyright!==e.copyright||t.link!==e.link||t.time!==e.time||t.bounds!==e.bounds))}function vt(t,e,i,n){n=Object(l["a"])(n,l["a"].EMPTY_OBJECT);let o=i;if("string"===typeof i||i instanceof g["a"]){i=g["a"].createIfNeeded(i),o=i.fetchBlob();const e=t._resourceCredits,n=i.credits;if(Object(d["a"])(n)){const t=n.length;for(let i=0;i<t;i++)e.push(n[i])}}return Promise.resolve(o).then((function(e){return e instanceof Blob?W(e).then((function(e){let i,o;try{i=k.parseFromString(e,"application/xml")}catch(s){o=s.toString()}if(Object(d["a"])(o)||i.body||"parsererror"===i.documentElement.tagName){let t=Object(d["a"])(o)?o:i.documentElement.firstChild.nodeValue;throw t||(t=i.body.innerText),new m["a"](t)}return mt(t,i,n)})):mt(t,e,n)})).catch((function(e){return t._error.raiseEvent(t,e),console.log(e),Promise.reject(e)}))}function wt(){this._changed=new p["a"],this._error=new p["a"],this._loading=new p["a"],this._clock=void 0,this._entityCollection=new L["a"],this._entityCluster=new M["a"],this._name=void 0,this._version=void 0,this._creator=void 0,this._metadata=void 0,this._isLoading=!1,this._pinBuilder=new y["a"]}wt.load=function(t,e){return(new wt).load(t,e)},Object.defineProperties(wt.prototype,{name:{get:function(){return this._name}},version:{get:function(){return this._version}},creator:{get:function(){return this._creator}},metadata:{get:function(){return this._metadata}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){if(!Object(d["a"])(t))throw new u["a"]("value must be defined.");this._entityCluster=t}}}),wt.prototype.update=function(t){return!0},wt.prototype.load=function(t,e){if(!Object(d["a"])(t))throw new u["a"]("data is required.");e=Object(l["a"])(e,l["a"].EMPTY_OBJECT),S["a"].setLoading(this,!0);const i=this._name,n=this;return vt(this,this._entityCollection,t,e).then((function(){let t;const e=n._entityCollection.computeAvailability();let o=e.start,a=e.stop;const c=f["a"].equals(o,_["a"].MINIMUM_VALUE),l=f["a"].equals(a,_["a"].MAXIMUM_VALUE);if(!c||!l){let e;c&&(e=new Date,e.setHours(0,0,0,0),o=f["a"].fromDate(e)),l&&(e=new Date,e.setHours(24,0,0,0),a=f["a"].fromDate(e)),t=new B["a"],t.startTime=o,t.stopTime=a,t.currentTime=f["a"].clone(o),t.clockRange=s["a"].LOOP_STOP,t.clockStep=r["a"].SYSTEM_CLOCK_MULTIPLIER,t.multiplier=Math.round(Math.min(Math.max(f["a"].secondsDifference(a,o)/60,1),31556900))}let h=!1;return t!==n._clock&&(n._clock=t,h=!0),i!==n._name&&(h=!0),h&&n._changed.raiseEvent(n),S["a"].setLoading(n,!1),n})).catch((function(t){return S["a"].setLoading(n,!1),n._error.raiseEvent(n,t),console.log(t),Promise.reject(t)}))},e["a"]=wt},e8b8:function(t,e,i){"use strict";var n=i("85b2"),o=i("4051"),s=i("1a5d"),r=i("c937"),a=i("f7b5"),c=i("15ae"),l=i("a724");const h=new n["a"](1,1),d=!1,u=o["a"].WHITE;function p(t){t=Object(s["a"])(t,s["a"].EMPTY_OBJECT),this._definitionChanged=new a["a"],this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=t.image,this.repeat=t.repeat,this.color=t.color,this.transparent=t.transparent}Object.defineProperties(p.prototype,{isConstant:{get:function(){return l["a"].isConstant(this._image)&&l["a"].isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:Object(c["a"])("image"),repeat:Object(c["a"])("repeat"),color:Object(c["a"])("color"),transparent:Object(c["a"])("transparent")}),p.prototype.getType=function(t){return"Image"},p.prototype.getValue=function(t,e){return Object(r["a"])(e)||(e={}),e.image=l["a"].getValueOrUndefined(this._image,t),e.repeat=l["a"].getValueOrClonedDefault(this._repeat,t,h,e.repeat),e.color=l["a"].getValueOrClonedDefault(this._color,t,u,e.color),l["a"].getValueOrDefault(this._transparent,t,d)&&(e.color.alpha=Math.min(.99,e.color.alpha)),e},p.prototype.equals=function(t){return this===t||t instanceof p&&l["a"].equals(this._image,t._image)&&l["a"].equals(this._repeat,t._repeat)&&l["a"].equals(this._color,t._color)&&l["a"].equals(this._transparent,t._transparent)},e["a"]=p}}]);