(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~a15518d2"],{"045b":function(e,t,a){"use strict";var r=a("ae9b"),n=a("c937"),i=a("e2a6"),o=a("d05a"),s=a("4a63");function c(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=s["a"].clone(s["a"].MAX_VALUE)}Object.defineProperties(c.prototype,{enabled:{get:function(){return this._enabled},set:function(e){r["a"].typeOf.bool("enabled",e),this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){r["a"].typeOf.number.greaterThanOrEquals("frontFaceAlpha",e,0),r["a"].typeOf.number.lessThanOrEquals("frontFaceAlpha",e,1),this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){if(Object(n["a"])(e)&&e.far<e.near)throw new i["a"]("far distance must be greater than near distance.");this._frontFaceAlphaByDistance=o["a"].clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){r["a"].typeOf.number.greaterThanOrEquals("backFaceAlpha",e,0),r["a"].typeOf.number.lessThanOrEquals("backFaceAlpha",e,1),this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){if(Object(n["a"])(e)&&e.far<e.near)throw new i["a"]("far distance must be greater than near distance.");this._backFaceAlphaByDistance=o["a"].clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){Object(n["a"])(e)||(e=s["a"].clone(s["a"].MAX_VALUE)),s["a"].clone(e,this._rectangle)}}}),t["a"]=c},"0708":function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var r=a("ae9b"),n=a("1a5d"),i=a("61ad"),o=a("c937"),s=a("7526"),c=a("7525"),u=a("5f64"),d=a("9f38"),l=a("235f"),h=a("5ecd"),f=a("a47e"),p=a("3e8a"),m=a("59ae"),g=a("4a2d"),_=a("dc50"),y=a("816c");function b(e){e=Object(n["a"])(e,n["a"].EMPTY_OBJECT);const t=e.resourceCache,a=e.gltfResource,o=e.baseResource,s=e.typedArray,c=e.gltfJson,u=e.cacheKey;r["a"].typeOf.func("options.resourceCache",t),r["a"].typeOf.object("options.gltfResource",a),r["a"].typeOf.object("options.baseResource",o),this._resourceCache=t,this._gltfResource=a,this._baseResource=o,this._typedArray=s,this._gltfJson=c,this._cacheKey=u,this._gltf=void 0,this._bufferLoaders=[],this._state=y["a"].UNLOADED,this._promise=Object(i["a"])()}function T(e){return e._fetchGltf().then((function(t){if(e.isDestroyed())return;const a=new Uint8Array(t);return S(e,a)}))}function A(e,t){e.unload(),e._state=y["a"].FAILED;const a="Failed to load glTF: "+e._gltfResource.url;e._promise.reject(e.getError(a,t))}function O(e,t){if("2.0"===t.asset.version)return Promise.resolve();const a=[];return f["a"].buffer(t,(function(t){if(!Object(o["a"])(t.extras._pipeline.source)&&Object(o["a"])(t.uri)){const r=e._baseResource.getDerivedResource({url:t.uri}),n=e._resourceCache,i=n.loadExternalBuffer({resource:r});e._bufferLoaders.push(i),a.push(i.promise.then((function(e){t.extras._pipeline.source=e.typedArray})))}})),Promise.all(a).then((function(){Object(g["a"])(t)}))}function C(e){const t=[];return f["a"].buffer(e,(function(e){const a=e.uri;!Object(o["a"])(e.extras._pipeline.source)&&Object(o["a"])(a)&&Object(u["a"])(a)&&(delete e.uri,t.push(d["a"].fetchArrayBuffer(a).then((function(t){e.extras._pipeline.source=new Uint8Array(t)}))))})),Promise.all(t)}function v(e,t){const a=[];return f["a"].buffer(t,(function(t,r){const n=t.extras._pipeline.source;if(Object(o["a"])(n)&&!Object(o["a"])(t.uri)){const t=e._resourceCache,i=t.loadEmbeddedBuffer({parentResource:e._gltfResource,bufferId:r,typedArray:n});e._bufferLoaders.push(i),a.push(i.promise)}})),Promise.all(a)}function E(e,t){return Object(h["a"])(t),C(t).then((function(){return O(e,t).then((function(){return Object(l["a"])(t),v(e,t).then((function(){return Object(m["a"])(t),t}))}))}))}function S(e,t){let a;return a="glTF"===Object(c["a"])(t)?Object(p["a"])(t):Object(s["a"])(t),E(e,a)}Object(o["a"])(Object.create)&&(b.prototype=Object.create(_["a"].prototype),b.prototype.constructor=b),Object.defineProperties(b.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},gltf:{get:function(){return this._gltf}}}),b.prototype.load=function(){let e;this._state=y["a"].LOADING,e=Object(o["a"])(this._gltfJson)?E(this,this._gltfJson):Object(o["a"])(this._typedArray)?S(this,this._typedArray):T(this);const t=this;return e.then((function(e){t.isDestroyed()||(t._gltf=e,t._state=y["a"].READY,t._promise.resolve(t))})).catch((function(e){t.isDestroyed()||A(t,e)}))},b.prototype.unload=function(){const e=this._bufferLoaders,t=e.length;for(let a=0;a<t;++a)this._resourceCache.unload(e[a]);this._bufferLoaders.length=0,this._gltf=void 0},b.prototype._fetchGltf=function(){return this._gltfResource.fetchArrayBuffer()}},"25c0":function(e,t,a){"use strict";var r=a("c937"),n=a("21b7"),i=a("4f90"),o=a("8f7d"),s=a("1aeb"),c=a("dc6c");function u(e,t,a,r,n){this.numberOfDayTextures=e,this.flags=t,this.material=a,this.shaderProgram=r,this.clippingShaderState=n}function d(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function l(e){const t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }",a="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }",r="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }";let n;switch(e){case c["a"].SCENE3D:n=t;break;case c["a"].SCENE2D:case c["a"].COLUMBUS_VIEW:n=a;break;case c["a"].MORPHING:n=r;break}return n}function h(e){const t="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }",a="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }";return e?a:t}d.prototype.getShaderProgram=function(e){const t=e.frameState,a=e.surfaceTile,n=e.numberOfDayTextures,c=e.applyBrightness,d=e.applyContrast,f=e.applyHue,p=e.applySaturation,m=e.applyGamma,g=e.applyAlpha,_=e.applyDayNightAlpha,y=e.applySplit,b=e.showReflectiveOcean,T=e.showOceanWaves,A=e.enableLighting,O=e.dynamicAtmosphereLighting,C=e.dynamicAtmosphereLightingFromSun,v=e.showGroundAtmosphere,E=e.perFragmentGroundAtmosphere,S=e.hasVertexNormals,x=e.useWebMercatorProjection,D=e.enableFog,R=e.enableClippingPlanes,w=e.clippingPlanes,L=e.clippedByBoundaries,F=e.hasImageryLayerCutout,N=e.colorCorrect,P=e.highlightFillTile,I=e.colorToAlpha,j=e.hasGeodeticSurfaceNormals,M=e.hasExaggeration,B=e.showUndergroundColor,H=e.translucent;let U=0,k="";const V=a.renderedMesh,G=V.encoding,Y=G.quantization;Y===i["a"].BITS12&&(U=1,k="QUANTIZATION_BITS12");let q=0,z="";L&&(q=1,z="TILE_LIMIT_RECTANGLE");let W=0,K="";F&&(W=1,K="APPLY_IMAGERY_CUTOUT");const $=t.mode,X=$|c<<2|d<<3|f<<4|p<<5|m<<6|g<<7|b<<8|T<<9|A<<10|O<<11|C<<12|v<<13|E<<14|S<<15|x<<16|D<<17|U<<18|y<<19|R<<20|q<<21|W<<22|N<<23|P<<24|I<<25|j<<26|M<<27|B<<28|H<<29|_<<30;let J=0;Object(r["a"])(w)&&w.length>0&&(J=R?w.clippingPlanesState:0);let Q=a.surfaceShader;if(Object(r["a"])(Q)&&Q.numberOfDayTextures===n&&Q.flags===X&&Q.material===this.material&&Q.clippingShaderState===J)return Q.shaderProgram;let Z=this._shadersByTexturesFlags[n];if(Object(r["a"])(Z)||(Z=this._shadersByTexturesFlags[n]=[]),Q=Z[X],!Object(r["a"])(Q)||Q.material!==this.material||Q.clippingShaderState!==J){const e=this.baseVertexShaderSource.clone(),a=this.baseFragmentShaderSource.clone();0!==J&&a.sources.unshift(Object(s["a"])(w,t.context)),e.defines.push(k),a.defines.push("TEXTURE_UNITS "+n,z,K),c&&a.defines.push("APPLY_BRIGHTNESS"),d&&a.defines.push("APPLY_CONTRAST"),f&&a.defines.push("APPLY_HUE"),p&&a.defines.push("APPLY_SATURATION"),m&&a.defines.push("APPLY_GAMMA"),g&&a.defines.push("APPLY_ALPHA"),_&&a.defines.push("APPLY_DAY_NIGHT_ALPHA"),b&&(a.defines.push("SHOW_REFLECTIVE_OCEAN"),e.defines.push("SHOW_REFLECTIVE_OCEAN")),T&&a.defines.push("SHOW_OCEAN_WAVES"),I&&a.defines.push("APPLY_COLOR_TO_ALPHA"),B&&(e.defines.push("UNDERGROUND_COLOR"),a.defines.push("UNDERGROUND_COLOR")),H&&(e.defines.push("TRANSLUCENT"),a.defines.push("TRANSLUCENT")),A&&(S?(e.defines.push("ENABLE_VERTEX_LIGHTING"),a.defines.push("ENABLE_VERTEX_LIGHTING")):(e.defines.push("ENABLE_DAYNIGHT_SHADING"),a.defines.push("ENABLE_DAYNIGHT_SHADING"))),O&&(a.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),C&&a.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN")),v&&(e.defines.push("GROUND_ATMOSPHERE"),a.defines.push("GROUND_ATMOSPHERE"),E&&a.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE")),e.defines.push("INCLUDE_WEB_MERCATOR_Y"),a.defines.push("INCLUDE_WEB_MERCATOR_Y"),D&&(e.defines.push("FOG"),a.defines.push("FOG")),y&&a.defines.push("APPLY_SPLIT"),R&&a.defines.push("ENABLE_CLIPPING_PLANES"),N&&a.defines.push("COLOR_CORRECT"),P&&a.defines.push("HIGHLIGHT_FILL_TILE"),j&&e.defines.push("GEODETIC_SURFACE_NORMALS"),M&&e.defines.push("EXAGGERATION");let r="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";F&&(r+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(let t=0;t<n;++t)r+=F?`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${t}];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n`:"        color = sampleAndBlend(\n",r+=`            color,\n            u_dayTextures[${t}],\n            u_dayTextureUseWebMercatorT[${t}] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle[${t}],\n            u_dayTextureTranslationAndScale[${t}],\n            ${g?`u_dayTextureAlpha[${t}]`:"1.0"},\n            ${_?`u_dayTextureNightAlpha[${t}]`:"1.0"},\n${_?`u_dayTextureDayAlpha[${t}]`:"1.0"},\n${c?`u_dayTextureBrightness[${t}]`:"0.0"},\n            ${d?`u_dayTextureContrast[${t}]`:"0.0"},\n            ${f?`u_dayTextureHue[${t}]`:"0.0"},\n            ${p?`u_dayTextureSaturation[${t}]`:"0.0"},\n            ${m?`u_dayTextureOneOverGamma[${t}]`:"0.0"},\n            ${y?`u_dayTextureSplit[${t}]`:"0.0"},\n            ${I?`u_colorsToAlpha[${t}]`:"vec4(0.0)"},\n        nightBlend        );\n`,F&&(r+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");r+="        return color;\n    }",a.sources.push(r),e.sources.push(l($)),e.sources.push(h(x));const i=o["a"].fromCache({context:t.context,vertexShaderSource:e,fragmentShaderSource:a,attributeLocations:G.getAttributeLocations()});Q=Z[X]=new u(n,X,this.material,i,J)}return a.surfaceShader=Q,Q.shaderProgram},d.prototype.destroy=function(){let e,t;const a=this._shadersByTexturesFlags;for(const n in a)if(a.hasOwnProperty(n)){const i=a[n];if(!Object(r["a"])(i))continue;for(e in i)i.hasOwnProperty(e)&&(t=i[e],Object(r["a"])(t)&&t.shaderProgram.destroy())}return Object(n["a"])(this)},t["a"]=d},"5aea":function(e,t,a){"use strict";var r=a("6af0"),n=a("4051"),i=a("c937"),o=a("21b7"),s=a("a3c8"),c=a("66fd"),u=a("1494"),d=a("5027"),l=a("291c");function h(){this._framebuffer=new c["a"]({depthStencil:!0,supportsDepthTexture:!0}),this._packedDepthFramebuffer=new c["a"],this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new r["a"],this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}function f(e){e._framebuffer.destroy(),e._packedDepthFramebuffer.destroy()}function p(e,t,a,r,n){const i=n?t.halfFloatingPointTexture?u["a"].HALF_FLOAT:u["a"].FLOAT:u["a"].UNSIGNED_BYTE;e._framebuffer.update(t,a,r,1,i),e._packedDepthFramebuffer.update(t,a,r)}function m(e,t,a,o,c){e._viewport.width=a,e._viewport.height=o;const u=!r["a"].equals(e._viewport,c.viewport);let h=u!==e._useScissorTest;e._useScissorTest=u,r["a"].equals(e._scissorRectangle,c.viewport)||(e._scissorRectangle=r["a"].clone(c.viewport,e._scissorRectangle),h=!0),Object(i["a"])(e._renderState)&&r["a"].equals(e._viewport,e._renderState.viewport)&&!h||(e._renderState=d["a"].fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),Object(i["a"])(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(l["a"],{uniformMap:{u_depthTexture:function(){return e.depthStencilTexture}},owner:e})),Object(i["a"])(e._clearCommand)||(e._clearCommand=new s["a"]({color:new n["a"](0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer.framebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e.classificationFramebuffer,e._clearCommand.renderState=e._renderState}Object.defineProperties(h.prototype,{classificationTexture:{get:function(){return this._framebuffer.getColorTexture()}},classificationFramebuffer:{get:function(){return this._framebuffer.framebuffer}},packedDepthFramebuffer:{get:function(){return this._packedDepthFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._framebuffer.getDepthStencilTexture()}},depthStencilRenderbuffer:{get:function(){return this._framebuffer.getDepthStencilRenderbuffer()}},packedDepthTexture:{get:function(){return this._packedDepthFramebuffer.getColorTexture()}}}),h.prototype.updateAndClear=function(e,t,a,r){const n=t.width,i=t.height;p(this,a,n,i,e),m(this,a,n,i,r),this._useHdr=e},h.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)},h.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this.packedDepthTexture},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return f(this),Object(o["a"])(this)},t["a"]=h},"761d":function(e,t,a){"use strict";var r=a("8656"),n=a("dde0"),i=a("6b82"),o=a("8d54"),s=a("c937"),c=a("2642"),u=a("7f05"),d=a("0238"),l=a("430c"),h=a("035e"),f=a("06d8"),p=a("bb9e"),m=a("30e6"),g=a("3242"),_=a("6f54"),y=a("6ba7"),b=a("1494"),T=a("4d68"),A=a("1a75"),O=a("50de"),C=a("518b"),v=a("2189"),E=a("dc15"),S=a("e607"),x=a("65d7"),D=a("dc6c"),R=a("e9e8");function w(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new i["a"](0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new n["a"],this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=R["a"].UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new r["a"],this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(w.prototype,{eligibleForUnloading:{get:function(){const e=this.terrainState,t=e===R["a"].RECEIVING||e===R["a"].TRANSFORMING;let a=!t;const r=this.imagery;for(let n=0,i=r.length;a&&n<i;++n){const e=r[n];a=!Object(s["a"])(e.loadingImagery)||e.loadingImagery.state!==S["a"].TRANSITIONING}return a}},renderedMesh:{get:function(){return Object(s["a"])(this.vertexArray)?this.mesh:Object(s["a"])(this.fill)?this.fill.mesh:void 0}}});const L=new o["a"];function F(e,t,a,r,i,o){let c=e.getExaggeratedPosition(r,i,o);if(Object(s["a"])(t)&&t!==D["a"].SCENE3D){const e=a.ellipsoid,t=e.cartesianToCartographic(c,L);c=a.project(t,o),c=n["a"].fromElements(c.z,c.x,c.y,o)}return c}const N=new n["a"],P=new n["a"],I=new n["a"];function j(e,t,a,r){const n=e.renderedMesh,i=n.vertices,o=n.encoding,s=i.length/o.stride;let c=m["a"].clone(o);c.hasGeodeticSurfaceNormals=t,c=m["a"].clone(c);const u=c.stride,d=new Float32Array(s*u);t?o.addGeodeticSurfaceNormals(i,d,a):o.removeGeodeticSurfaceNormals(i,d),n.vertices=d,n.stride=u;const l=n!==e.mesh;l?(w._freeVertexArray(e.fill.vertexArray),e.fill.vertexArray=w._createVertexArrayForMesh(r.context,n)):(w._freeVertexArray(e.vertexArray),e.vertexArray=w._createVertexArrayForMesh(r.context,n)),w._freeVertexArray(e.wireframeVertexArray),e.wireframeVertexArray=void 0}function M(e,t,a){let r=t.getTileDataAvailable(e.x,e.y,e.level);if(!Object(s["a"])(r)&&Object(s["a"])(e.parent)){const t=e.parent,a=t.data;Object(s["a"])(a)&&Object(s["a"])(a.terrainData)&&(r=a.terrainData.isChildAvailable(t.x,t.y,e.x,e.y))}!1===r&&(e.data.terrainState=R["a"].FAILED);for(let n=0,i=a.length;n<i;++n){const r=a.get(n);r.show&&r._createTileImagerySkeletons(e,t)}}function B(e,t,a,r,n,i){const o=e.data,c=e.parent;if(o.terrainState===R["a"].FAILED&&void 0!==c){const e=void 0!==c.data&&void 0!==c.data.terrainData&&!1!==c.data.terrainData.canUpsample;e||w.processStateMachine(c,t,a,r,n,i,!0)}if(o.terrainState===R["a"].FAILED&&H(o,e,t,a,e.x,e.y,e.level),o.terrainState===R["a"].UNLOADED&&U(o,a,e.x,e.y,e.level),o.terrainState===R["a"].RECEIVED&&V(o,t,a,e.x,e.y,e.level),o.terrainState===R["a"].TRANSFORMED&&(G(o,t.context,a,e.x,e.y,e.level,i),o.updateExaggeration(e,t,n)),o.terrainState>=R["a"].RECEIVED&&void 0===o.waterMaskTexture&&a.hasWaterMask){const a=o.terrainData;if(void 0!==a.waterMask)q(t.context,o);else{const t=o._findAncestorTileWithTerrainData(e);Object(s["a"])(t)&&Object(s["a"])(t.data.waterMaskTexture)&&(o.waterMaskTexture=t.data.waterMaskTexture,++o.waterMaskTexture.referenceCount,o._computeWaterMaskTranslationAndScale(e,t,o.waterMaskTranslationAndScale))}}}function H(e,t,a,r,n,i,o){const c=t.parent;if(!c)return void(t.state=x["a"].FAILED);const u=c.data.terrainData,d=c.x,l=c.y,h=c.level;if(!Object(s["a"])(u))return;const f=u.upsample(r.tilingScheme,d,l,h,n,i,o);Object(s["a"])(f)&&(e.terrainState=R["a"].RECEIVING,Promise.resolve(f).then((function(t){e.terrainData=t,e.terrainState=R["a"].RECEIVED})).catch((function(){e.terrainState=R["a"].FAILED})))}function U(e,t,a,r,n){function i(t){e.terrainData=t,e.terrainState=R["a"].RECEIVED,e.request=void 0}function o(i){if(e.request.state===f["a"].CANCELLED)return e.terrainData=void 0,e.terrainState=R["a"].UNLOADED,void(e.request=void 0);e.terrainState=R["a"].FAILED,e.request=void 0;const o=`Failed to obtain terrain tile X: ${a} Y: ${r} Level: ${n}. Error message: "${i}"`;t._requestError=g["a"].handleError(t._requestError,t,t.errorEvent,o,a,r,n,c)}function c(){const c=new h["a"]({throttle:!1,throttleByServer:!0,type:p["a"].TERRAIN});e.request=c;const u=t.requestTileGeometry(a,r,n,c);Object(s["a"])(u)?(e.terrainState=R["a"].RECEIVING,Promise.resolve(u).then((function(e){i(e)})).catch((function(e){o(e)}))):(e.terrainState=R["a"].UNLOADED,e.request=void 0)}c()}w.prototype.pick=function(e,t,a,r,n){const i=this.renderedMesh;if(!Object(s["a"])(i))return;const o=i.vertices,c=i.indices,d=i.encoding,h=c.length;let f=Number.MAX_VALUE;for(let l=0;l<h;l+=3){const n=c[l],i=c[l+1],h=c[l+2],p=F(d,t,a,o,n,N),m=F(d,t,a,o,i,P),g=F(d,t,a,o,h,I),_=u["a"].rayTriangleParametric(e,p,m,g,r);Object(s["a"])(_)&&_<f&&_>=0&&(f=_)}return f!==Number.MAX_VALUE?l["a"].getPoint(e,f,n):void 0},w.prototype.freeResources=function(){Object(s["a"])(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=R["a"].UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();const e=this.imagery;for(let t=0,a=e.length;t<a;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},w.prototype.freeVertexArray=function(){w._freeVertexArray(this.vertexArray),this.vertexArray=void 0,w._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},w.initialize=function(e,t,a){let r=e.data;Object(s["a"])(r)||(r=e.data=new w),e.state===x["a"].START&&(M(e,t,a),e.state=x["a"].LOADING)},w.processStateMachine=function(e,t,a,r,n,i,o){w.initialize(e,a,r);const c=e.data;if(e.state===x["a"].LOADING&&B(e,t,a,r,n,i),o)return;const u=e.renderable;e.renderable=Object(s["a"])(c.vertexArray);const d=c.terrainState===R["a"].READY;e.upsampledFromParent=Object(s["a"])(c.terrainData)&&c.terrainData.wasCreatedByUpsampling();const l=c.processImagery(e,a,t);if(d&&l){const t=e._loadedCallbacks,a={};for(const r in t)t.hasOwnProperty(r)&&(t[r](e)||(a[r]=t[r]));e._loadedCallbacks=a,e.state=x["a"].DONE}u&&(e.renderable=!0)},w.prototype.processImagery=function(e,t,a,r){const n=e.data;let i=e.upsampledFromParent,o=!1,c=!0;const u=n.imagery;let d,l;for(d=0,l=u.length;d<l;++d){const n=u[d];if(!Object(s["a"])(n.loadingImagery)){i=!1;continue}if(n.loadingImagery.state===S["a"].PLACEHOLDER){const a=n.loadingImagery.imageryLayer;if(a.imageryProvider.ready){n.freeResources(),u.splice(d,1),a._createTileImagerySkeletons(e,t,d),--d,l=u.length;continue}i=!1}const h=n.processStateMachine(e,a,r);c=c&&h,o=o||h||Object(s["a"])(n.readyImagery),i=i&&Object(s["a"])(n.loadingImagery)&&(n.loadingImagery.state===S["a"].FAILED||n.loadingImagery.state===S["a"].INVALID)}return e.upsampledFromParent=i,e.renderable=e.renderable&&(o||c),c},w.prototype.addGeodeticSurfaceNormals=function(e,t){j(this,!0,e,t)},w.prototype.removeGeodeticSurfaceNormals=function(e){j(this,!1,void 0,e)},w.prototype.updateExaggeration=function(e,t,a){const r=this,n=r.renderedMesh;if(void 0===n)return;const i=t.terrainExaggeration,o=t.terrainExaggerationRelativeHeight,s=1!==i,c=n.encoding,u=c.exaggeration!==i,d=c.exaggerationRelativeHeight!==o;if(u||d){if(u)if(s&&!c.hasGeodeticSurfaceNormals){const a=e.tilingScheme.ellipsoid;r.addGeodeticSurfaceNormals(a,t)}else!s&&c.hasGeodeticSurfaceNormals&&r.removeGeodeticSurfaceNormals(t);if(c.exaggeration=i,c.exaggerationRelativeHeight=o,void 0!==a){a._tileToUpdateHeights.push(e);const t=e.customData,r=t.length;for(let e=0;e<r;e++){const a=t[e];a.level=-1}}}};const k={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function V(e,t,a,r,n,i){const o=a.tilingScheme,c=k;c.tilingScheme=o,c.x=r,c.y=n,c.level=i,c.exaggeration=t.terrainExaggeration,c.exaggerationRelativeHeight=t.terrainExaggerationRelativeHeight,c.throttle=!0;const u=e.terrainData,d=u.createMesh(c);Object(s["a"])(d)&&(e.terrainState=R["a"].TRANSFORMING,Promise.resolve(d).then((function(t){e.mesh=t,e.terrainState=R["a"].TRANSFORMED})).catch((function(){e.terrainState=R["a"].FAILED})))}function G(e,t,a,r,n,i,o){e.vertexArray=w._createVertexArrayForMesh(t,e.mesh),e.terrainState=R["a"].READY,e.fill=e.fill&&e.fill.destroy(o)}function Y(e){let t=e.cache.tile_waterMaskData;if(!Object(s["a"])(t)){const a=A["a"].create({context:e,pixelFormat:d["a"].LUMINANCE,pixelDatatype:b["a"].UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});a.referenceCount=1;const r=new T["a"]({wrapS:v["a"].CLAMP_TO_EDGE,wrapT:v["a"].CLAMP_TO_EDGE,minificationFilter:C["a"].LINEAR,magnificationFilter:O["a"].LINEAR});t={allWaterTexture:a,sampler:r,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function q(e,t){const a=t.terrainData.waterMask,r=Y(e);let n;const o=a.length;if(1===o){if(0===a[0])return;n=r.allWaterTexture}else{const t=Math.sqrt(o);n=A["a"].create({context:e,pixelFormat:d["a"].LUMINANCE,pixelDatatype:b["a"].UNSIGNED_BYTE,source:{width:t,height:t,arrayBufferView:a},sampler:r.sampler,flipY:!1}),n.referenceCount=0}++n.referenceCount,t.waterMaskTexture=n,i["a"].fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}w._createVertexArrayForMesh=function(e,t){const a=t.vertices,r=_["a"].createVertexBuffer({context:e,typedArray:a,usage:y["a"].STATIC_DRAW}),n=t.encoding.getAttributes(r),i=t.indices.indexBuffers||{};let o=i[e.id];if(!Object(s["a"])(o)||o.isDestroyed()){const a=t.indices;o=_["a"].createIndexBuffer({context:e,typedArray:a,usage:y["a"].STATIC_DRAW,indexDatatype:c["a"].fromSizeInBytes(a.BYTES_PER_ELEMENT)}),o.vertexArrayDestroyable=!1,o.referenceCount=1,i[e.id]=o,t.indices.indexBuffers=i}else++o.referenceCount;return new E["a"]({context:e,attributes:n,indexBuffer:o})},w._freeVertexArray=function(e){if(Object(s["a"])(e)){const t=e.indexBuffer;e.isDestroyed()||e.destroy(),Object(s["a"])(t)&&!t.isDestroyed()&&Object(s["a"])(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},w.prototype._findAncestorTileWithTerrainData=function(e){let t=e.parent;while(Object(s["a"])(t)&&(!Object(s["a"])(t.data)||!Object(s["a"])(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling()))t=t.parent;return t},w.prototype._computeWaterMaskTranslationAndScale=function(e,t,a){const r=t.rectangle,n=e.rectangle,i=n.width,o=n.height,s=i/r.width,c=o/r.height;return a.x=s*(n.west-r.west)/i,a.y=c*(n.south-r.south)/o,a.z=s,a.w=c,a},t["a"]=w},"8bd2":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var r=a("ae9b"),n=a("1a5d"),i=a("61ad"),o=a("c937"),s=a("5618"),c=a("dc50"),u=a("816c");function d(e){e=Object(n["a"])(e,n["a"].EMPTY_OBJECT);const t=e.resourceCache,a=e.gltf,o=e.draco,s=e.gltfResource,c=e.baseResource,d=e.cacheKey;r["a"].typeOf.func("options.resourceCache",t),r["a"].typeOf.object("options.gltf",a),r["a"].typeOf.object("options.draco",o),r["a"].typeOf.object("options.gltfResource",s),r["a"].typeOf.object("options.baseResource",c),this._resourceCache=t,this._gltfResource=s,this._baseResource=c,this._gltf=a,this._draco=o,this._cacheKey=d,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=u["a"].UNLOADED,this._promise=Object(i["a"])()}function l(e,t){e.unload(),e._state=u["a"].FAILED;const a="Failed to load Draco";e._promise.reject(e.getError(a,t))}Object(o["a"])(Object.create)&&(d.prototype=Object.create(c["a"].prototype),d.prototype.constructor=d),Object.defineProperties(d.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}}),d.prototype.load=function(){const e=this._resourceCache,t=e.loadBufferView({gltf:this._gltf,bufferViewId:this._draco.bufferView,gltfResource:this._gltfResource,baseResource:this._baseResource});this._bufferViewLoader=t,this._state=u["a"].LOADING;const a=this;t.promise.then((function(){a.isDestroyed()||(a._bufferViewTypedArray=t.typedArray,a._state=u["a"].PROCESSING)})).catch((function(e){a.isDestroyed()||l(a,e)}))},d.prototype.process=function(e){if(r["a"].typeOf.object("frameState",e),!Object(o["a"])(this._bufferViewTypedArray))return;if(Object(o["a"])(this._decodePromise))return;const t=this._draco,a=this._gltf,n=a.bufferViews,i=t.bufferView,c=n[i],d=t.attributes,h={array:new Uint8Array(this._bufferViewTypedArray),bufferView:c,compressedAttributes:d,dequantizeInShader:!0},f=s["a"].decodeBufferView(h);if(!Object(o["a"])(f))return;const p=this;this._decodePromise=f.then((function(e){p.isDestroyed()||(p.unload(),p._decodedData={indices:e.indexArray,vertexAttributes:e.attributeData},p._state=u["a"].READY,p._promise.resolve(p))})).catch((function(e){p.isDestroyed()||l(p,e)}))},d.prototype.unload=function(){Object(o["a"])(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0}},"8f79":function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("ae9b"),n=a("cbf0"),i=a("1a5d"),o=a("61ad"),s=a("c937"),c=a("2642"),u=a("6f54"),d=a("6ba7"),l=a("0c68"),h=a("dc50"),f=a("816c");function p(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT);const t=e.resourceCache,a=e.gltf,n=e.accessorId,s=e.gltfResource,c=e.baseResource,u=e.draco,d=e.cacheKey,l=Object(i["a"])(e.asynchronous,!0),h=Object(i["a"])(e.loadAsTypedArray,!1);r["a"].typeOf.func("options.resourceCache",t),r["a"].typeOf.object("options.gltf",a),r["a"].typeOf.number("options.accessorId",n),r["a"].typeOf.object("options.gltfResource",s),r["a"].typeOf.object("options.baseResource",c);const p=a.accessors[n].componentType;this._resourceCache=t,this._gltfResource=s,this._baseResource=c,this._gltf=a,this._accessorId=n,this._indexDatatype=p,this._draco=u,this._cacheKey=d,this._asynchronous=l,this._loadAsTypedArray=h,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=f["a"].UNLOADED,this._promise=Object(o["a"])()}function m(e){const t=e._resourceCache,a=t.loadDraco({gltf:e._gltf,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});e._dracoLoader=a,e._state=f["a"].LOADING,a.promise.then((function(){if(e.isDestroyed())return;const t=a.decodedData.indices.typedArray;e._typedArray=t,e._indexDatatype=n["a"].fromTypedArray(t),e._state=f["a"].PROCESSING})).catch((function(t){e.isDestroyed()||y(e,t)}))}function g(e){const t=e._gltf,a=e._accessorId,r=t.accessors[a],n=r.bufferView,i=e._resourceCache,o=i.loadBufferView({gltf:t,bufferViewId:n,gltfResource:e._gltfResource,baseResource:e._baseResource});e._state=f["a"].LOADING,e._bufferViewLoader=o,o.promise.then((function(){if(e.isDestroyed())return;const t=o.typedArray;e._typedArray=_(e,t),e._state=f["a"].PROCESSING})).catch((function(t){e.isDestroyed()||y(e,t)}))}function _(e,t){const a=e._gltf,r=e._accessorId,n=a.accessors[r],i=n.count,o=n.componentType,s=t.buffer,u=t.byteOffset+n.byteOffset;let d;return o===c["a"].UNSIGNED_BYTE?d=new Uint8Array(s,u,i):o===c["a"].UNSIGNED_SHORT?d=new Uint16Array(s,u,i):o===c["a"].UNSIGNED_INT&&(d=new Uint32Array(s,u,i)),d}function y(e,t){e.unload(),e._state=f["a"].FAILED;const a="Failed to load index buffer";t=e.getError(a,t),e._promise.reject(t)}function b(){this.typedArray=void 0,this.indexDatatype=void 0,this.context=void 0,this.buffer=void 0}function T(e,t,a){const r=u["a"].createIndexBuffer({typedArray:e,context:a,usage:d["a"].STATIC_DRAW,indexDatatype:t});return r.vertexArrayDestroyable=!1,r}Object(s["a"])(Object.create)&&(p.prototype=Object.create(h["a"].prototype),p.prototype.constructor=p),Object.defineProperties(p.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},indexDatatype:{get:function(){return this._indexDatatype}}}),p.prototype.load=function(){Object(s["a"])(this._draco)?m(this):g(this)},b.prototype.set=function(e,t,a){this.typedArray=e,this.indexDatatype=t,this.context=a},b.prototype.execute=function(){this.buffer=T(this.typedArray,this.indexDatatype,this.context)};const A=new b;p.prototype.process=function(e){if(r["a"].typeOf.object("frameState",e),this._state===f["a"].READY)return;const t=this._typedArray,a=this._indexDatatype;if(Object(s["a"])(this._dracoLoader)&&this._dracoLoader.process(e),Object(s["a"])(this._bufferViewLoader)&&this._bufferViewLoader.process(e),!Object(s["a"])(t))return;if(this._loadAsTypedArray)return this.unload(),this._typedArray=t,this._state=f["a"].READY,void this._promise.resolve(this);let n;if(this._asynchronous){const r=A;r.set(t,a,e.context);const i=e.jobScheduler;if(!i.execute(r,l["a"].BUFFER))return;n=r.buffer}else n=T(t,a,e.context);this.unload(),this._buffer=n,this._state=f["a"].READY,this._promise.resolve(this)},p.prototype.unload=function(){Object(s["a"])(this._buffer)&&this._buffer.destroy();const e=this._resourceCache;Object(s["a"])(this._bufferViewLoader)&&e.unload(this._bufferViewLoader),Object(s["a"])(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0}},9767:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r=a("ae9b"),n=a("1a5d"),i=a("61ad"),o=a("c937"),s=a("21b0"),c=a("0dea"),u=a("e2aa"),d=a("dc50"),l=a("816c");function h(e){e=Object(n["a"])(e,n["a"].EMPTY_OBJECT);const t=e.resourceCache,a=e.gltf,o=e.imageId,s=e.gltfResource,c=e.baseResource,u=e.cacheKey;r["a"].typeOf.func("options.resourceCache",t),r["a"].typeOf.object("options.gltf",a),r["a"].typeOf.number("options.imageId",o),r["a"].typeOf.object("options.gltfResource",s),r["a"].typeOf.object("options.baseResource",c);const d=a.images[o],h=d.bufferView,f=d.uri;this._resourceCache=t,this._gltfResource=s,this._baseResource=c,this._gltf=a,this._bufferViewId=h,this._uri=f,this._cacheKey=u,this._bufferViewLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._state=l["a"].UNLOADED,this._promise=Object(i["a"])()}function f(e){let t;return Array.isArray(e)&&(t=e.slice(1,e.length).map((function(e){return e.bufferView})),e=e[0]),{image:e,mipLevels:t}}function p(e){const t=e._resourceCache,a=t.loadBufferView({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});e._bufferViewLoader=a,e._state=l["a"].LOADING,a.promise.then((function(){if(e.isDestroyed())return;const t=a.typedArray;return y(t).then((function(t){if(e.isDestroyed())return;const a=f(t);e.unload(),e._image=a.image,e._mipLevels=a.mipLevels,e._state=l["a"].READY,e._promise.resolve(e)}))})).catch((function(t){e.isDestroyed()||g(e,t,"Failed to load embedded image")}))}function m(e){const t=e._baseResource,a=e._uri,r=t.getDerivedResource({url:a});e._state=l["a"].LOADING,T(r).then((function(t){if(e.isDestroyed())return;const a=f(t);e.unload(),e._image=a.image,e._mipLevels=a.mipLevels,e._state=l["a"].READY,e._promise.resolve(e)})).catch((function(t){e.isDestroyed()||g(e,t,"Failed to load image: "+a)}))}function g(e,t,a){e.unload(),e._state=l["a"].FAILED,e._promise.reject(e.getError(a,t))}function _(e){const t=e.subarray(0,2),a=e.subarray(0,4),r=e.subarray(8,12);if(255===t[0]&&216===t[1])return"image/jpeg";if(137===t[0]&&80===t[1])return"image/png";if(171===t[0]&&75===t[1])return"image/ktx2";if(82===a[0]&&73===a[1]&&70===a[2]&&70===a[3]&&87===r[0]&&69===r[1]&&66===r[2]&&80===r[3])return"image/webp";throw new u["a"]("Image format is not recognized")}function y(e){const t=_(e);if("image/ktx2"===t){const t=new Uint8Array(e);return Object(c["a"])(t)}return h._loadImageFromTypedArray({uint8Array:e,format:t,flipY:!1,skipColorSpaceConversion:!0})}Object(o["a"])(Object.create)&&(h.prototype=Object.create(d["a"].prototype),h.prototype.constructor=h),Object.defineProperties(h.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},image:{get:function(){return this._image}},mipLevels:{get:function(){return this._mipLevels}}}),h.prototype.load=function(){Object(o["a"])(this._bufferViewId)?p(this):m(this)};const b=/(^data:image\/ktx2)|(\.ktx2$)/i;function T(e){const t=e.url;return b.test(t)?Object(c["a"])(e):e.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0})}h.prototype.unload=function(){Object(o["a"])(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._uri=void 0,this._image=void 0,this._mipLevels=void 0,this._gltf=void 0},h._loadImageFromTypedArray=s["a"]},"9b40":function(e,t,a){"use strict";var r=a("2fad"),n=a("1a5d"),i=a("c937"),o=a("d05a"),s=a("4a63"),c=a("d5cf"),u=a("51f2"),d=a("5027"),l=a("b3ce"),h=a("da23"),f=a("ddd8"),p=a("dc6c");const m={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},g=m.DERIVED_COMMANDS_MAXIMUM_LENGTH,_=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function y(){this._frontFaceAlphaByDistance=new o["a"](0,1,0,1),this._backFaceAlphaByDistance=new o["a"](0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=s["a"].clone(s["a"].MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(g),this._derivedBlendCommandTypes=new Array(g),this._derivedPickCommandTypes=new Array(g),this._derivedCommandTypesToUpdate=new Array(g),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}function b(e,t,a,r){return e?Object(i["a"])(a)?(o["a"].clone(a,r),r.nearValue*=t,r.farValue*=t,r):(r.nearValue=t,r.farValue=t,r):(r.nearValue=1,r.farValue=1,r)}function T(e,t,a){return e&&(a.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function A(e,t){const a=e._frontFaceTranslucent,r=e._backFaceTranslucent;return a&&(t.cameraUnderground||r)}function O(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}function C(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}function v(e,t,a){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!a.depthTestAgainstTerrain&&t.mode!==p["a"].SCENE2D&&t.context.depthTexture}function E(e){let t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}function S(e,t){let a;e._derivedCommandsLength=x(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=x(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=x(e,t,!1,!0,e._derivedPickCommandTypes);let r=0;for(a=0;a<e._derivedCommandsLength;++a)r|=1<<e._derivedCommandTypes[a];for(a=0;a<e._derivedBlendCommandsLength;++a)r|=1<<e._derivedBlendCommandTypes[a];for(a=0;a<e._derivedPickCommandsLength;++a)r|=1<<e._derivedPickCommandTypes[a];let n=0;for(a=0;a<g;++a)(r&1<<a)>0&&(e._derivedCommandTypesToUpdate[n++]=a);e._derivedCommandsToUpdateLength=n;const o=r!==e._derivedCommandKey;e._derivedCommandKey=r,e._derivedCommandsDirty=o,!Object(i["a"])(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=Q())}function x(e,t,a,r,n){let i=0;const o=e._frontFaceTranslucent,s=e._backFaceTranslucent;if(!o)return i;const c=t.cameraUnderground,u=e._requiresManualDepthTest,d=r?m.PICK_FRONT_FACE:u?m.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:m.TRANSLUCENT_FRONT_FACE,l=r?m.PICK_BACK_FACE:u?m.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:m.TRANSLUCENT_BACK_FACE;return t.mode===p["a"].SCENE2D?(n[i++]=m.DEPTH_ONLY_FRONT_FACE,n[i++]=d,i):(s?(a||(n[i++]=m.DEPTH_ONLY_FRONT_AND_BACK_FACE),c?(n[i++]=d,n[i++]=l):(n[i++]=l,n[i++]=d)):c?(a||(n[i++]=m.DEPTH_ONLY_BACK_FACE),n[i++]=m.OPAQUE_FRONT_FACE,n[i++]=l):(a||(n[i++]=m.DEPTH_ONLY_FRONT_FACE),n[i++]=m.OPAQUE_BACK_FACE,n[i++]=d),i)}function D(e,t){const a=e.indexOf(t);a>-1&&e.splice(a,1)}function R(e,t){return e.indexOf(t)>-1}function w(e,t){D(e.defines,"TRANSLUCENT"),D(t.defines,"TRANSLUCENT")}function L(e,t){D(e.defines,"GROUND_ATMOSPHERE"),D(t.defines,"GROUND_ATMOSPHERE"),D(e.defines,"FOG"),D(t.defines,"FOG"),D(e.defines,"TRANSLUCENT"),D(t.defines,"TRANSLUCENT")}function F(e,t){if(R(t.defines,"TILE_LIMIT_RECTANGLE")||R(t.defines,"ENABLE_CLIPPING_PLANES"))return;const a="void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n";t.sources=[a]}function N(e,t){const a=t.sources,r=a.length;for(let i=0;i<r;++i)a[i]=l["a"].replaceMain(a[i],"czm_globe_translucency_main");const n="\n\nuniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n#ifdef MANUAL_DEPTH_TEST \n    float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st)); \n    if (logDepthOrDepth != 0.0) \n    { \n        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); \n        float depthEC = eyeCoordinate.z / eyeCoordinate.w; \n        if (v_positionEC.z < depthEC) \n        { \n            discard; \n        } \n    } \n#endif \n    czm_globe_translucency_main(); \n    vec4 classificationColor = texture2D(u_classificationTexture, st); \n    if (classificationColor.a > 0.0) \n    { \n        // Reverse premultiplication process to get the correct composited result of the classification primitives \n        classificationColor.rgb /= classificationColor.a; \n    } \n    gl_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + gl_FragColor * (1.0 - classificationColor.a); \n} \n";a.push(n)}function P(e,t){N(e,t),D(e.defines,"GROUND_ATMOSPHERE"),D(t.defines,"GROUND_ATMOSPHERE"),D(e.defines,"FOG"),D(t.defines,"FOG")}function I(e,t){N(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function j(e,t){P(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function M(e,t){const a="uniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n    vec4 pickColor = texture2D(u_classificationTexture, st); \n    if (pickColor == vec4(0.0)) \n    { \n        discard; \n    } \n    gl_FragColor = pickColor; \n} \n";t.sources=[a]}function B(e,t,a,r,n,o){if(!Object(i["a"])(n))return t;if(!r&&Object(i["a"])(a))return a;let s=e.shaderCache.getDerivedShaderProgram(t,o);if(!Object(i["a"])(s)){const a=t._attributeLocations,r=t.vertexShaderSource.clone(),c=t.fragmentShaderSource.clone();r.defines=Object(i["a"])(r.defines)?r.defines.slice(0):[],c.defines=Object(i["a"])(c.defines)?c.defines.slice(0):[],n(r,c),s=e.shaderCache.createDerivedShaderProgram(t,o,{vertexShaderSource:r,fragmentShaderSource:c,attributeLocations:a})}return s}function H(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0}function U(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0}function k(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function V(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function G(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function Y(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=h["a"].ALPHA_BLEND}function q(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=h["a"].ALPHA_BLEND}function z(e){e.cull.face=f["a"].BACK,e.cull.enabled=!0,e.blending.enabled=!1}function W(e){e.cull.face=f["a"].FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function K(e,t,a,r,n){if(!Object(i["a"])(r))return e;if(!a&&Object(i["a"])(t))return t;let o=n[e.id];if(!Object(i["a"])(o)){const t=d["a"].getState(e);r(t),o=d["a"].fromCache(t),n[e.id]=o}return o}function $(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function X(e,t,a,n,o){return Object(i["a"])(o)?!n&&Object(i["a"])(a)?a:Object(r["a"])(t,o(e),!1):t}function J(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}function Q(){return[new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:w,getRenderStateFunction:H,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:L,getRenderStateFunction:U,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:F,getRenderStateFunction:k,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:F,getRenderStateFunction:V,getUniformMapFunction:void 0}),new J({pass:u["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:F,getRenderStateFunction:G,getUniformMapFunction:void 0}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:N,getRenderStateFunction:Y,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:P,getRenderStateFunction:q,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:I,getRenderStateFunction:Y,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:j,getRenderStateFunction:q,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:M,getRenderStateFunction:z,getUniformMapFunction:$}),new J({pass:u["a"].TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:M,getRenderStateFunction:W,getUniformMapFunction:$})]}Object.defineProperties(y.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}}),y.prototype.update=function(e){const t=e.globe;if(!Object(i["a"])(t)||!t.show)return this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,void(this._useDepthPlane=!1);this._frontFaceAlphaByDistance=b(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=b(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=T(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=T(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=v(this,e,t),this._sunVisibleThroughGlobe=A(this,e),this._environmentVisible=O(this,e),this._useDepthPlane=C(this,e),this._numberOfTextureUniforms=E(this),this._rectangle=s["a"].clone(t.translucency.rectangle,this._rectangle),S(this,e)};const Z=new Array(g),ee=new Array(g);function te(e,t,a,r,o,s,u){let d=t.derivedCommands.globeTranslucency;const l=e._derivedCommandsDirty;if(t.dirty||!Object(i["a"])(d)||l){t.dirty=!1,Object(i["a"])(d)||(d={},t.derivedCommands.globeTranslucency=d);const l=u.frameNumber,h=Object(n["a"])(d.uniformMapDirtyFrame,0),f=Object(n["a"])(d.shaderProgramDirtyFrame,0),p=Object(n["a"])(d.renderStateDirtyFrame,0),m=d.uniformMap!==t.uniformMap,g=d.shaderProgramId!==t.shaderProgram.id,_=d.renderStateId!==t.renderState.id;m&&(d.uniformMapDirtyFrame=l),g&&(d.shaderProgramDirtyFrame=l),_&&(d.renderStateDirtyFrame=l),d.uniformMap=t.uniformMap,d.shaderProgramId=t.shaderProgram.id,d.renderStateId=t.renderState.id;for(let y=0;y<a;++y){const a=s[y],b=r[y],T=o[y];let A,O,C,v=d[T];Object(i["a"])(v)?(A=v.uniformMap,O=v.shaderProgram,C=v.renderState):(A=void 0,O=void 0,C=void 0),v=c["a"].shallowClone(t,v),d[T]=v;const E=Object(n["a"])(v.derivedCommands.uniformMapDirtyFrame,0),S=Object(n["a"])(v.derivedCommands.shaderProgramDirtyFrame,0),x=Object(n["a"])(v.derivedCommands.renderStateDirtyFrame,0),D=m||E<h,R=g||S<f,w=_||x<p;D&&(v.derivedCommands.uniformMapDirtyFrame=l),R&&(v.derivedCommands.shaderProgramDirtyFrame=l),w&&(v.derivedCommands.renderStateDirtyFrame=l),v.derivedCommands.type=b,v.pass=a.pass,v.pickOnly=a.pickOnly,v.uniformMap=X(e,t.uniformMap,A,D,a.getUniformMapFunction),v.shaderProgram=B(u.context,t.shaderProgram,O,R,a.getShaderProgramFunction,T),v.renderState=K(t.renderState,C,w,a.getRenderStateFunction,a.renderStateCache)}}}function ae(e,t,a,r,n,o,s){for(let c=0;c<t;++c){const t=e[c],u=t.derivedCommands.type;(!Object(i["a"])(s)||s.indexOf(u)>-1)&&a(t,r,n,o)}}function re(e,t,a,r,n,i){for(let o=0;o<t;++o)a(e[o],r,n,i)}y.prototype.updateDerivedCommands=function(e,t){const a=this._derivedCommandTypesToUpdate,r=this._derivedCommandsToUpdateLength;if(0!==r){for(let e=0;e<r;++e)ee[e]=this._derivedCommandPacks[a[e]],Z[e]=_[a[e]];te(this,e,r,a,Z,ee,t)}},y.prototype.pushDerivedCommands=function(e,t,a){const r=a.passes.pick;if(r&&t)return;let n=this._derivedCommandTypes,i=this._derivedCommandsLength;if(r?(n=this._derivedPickCommandTypes,i=this._derivedPickCommandsLength):t&&(n=this._derivedBlendCommandTypes,i=this._derivedBlendCommandsLength),0===i)return void a.commandList.push(e);const o=e.derivedCommands.globeTranslucency;for(let s=0;s<i;++s){const e=_[n[s]];a.commandList.push(o[e])}};const ne=[m.OPAQUE_FRONT_FACE,m.OPAQUE_BACK_FACE],ie=[m.DEPTH_ONLY_FRONT_FACE,m.DEPTH_ONLY_BACK_FACE,m.DEPTH_ONLY_FRONT_AND_BACK_FACE];y.prototype.executeGlobeCommands=function(e,t,a,r,n){const i=r.context,o=e.commands[u["a"].GLOBE],s=e.indices[u["a"].GLOBE];0!==s&&(this._globeTranslucencyFramebuffer=a,a.clearClassification(i,n),ae(o,s,t,r,i,n,ne))},y.prototype.executeGlobeClassificationCommands=function(e,t,a,r,n){const i=r.context,o=e.commands[u["a"].GLOBE],s=e.indices[u["a"].GLOBE],c=e.commands[u["a"].TERRAIN_CLASSIFICATION],d=e.indices[u["a"].TERRAIN_CLASSIFICATION];if(0===s||0===d)return;const l=this._frontFaceTranslucent,h=this._backFaceTranslucent;if(l&&h||re(c,d,t,r,i,n),!l&&!h)return;this._globeTranslucencyFramebuffer=a;const f=i.uniformState.globeDepthTexture,p=n.framebuffer;if(n.framebuffer=a.classificationFramebuffer,ae(o,s,t,r,i,n,ie),i.depthTexture){const e=a.packDepth(i,n);i.uniformState.globeDepthTexture=e}re(c,d,t,r,i,n),i.uniformState.globeDepthTexture=f,n.framebuffer=p},t["a"]=y},c3807:function(e,t,a){"use strict";var r=a("8656"),n=a("547b"),i=a("85b2"),o=a("dde0"),s=a("6b82"),c=a("8d54"),u=a("44e9"),d=a("4051"),l=a("ed17"),h=a("2fad"),f=a("1a5d"),p=a("c937"),m=a("21b7"),g=a("e2a6"),_=a("f7b5"),y=a("e8ff"),b=a("f6fe"),T=a("2642"),A=a("a61d"),O=a("b8b5"),C=a("722e"),v=a("d05a"),E=a("22d6"),S=a("ec1a"),x=a("82ba"),D=a("4a63"),R=a("a38f"),w=a("d9c4"),L=a("4f90"),F=a("d830"),N=a("5be5"),P=a("6f54"),I=a("6ba7"),j=a("2341"),M=a("d5cf"),B=a("51f2"),H=a("5027"),U=a("dc15"),k=a("da23"),V=a("bd5e"),G=a("0650"),Y=a("761d"),q=a("2507"),z=a("e607"),W=a("1f21"),K=a("5769"),$=a("65d7"),X=a("dc6c"),J=a("ff3a"),Q=a("2ee1"),Z=a("e9e8"),ee=a("b743"),te=a("b911");function ae(e){if(!Object(p["a"])(e))throw new g["a"]("options is required.");if(!Object(p["a"])(e.terrainProvider))throw new g["a"]("options.terrainProvider is required.");if(!Object(p["a"])(e.imageryLayers))throw new g["a"]("options.imageryLayers is required.");if(!Object(p["a"])(e.surfaceShaderSet))throw new g["a"]("options.surfaceShaderSet is required.");this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=J["a"].RECEIVE_ONLY,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.lambertDiffuseMultiplier=0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new _["a"],this._imageryLayers.layerAdded.addEventListener(ae.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(ae.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(ae.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(ae.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new _["a"],this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new d["a"](0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=D["a"].clone(D["a"].MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldTerrainExaggeration=void 0,this._oldTerrainExaggerationRelativeHeight=void 0}function re(e,t){let a=e.loadingImagery;Object(p["a"])(a)||(a=e.readyImagery);let r=t.loadingImagery;return Object(p["a"])(r)||(r=t.readyImagery),a.imageryLayer._layerIndex-r.imageryLayer._layerIndex}function ne(e,t){const a=t.creditDisplay;e._terrainProvider.ready&&Object(p["a"])(e._terrainProvider.credit)&&a.addCredit(e._terrainProvider.credit);const r=e._imageryLayers;for(let n=0,i=r.length;n<i;++n){const e=r.get(n).imageryProvider;e.ready&&Object(p["a"])(e.credit)&&a.addCredit(e.credit)}}function ie(e,t){const a=t.globeTranslucencyState;if(a.translucent){const r=e.renderState.blending.enabled;a.pushDerivedCommands(e,r,t)}else t.commandList.push(e)}Object.defineProperties(ae.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!Object(p["a"])(e))throw new g["a"]("value is required.");this._baseColor=e,this._firstPassInitialColor=s["a"].fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!Object(p["a"])(e))throw new g["a"]("value is required.");this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(this._terrainProvider!==e){if(!Object(p["a"])(e))throw new g["a"]("terrainProvider is required.");this._terrainProvider=e,Object(p["a"])(this._quadtree)&&this._quadtree.invalidateAllTiles()}}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){V["a"].setOwner(e,this,"_clippingPlanes")}}}),ae.prototype.update=function(e){this._imageryLayers._update()},ae.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile((function(e){e.data.imagery.sort(re)}))),ne(this,e);const t=this._vertexArraysToDestroy,a=t.length;for(let r=0;r<a;++r)Y["a"]._freeVertexArray(t[r]);t.length=0},ae.prototype.beginUpdate=function(e){const t=this._tilesToRenderByTextureCount;for(let r=0,n=t.length;r<n;++r){const e=t[r];Object(p["a"])(e)&&(e.length=0)}const a=this._clippingPlanes;Object(p["a"])(a)&&a.enabled&&a.update(e),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},ae.prototype.endUpdate=function(e){if(!Object(p["a"])(this._renderState)){this._renderState=H["a"].fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:G["a"].LESS}}),this._blendRenderState=H["a"].fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:G["a"].LESS_OR_EQUAL},blending:k["a"].ALPHA_BLEND});let e=Object(u["a"])(this._renderState,!0);e.cull.enabled=!1,this._disableCullingRenderState=H["a"].fromCache(e),e=Object(u["a"])(this._blendRenderState,!0),e.cull.enabled=!1,this._disableCullingBlendRenderState=H["a"].fromCache(e)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&Q["a"].updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);const t=this.quadtree,a=e.terrainExaggeration,r=e.terrainExaggerationRelativeHeight,n=this._oldTerrainExaggeration!==a||this._oldTerrainExaggerationRelativeHeight!==r;this._oldTerrainExaggeration=a,this._oldTerrainExaggerationRelativeHeight=r,n&&t.forEachLoadedTile((function(a){const r=a.data;r.updateExaggeration(a,e,t)}));const i=this._tilesToRenderByTextureCount;for(let o=0,s=i.length;o<s;++o){const t=i[o];if(Object(p["a"])(t))for(let a=0,r=t.length;a<r;++a){const r=t[a],n=r.data.tileBoundingRegion;Ue(this,r,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,n.minimumHeight)}}},ae.prototype.updateForPick=function(e){const t=this._drawCommands;for(let a=0,r=this._usedDrawCommands;a<r;++a)ie(t[a],e)},ae.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},ae.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},ae.prototype.loadTile=function(e,t){let a,r=t.data,n=!0;Object(p["a"])(r)&&(n=r.boundingVolumeSourceTile!==t||t._lastSelectionResult===te["a"].CULLED_BUT_NEEDED,a=r.terrainState),Y["a"].processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,n),r=t.data,n&&a!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==F["a"].NONE&&r.boundingVolumeSourceTile===t&&(n=!1,Y["a"].processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,n))};const oe=new r["a"],se=new D["a"],ce=new D["a"],ue=new c["a"];function de(e,t){if(t.west<t.east)return t;const a=D["a"].clone(t,ce),r=D["a"].center(e,ue);return r.longitude>0?a.east=O["a"].PI:a.west=-O["a"].PI,a}function le(e,t){if(t.cameraUnderground)return!0;if(t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;const a=e._clippingPlanes;return!(!Object(p["a"])(a)||!a.enabled)||!D["a"].equals(e.cartographicLimitRectangle,D["a"].MAX_VALUE)}ae.prototype.computeTileVisibility=function(e,t,a){const n=this.computeDistanceToTile(e,t);e._distance=n;const i=le(this,t);if(t.fog.enabled&&!i&&O["a"].fog(n,t.fog.density)>=1)return F["a"].NONE;const s=e.data,c=s.tileBoundingRegion;if(void 0===s.boundingVolumeSourceTile)return F["a"].PARTIAL;const u=t.cullingVolume;let d=c.boundingVolume;Object(p["a"])(d)||(d=c.boundingSphere),s.clippedByBoundaries=!1;const l=de(e.rectangle,this.cartographicLimitRectangle),h=D["a"].simpleIntersection(l,e.rectangle,se);if(!Object(p["a"])(h))return F["a"].NONE;if(D["a"].equals(h,e.rectangle)||(s.clippedByBoundaries=!0),t.mode!==X["a"].SCENE3D&&(d=oe,r["a"].fromRectangleWithHeights2D(e.rectangle,t.mapProjection,c.minimumHeight,c.maximumHeight,d),o["a"].fromElements(d.center.z,d.center.x,d.center.y,d.center),t.mode===X["a"].MORPHING&&Object(p["a"])(s.renderedMesh)&&(d=r["a"].union(c.boundingSphere,d,d))),!Object(p["a"])(d))return F["a"].PARTIAL;const f=this._clippingPlanes;if(Object(p["a"])(f)&&f.enabled){const t=f.computeIntersectionWithBoundingVolume(d);if(e.isClipped=t!==A["a"].INSIDE,t===A["a"].OUTSIDE)return F["a"].NONE}let m;const g=u.computeVisibility(d);if(g===A["a"].OUTSIDE?m=F["a"].NONE:g===A["a"].INTERSECTING?m=F["a"].PARTIAL:g===A["a"].INSIDE&&(m=F["a"].FULL),m===F["a"].NONE)return m;const _=t.mode===X["a"].SCENE3D&&t.camera.frustum instanceof S["a"];if(t.mode===X["a"].SCENE3D&&!_&&Object(p["a"])(a)&&!i){const e=s.occludeePointInScaledSpace;return Object(p["a"])(e)?a.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(e,c.minimumHeight)?m:F["a"].NONE:m}return m},ae.prototype.canRefine=function(e){if(Object(p["a"])(e.data.terrainData))return!0;const t=this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1);return void 0!==t};const he=[],fe=[];ae.prototype.canRenderWithoutLosingDetail=function(e,t){const a=e.data,r=he;r.length=this._imageryLayers.length;let n,i,o,s=!1,c=!1;for(Object(p["a"])(a)&&(s=a.terrainState===Z["a"].READY,c=!0,n=a.imagery),i=0,o=r.length;i<o;++i)r[i]=c;if(Object(p["a"])(n))for(i=0,o=n.length;i<o;++i){const e=n[i],t=e.loadingImagery,a=!Object(p["a"])(t)||t.state===z["a"].FAILED||t.state===z["a"].INVALID,o=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;r[o]=a&&r[o]}const u=this.quadtree._lastSelectionFrameNumber,d=fe;d.length=0,d.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);while(d.length>0){const e=d.pop(),t=e._lastSelectionResultFrame===u?e._lastSelectionResult:te["a"].NONE;if(t===te["a"].RENDERED){const t=e.data;if(!Object(p["a"])(t))continue;if(!s&&e.data.terrainState===Z["a"].READY)return!1;const a=e.data.imagery;for(i=0,o=a.length;i<o;++i){const e=a[i],t=e.loadingImagery,n=!Object(p["a"])(t)||t.state===z["a"].FAILED||t.state===z["a"].INVALID,o=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;if(n&&!r[o])return!1}}else t===te["a"].REFINED&&d.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild)}return!0};const pe=new o["a"];ae.prototype.computeTileLoadPriority=function(e,t){const a=e.data;if(void 0===a)return 0;const r=a.tileBoundingRegion.boundingVolume;if(void 0===r)return 0;const n=t.camera.positionWC,i=t.camera.directionWC,s=o["a"].subtract(r.center,n,pe),c=o["a"].magnitude(s);return c<O["a"].EPSILON5?0:(o["a"].divideByScalar(s,c,s),(1-o["a"].dot(s,i))*e._distance)};const me=new C["a"],ge=new C["a"],_e=new s["a"],ye=new s["a"],be=new s["a"],Te=new o["a"],Ae=new o["a"],Oe=new o["a"],Ce=new o["a"];ae.prototype.showTileThisFrame=function(e,t){let a=0;const r=e.data.imagery;for(let s=0,c=r.length;s<c;++s){const e=r[s];Object(p["a"])(e.readyImagery)&&0!==e.readyImagery.imageryLayer.alpha&&++a}let n=this._tilesToRenderByTextureCount[a];Object(p["a"])(n)||(n=[],this._tilesToRenderByTextureCount[a]=n),n.push(e);const i=e.data;Object(p["a"])(i.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;const o=this._debug;++o.tilesRendered,o.texturesRendered+=a};const ve=[new o["a"],new o["a"],new o["a"],new o["a"]];function Ee(e,t,a,r,n,i){const s=e.quadtree._occluders.ellipsoid,c=s.ellipsoid,u=ve;return o["a"].fromRadians(a.west,a.south,n,c,u[0]),o["a"].fromRadians(a.east,a.south,n,c,u[1]),o["a"].fromRadians(a.west,a.north,n,c,u[2]),o["a"].fromRadians(a.east,a.north,n,c,u[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,u,r,i)}function Se(e,t,a){let n=e.data;void 0===n&&(n=e.data=new Y["a"]);const i=e.tilingScheme.ellipsoid;void 0===n.tileBoundingRegion&&(n.tileBoundingRegion=new ee["a"]({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:i,minimumHeight:0,maximumHeight:0}));const s=n.tileBoundingRegion,c=s.minimumHeight,u=s.maximumHeight;let d=!1,l=e;const h=n.mesh,f=n.terrainData;if(void 0!==h&&void 0!==h.minimumHeight&&void 0!==h.maximumHeight)s.minimumHeight=h.minimumHeight,s.maximumHeight=h.maximumHeight,d=!0;else if(void 0!==f&&void 0!==f._minimumHeight&&void 0!==f._maximumHeight)s.minimumHeight=f._minimumHeight,s.maximumHeight=f._maximumHeight;else{s.minimumHeight=Number.NaN,s.maximumHeight=Number.NaN;let t=e.parent;while(void 0!==t){const e=t.data;if(void 0!==e){const t=e.mesh,a=e.terrainData;if(void 0!==t&&void 0!==t.minimumHeight&&void 0!==t.maximumHeight){s.minimumHeight=t.minimumHeight,s.maximumHeight=t.maximumHeight;break}if(void 0!==a&&void 0!==a._minimumHeight&&void 0!==a._maximumHeight){s.minimumHeight=a._minimumHeight,s.maximumHeight=a._maximumHeight;break}}t=t.parent}l=t}if(void 0!==l){const f=a.terrainExaggeration,m=a.terrainExaggerationRelativeHeight,g=1!==f;if(g&&(d=!1,s.minimumHeight=w["a"].getHeight(s.minimumHeight,f,m),s.maximumHeight=w["a"].getHeight(s.maximumHeight,f,m)),d)n.boundingVolumeIsFromMesh||(s._orientedBoundingBox=E["a"].clone(h.orientedBoundingBox,s._orientedBoundingBox),s._boundingSphere=r["a"].clone(h.boundingSphere3D,s._boundingSphere),n.occludeePointInScaledSpace=o["a"].clone(h.occludeePointInScaledSpace,n.occludeePointInScaledSpace),Object(p["a"])(n.occludeePointInScaledSpace)||(n.occludeePointInScaledSpace=Ee(t,s._orientedBoundingBox.center,e.rectangle,s.minimumHeight,s.maximumHeight,n.occludeePointInScaledSpace)));else{const a=void 0===s._orientedBoundingBox||void 0===s._boundingSphere,r=s.minimumHeight!==c||s.maximumHeight!==u;(r||a)&&(s.computeBoundingVolumes(i),n.occludeePointInScaledSpace=Ee(t,s._orientedBoundingBox.center,e.rectangle,s.minimumHeight,s.maximumHeight,n.occludeePointInScaledSpace))}n.boundingVolumeSourceTile=l,n.boundingVolumeIsFromMesh=d}else n.boundingVolumeSourceTile=void 0,n.boundingVolumeIsFromMesh=!1}function xe(e,t,a){return function(r){let n,i,o=-1;const s=r.data.imagery,c=s.length;let u;for(u=0;u<c;++u)if(n=s[u],i=Object(f["a"])(n.readyImagery,n.loadingImagery),i.imageryLayer===t){o=u;break}if(-1!==o){const c=o+e;if(n=s[c],i=Object(p["a"])(n)?Object(f["a"])(n.readyImagery,n.loadingImagery):void 0,!Object(p["a"])(i)||i.imageryLayer!==t)return!t._createTileImagerySkeletons(r,a,c);for(u=o;u<c;++u)s[u].freeResources();s.splice(o,e)}return!0}}ae.prototype.computeDistanceToTile=function(e,t){Se(e,this,t);const a=e.data,r=a.boundingVolumeSourceTile;if(void 0===r)return 9999999999;const n=a.tileBoundingRegion,i=n.minimumHeight,o=n.maximumHeight;if(a.boundingVolumeSourceTile!==e){const e=t.camera.positionCartographic.height,a=Math.abs(e-i),r=Math.abs(e-o);a>r?(n.minimumHeight=i,n.maximumHeight=i):(n.minimumHeight=o,n.maximumHeight=o)}const s=n.distanceToCamera(t);return n.minimumHeight=i,n.maximumHeight=o,s},ae.prototype.isDestroyed=function(){return!1},ae.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),Object(m["a"])(this)},ae.prototype._onLayerAdded=function(e,t){if(e.show){const t=this._terrainProvider,a=this,r=e.imageryProvider,n=this._imageryLayersUpdatedEvent;r._reload=function(){e._imageryCache={},a._quadtree.forEachLoadedTile((function(a){if(Object(p["a"])(a._loadedCallbacks[e._layerIndex]))return;let r;const n=a.data.imagery,i=n.length;let o=-1,s=0;for(r=0;r<i;++r){const t=n[r],a=Object(f["a"])(t.readyImagery,t.loadingImagery);if(a.imageryLayer===e)-1===o&&(o=r),++s;else if(-1!==o)break}if(-1===o)return;const c=o+s;e._createTileImagerySkeletons(a,t,c)&&(a._loadedCallbacks[e._layerIndex]=xe(s,e,t),a.state=$["a"].LOADING)}))},this._quadtree.forEachLoadedTile((function(r){e._createTileImagerySkeletons(r,t)&&(r.state=$["a"].LOADING,0===r.level||r._lastSelectionResultFrame===a.quadtree._lastSelectionFrameNumber&&r._lastSelectionResult===te["a"].RENDERED||(r.renderable=!1))})),this._layerOrderChanged=!0,n.raiseEvent()}},ae.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile((function(t){const a=t.data.imagery;let r=-1,n=0;for(let i=0,o=a.length;i<o;++i){const t=a[i];let o=t.loadingImagery;if(Object(p["a"])(o)||(o=t.readyImagery),o.imageryLayer===e)-1===r&&(r=i),t.freeResources(),++n;else if(-1!==r)break}-1!==r&&a.splice(r,n)})),Object(p["a"])(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},ae.prototype._onLayerMoved=function(e,t,a){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},ae.prototype._onLayerShownOrHidden=function(e,t,a){a?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};const De=new C["a"],Re=new C["a"];function we(e,t){const a={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_terrainExaggerationAndRelativeHeight:function(){return this.properties.terrainExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){const t=e.context.uniformState.view,a=C["a"].multiplyByPoint(t,this.properties.rtc,Ae);return C["a"].setTranslation(t,a,me),me},u_modifiedModelViewProjection:function(){const t=e.context.uniformState.view,a=e.context.uniformState.projection,r=C["a"].multiplyByPoint(t,this.properties.rtc,Ae);return C["a"].setTranslation(t,r,ge),C["a"].multiply(a,ge,ge),ge},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){const a=t._clippingPlanes;return Object(p["a"])(a)&&Object(p["a"])(a.texture)?a.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){const a=t._clippingPlanes,r=Object(p["a"])(a)?C["a"].multiply(e.context.uniformState.view,a.modelMatrix,De):C["a"].IDENTITY;return C["a"].inverseTranspose(r,Re)},u_clippingPlanesEdgeStyle:function(){const e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},u_lambertDiffuseMultiplier:function(){return this.properties.lambertDiffuseMultiplier},properties:{initialColor:new s["a"](0,0,.5,1),fillHighlightColor:new d["a"](0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new i["a"](65e5,9e6),nightFadeDistance:new i["a"](1e7,4e7),hsbShift:new o["a"],center3D:void 0,rtc:new o["a"],modifiedModelView:new C["a"],tileRectangle:new s["a"],terrainExaggerationAndRelativeHeight:new i["a"](1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new i["a"],southMercatorYAndOneOverHeight:new i["a"],waterMask:void 0,waterMaskTranslationAndScale:new s["a"],minMaxHeight:new i["a"],scaleAndBias:new C["a"],clippingPlanesEdgeColor:d["a"].clone(d["a"].WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new s["a"],frontFaceAlphaByDistance:new s["a"],backFaceAlphaByDistance:new s["a"],localizedTranslucencyRectangle:new s["a"],undergroundColor:d["a"].clone(d["a"].TRANSPARENT),undergroundColorAlphaByDistance:new s["a"],lambertDiffuseMultiplier:0}};return Object(p["a"])(t.materialUniformMap)?Object(h["a"])(a,t.materialUniformMap):a}function Le(e,t,a){const r=a.data;let n,i;if(Object(p["a"])(r.vertexArray)?(n=r.mesh,i=r.vertexArray):Object(p["a"])(r.fill)&&Object(p["a"])(r.fill.vertexArray)&&(n=r.fill.mesh,i=r.fill.vertexArray),Object(p["a"])(n)&&Object(p["a"])(i)){if(Object(p["a"])(r.wireframeVertexArray)){if(r.wireframeVertexArray.mesh===n)return;r.wireframeVertexArray.destroy(),r.wireframeVertexArray=void 0}r.wireframeVertexArray=Fe(e,i,n),r.wireframeVertexArray.mesh=n}}function Fe(e,t,a){const r=a.indices,n={indices:r,primitiveType:x["a"].TRIANGLES};b["a"].toWireframe(n);const i=n.indices,o=P["a"].createIndexBuffer({context:e,typedArray:i,usage:I["a"].STATIC_DRAW,indexDatatype:T["a"].fromSizeInBytes(i.BYTES_PER_ELEMENT)});return new U["a"]({context:e,attributes:t._attributes,indexBuffer:o})}let Ne,Pe,Ie;(function(){const e=new y["a"]({geometry:n["a"].fromDimensions({dimensions:new o["a"](2,2,2)})}),t=new y["a"]({geometry:new R["a"]({radius:1})});let a,r,i=new C["a"];function s(e){return new K["a"]({geometryInstances:e,appearance:new W["a"]({translucent:!1,flat:!0}),asynchronous:!1})}Ne=function(t,n){return t===a||(Ie(),a=t,i=C["a"].fromRotationTranslation(t.halfAxes,t.center,i),e.modelMatrix=i,e.attributes.color=l["a"].fromColor(n),r=s(e)),r},Pe=function(e,n){return e===a||(Ie(),a=e,i=C["a"].fromTranslation(e.center,i),i=C["a"].multiplyByUniformScale(i,e.radius,i),t.modelMatrix=i,t.attributes.color=l["a"].fromColor(n),r=s(t)),r},Ie=function(){Object(p["a"])(r)&&(r.destroy(),r=void 0,a=void 0)}})();const je=new s["a"](0,0,0,0),Me={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},Be=d["a"].TRANSPARENT,He=new v["a"];function Ue(e,t,a){const n=t.data;Object(p["a"])(n.vertexArray)||(void 0===n.fill&&(n.fill=new Q["a"](t)),n.fill.update(e,a));const i=a.creditDisplay,c=n.terrainData;if(Object(p["a"])(c)&&Object(p["a"])(c.credits)){const e=c.credits;for(let t=0,a=e.length;t<a;++t)i.addCredit(e[t])}let u=j["a"].maximumTextureImageUnits,l=n.waterMaskTexture,h=n.waterMaskTranslationAndScale;!Object(p["a"])(l)&&Object(p["a"])(n.fill)&&(l=n.fill.waterMaskTexture,h=n.fill.waterMaskTranslationAndScale);const m=a.cameraUnderground,_=a.globeTranslucencyState,y=_.translucent,b=_.frontFaceAlphaByDistance,T=_.backFaceAlphaByDistance,A=_.rectangle,v=Object(f["a"])(e.undergroundColor,Be),S=Object(f["a"])(e.undergroundColorAlphaByDistance,He),R=le(e,a)&&a.mode===X["a"].SCENE3D&&v.alpha>0&&(S.nearValue>0||S.farValue>0),w=e.lambertDiffuseMultiplier,F=e.hasWaterMask&&Object(p["a"])(l),P=e.oceanNormalMap,I=F&&Object(p["a"])(P),H=e.terrainProvider.ready&&e.terrainProvider.hasVertexNormals,U=a.fog.enabled&&a.fog.renderable&&!m,k=e.showGroundAtmosphere&&a.mode===X["a"].SCENE3D,V=J["a"].castShadows(e.shadows)&&!y,G=J["a"].receiveShadows(e.shadows)&&!y,Y=e.hueShift,z=e.saturationShift,W=e.brightnessShift;let K=!(O["a"].equalsEpsilon(Y,0,O["a"].EPSILON7)&&O["a"].equalsEpsilon(z,0,O["a"].EPSILON7)&&O["a"].equalsEpsilon(W,0,O["a"].EPSILON7)),$=!1;if(k){const t=o["a"].magnitude(a.camera.positionWC),r=e.nightFadeOutDistance;$=t>r}F&&--u,I&&--u,Object(p["a"])(a.shadowState)&&a.shadowState.shadowsEnabled&&--u,Object(p["a"])(e.clippingPlanes)&&e.clippingPlanes.enabled&&--u,u-=_.numberOfTextureUniforms;const Z=n.renderedMesh;let ee=Z.center;const te=Z.encoding,ae=n.tileBoundingRegion,re=a.terrainExaggeration,ne=a.terrainExaggerationRelativeHeight,oe=1!==re,ce=te.hasGeodeticSurfaceNormals,ue=_e;let he=0,fe=0,pe=0,me=0,ge=!1;if(a.mode!==X["a"].SCENE3D){const e=a.mapProjection,r=e.project(D["a"].southwest(t.rectangle),Oe),n=e.project(D["a"].northeast(t.rectangle),Ce);if(ue.x=r.x,ue.y=r.y,ue.z=n.x,ue.w=n.y,a.mode!==X["a"].MORPHING&&(ee=Te,ee.x=0,ee.y=.5*(ue.z+ue.x),ee.z=.5*(ue.w+ue.y),ue.x-=ee.y,ue.y-=ee.z,ue.z-=ee.y,ue.w-=ee.z),a.mode===X["a"].SCENE2D&&te.quantization===L["a"].BITS12){const e=1/(Math.pow(2,12)-1)*.5,t=(ue.z-ue.x)*e,a=(ue.w-ue.y)*e;ue.x-=t,ue.y-=a,ue.z+=t,ue.w+=a}e instanceof N["a"]&&(he=t.rectangle.south,fe=t.rectangle.north,pe=N["a"].geodeticLatitudeToMercatorAngle(he),me=1/(N["a"].geodeticLatitudeToMercatorAngle(fe)-pe),ge=!0)}const Ae=Me;Ae.frameState=a,Ae.surfaceTile=n,Ae.showReflectiveOcean=F,Ae.showOceanWaves=I,Ae.enableLighting=e.enableLighting,Ae.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,Ae.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,Ae.showGroundAtmosphere=k,Ae.perFragmentGroundAtmosphere=$,Ae.hasVertexNormals=H,Ae.useWebMercatorProjection=ge,Ae.clippedByBoundaries=n.clippedByBoundaries,Ae.hasGeodeticSurfaceNormals=ce,Ae.hasExaggeration=oe;const ve=n.imagery;let Ee=0;const Se=ve.length,xe=e.showSkirts&&!m&&!y,De=e.backFaceCulling&&!m&&!y,Re=De?e._renderState:e._disableCullingRenderState,Fe=De?e._blendRenderState:e._disableCullingBlendRenderState;let Ue=Re,ke=e._firstPassInitialColor;const Ve=a.context;Object(p["a"])(e._debug.boundingSphereTile)||Ie();const Ge=e._materialUniformMap!==e.materialUniformMap;if(Ge){e._materialUniformMap=e.materialUniformMap;const t=e._drawCommands.length;for(let r=0;r<t;++r)e._uniformMaps[r]=we(a,e)}do{let c,f,L=0;if(e._drawCommands.length<=e._usedDrawCommands?(c=new M["a"],c.owner=t,c.cull=!1,c.boundingVolume=new r["a"],c.orientedBoundingBox=void 0,f=we(a,e),e._drawCommands.push(c),e._uniformMaps.push(f)):(c=e._drawCommands[e._usedDrawCommands],f=e._uniformMaps[e._usedDrawCommands]),c.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){const e=ae.boundingVolume,t=ae.boundingSphere;Object(p["a"])(e)?Ne(e,d["a"].RED).update(a):Object(p["a"])(t)&&Pe(t,d["a"].RED).update(a)}const F=f.properties;s["a"].clone(ke,F.initialColor),F.oceanNormalMap=P,F.lightingFadeDistance.x=e.lightingFadeOutDistance,F.lightingFadeDistance.y=e.lightingFadeInDistance,F.nightFadeDistance.x=e.nightFadeOutDistance,F.nightFadeDistance.y=e.nightFadeInDistance,F.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;const N=m?T:b,I=m?b:T;Object(p["a"])(N)&&(s["a"].fromElements(N.near,N.nearValue,N.far,N.farValue,F.frontFaceAlphaByDistance),s["a"].fromElements(I.near,I.nearValue,I.far,I.farValue,F.backFaceAlphaByDistance)),s["a"].fromElements(S.near,S.nearValue,S.far,S.farValue,F.undergroundColorAlphaByDistance),d["a"].clone(v,F.undergroundColor),F.lambertDiffuseMultiplier=w;const j=!Object(p["a"])(n.vertexArray)&&Object(p["a"])(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;j&&d["a"].clone(e.fillHighlightColor,F.fillHighlightColor),F.terrainExaggerationAndRelativeHeight.x=re,F.terrainExaggerationAndRelativeHeight.y=ne,F.center3D=Z.center,o["a"].clone(ee,F.rtc),s["a"].clone(ue,F.tileRectangle),F.southAndNorthLatitude.x=he,F.southAndNorthLatitude.y=fe,F.southMercatorYAndOneOverHeight.x=pe,F.southMercatorYAndOneOverHeight.y=me;const H=ye,$=de(t.rectangle,e.cartographicLimitRectangle),J=be,Q=de(t.rectangle,A);o["a"].fromElements(Y,z,W,F.hsbShift);const oe=t.rectangle,ce=1/oe.width,le=1/oe.height;H.x=($.west-oe.west)*ce,H.y=($.south-oe.south)*le,H.z=($.east-oe.west)*ce,H.w=($.north-oe.south)*le,s["a"].clone(H,F.localizedCartographicLimitRectangle),J.x=(Q.west-oe.west)*ce,J.y=(Q.south-oe.south)*le,J.z=(Q.east-oe.west)*ce,J.w=(Q.north-oe.south)*le,s["a"].clone(J,F.localizedTranslucencyRectangle);const ge=U&&O["a"].fog(t._distance,a.fog.density)>O["a"].EPSILON3;K=K&&(ge||k);let _e=!1,Te=!1,Oe=!1,Ce=!1,De=!1,Re=!1,Ie=!1,Me=!1,Be=!1,He=!1;while(L<u&&Ee<Se){const e=ve[Ee],a=e.readyImagery;if(++Ee,!Object(p["a"])(a)||0===a.imageryLayer.alpha)continue;const r=e.useWebMercatorT?a.textureWebMercator:a.texture;if(!Object(p["a"])(r))throw new g["a"]("readyImagery is not actually ready!");const n=a.imageryLayer;Object(p["a"])(e.textureTranslationAndScale)||(e.textureTranslationAndScale=n._calculateTextureTranslationAndScale(t,e)),F.dayTextures[L]=r,F.dayTextureTranslationAndScale[L]=e.textureTranslationAndScale,F.dayTextureTexCoordsRectangle[L]=e.textureCoordinateRectangle,F.dayTextureUseWebMercatorT[L]=e.useWebMercatorT,F.dayTextureAlpha[L]=n.alpha,Re=Re||1!==F.dayTextureAlpha[L],F.dayTextureNightAlpha[L]=n.nightAlpha,Ie=Ie||1!==F.dayTextureNightAlpha[L],F.dayTextureDayAlpha[L]=n.dayAlpha,Ie=Ie||1!==F.dayTextureDayAlpha[L],F.dayTextureBrightness[L]=n.brightness,_e=_e||F.dayTextureBrightness[L]!==q["a"].DEFAULT_BRIGHTNESS,F.dayTextureContrast[L]=n.contrast,Te=Te||F.dayTextureContrast[L]!==q["a"].DEFAULT_CONTRAST,F.dayTextureHue[L]=n.hue,Oe=Oe||F.dayTextureHue[L]!==q["a"].DEFAULT_HUE,F.dayTextureSaturation[L]=n.saturation,Ce=Ce||F.dayTextureSaturation[L]!==q["a"].DEFAULT_SATURATION,F.dayTextureOneOverGamma[L]=1/n.gamma,De=De||F.dayTextureOneOverGamma[L]!==1/q["a"].DEFAULT_GAMMA,F.dayTextureSplit[L]=n.splitDirection,Me=Me||0!==F.dayTextureSplit[L];let o=F.dayTextureCutoutRectangles[L];if(Object(p["a"])(o)||(o=F.dayTextureCutoutRectangles[L]=new s["a"]),s["a"].clone(s["a"].ZERO,o),Object(p["a"])(n.cutoutRectangle)){const e=de(oe,n.cutoutRectangle),t=D["a"].simpleIntersection(e,oe,se);Be=Object(p["a"])(t)||Be,o.x=(e.west-oe.west)*ce,o.y=(e.south-oe.south)*le,o.z=(e.east-oe.west)*ce,o.w=(e.north-oe.south)*le}let c=F.colorsToAlpha[L];Object(p["a"])(c)||(c=F.colorsToAlpha[L]=new s["a"]);const u=Object(p["a"])(n.colorToAlpha)&&n.colorToAlphaThreshold>0;if(He=He||u,u){const e=n.colorToAlpha;c.x=e.red,c.y=e.green,c.z=e.blue,c.w=n.colorToAlphaThreshold}else c.w=-1;if(Object(p["a"])(a.credits)){const e=a.credits;for(let t=0,a=e.length;t<a;++t)i.addCredit(e[t])}++L}F.dayTextures.length=L,F.waterMask=l,s["a"].clone(h,F.waterMaskTranslationAndScale),F.minMaxHeight.x=te.minimumHeight,F.minMaxHeight.y=te.maximumHeight,C["a"].clone(te.matrix,F.scaleAndBias);const Ge=e._clippingPlanes,Ye=Object(p["a"])(Ge)&&Ge.enabled&&t.isClipped;Ye&&(F.clippingPlanesEdgeColor=d["a"].clone(Ge.edgeColor,F.clippingPlanesEdgeColor),F.clippingPlanesEdgeWidth=Ge.edgeWidth),Ae.numberOfDayTextures=L,Ae.applyBrightness=_e,Ae.applyContrast=Te,Ae.applyHue=Oe,Ae.applySaturation=Ce,Ae.applyGamma=De,Ae.applyAlpha=Re,Ae.applyDayNightAlpha=Ie,Ae.applySplit=Me,Ae.enableFog=ge,Ae.enableClippingPlanes=Ye,Ae.clippingPlanes=Ge,Ae.hasImageryLayerCutout=Be,Ae.colorCorrect=K,Ae.highlightFillTile=j,Ae.colorToAlpha=He,Ae.showUndergroundColor=R,Ae.translucent=y;let qe=n.renderedMesh.indices.length;xe||(qe=n.renderedMesh.indexCountWithoutSkirts),c.shaderProgram=e._surfaceShaderSet.getShaderProgram(Ae),c.castShadows=V,c.receiveShadows=G,c.renderState=Ue,c.primitiveType=x["a"].TRIANGLES,c.vertexArray=n.vertexArray||n.fill.vertexArray,c.count=qe,c.uniformMap=f,c.pass=B["a"].GLOBE,e._debug.wireframe&&(Le(Ve,e,t),Object(p["a"])(n.wireframeVertexArray)&&(c.vertexArray=n.wireframeVertexArray,c.primitiveType=x["a"].LINES,c.count=2*qe));let ze=c.boundingVolume;const We=c.orientedBoundingBox;a.mode!==X["a"].SCENE3D?(r["a"].fromRectangleWithHeights2D(t.rectangle,a.mapProjection,ae.minimumHeight,ae.maximumHeight,ze),o["a"].fromElements(ze.center.z,ze.center.x,ze.center.y,ze.center),a.mode===X["a"].MORPHING&&(ze=r["a"].union(ae.boundingSphere,ze,ze))):(c.boundingVolume=r["a"].clone(ae.boundingSphere,ze),c.orientedBoundingBox=E["a"].clone(ae.boundingVolume,We)),c.dirty=!0,y&&_.updateDerivedCommands(c,a),ie(c,a),Ue=Fe,ke=je}while(Ee<Se)}t["a"]=ae},dd89:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a("ae9b"),n=a("1a5d"),i=a("61ad"),o=a("c937"),s=a("a3b5"),c=a("e22f"),u=a("dc50"),d=a("816c");function l(e){e=Object(n["a"])(e,n["a"].EMPTY_OBJECT);const t=e.resourceCache,a=e.gltf,o=e.bufferViewId,c=e.gltfResource,u=e.baseResource,l=e.cacheKey;r["a"].typeOf.func("options.resourceCache",t),r["a"].typeOf.object("options.gltf",a),r["a"].typeOf.number("options.bufferViewId",o),r["a"].typeOf.object("options.gltfResource",c),r["a"].typeOf.object("options.baseResource",u);const h=a.bufferViews[o];let f,p,m,g,_=h.buffer,y=h.byteOffset,b=h.byteLength,T=!1;if(Object(s["a"])(h,"EXT_meshopt_compression")){const e=h.extensions.EXT_meshopt_compression;_=e.buffer,y=Object(n["a"])(e.byteOffset,0),b=e.byteLength,T=!0,f=e.byteStride,p=e.count,m=e.mode,g=Object(n["a"])(e.filter,"NONE")}const A=a.buffers[_];this._hasMeshopt=T,this._meshoptByteStride=f,this._meshoptCount=p,this._meshoptMode=m,this._meshoptFilter=g,this._resourceCache=t,this._gltfResource=c,this._baseResource=u,this._buffer=A,this._bufferId=_,this._byteOffset=y,this._byteLength=b,this._cacheKey=l,this._bufferLoader=void 0,this._typedArray=void 0,this._state=d["a"].UNLOADED,this._promise=Object(i["a"])()}function h(e){const t=e._resourceCache,a=e._buffer;if(Object(o["a"])(a.uri)){const r=e._baseResource,n=r.getDerivedResource({url:a.uri});return t.loadExternalBuffer({resource:n})}return t.loadEmbeddedBuffer({parentResource:e._gltfResource,bufferId:e._bufferId})}Object(o["a"])(Object.create)&&(l.prototype=Object.create(u["a"].prototype),l.prototype.constructor=l),Object.defineProperties(l.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),l.prototype.load=function(){const e=h(this);this._bufferLoader=e,this._state=d["a"].LOADING;const t=this;e.promise.then((function(){if(t.isDestroyed())return;const a=e.typedArray,r=new Uint8Array(a.buffer,a.byteOffset+t._byteOffset,t._byteLength);t.unload(),t._typedArray=r,t._hasMeshopt?t._state=d["a"].PROCESSING:(t._state=d["a"].READY,t._promise.resolve(t))})).catch((function(e){if(t.isDestroyed())return;t.unload(),t._state=d["a"].FAILED;const a="Failed to load buffer view";t._promise.reject(t.getError(a,e))}))},l.prototype.process=function(e){if(r["a"].typeOf.object("frameState",e),!this._hasMeshopt)return;if(!Object(o["a"])(this._typedArray))return;if(this._state!==d["a"].PROCESSING)return;const t=this._meshoptCount,a=this._meshoptByteStride,n=new Uint8Array(t*a);c["a"].decodeGltfBuffer(n,t,a,this._typedArray,this._meshoptMode,this._meshoptFilter),this._typedArray=n,this._state=d["a"].READY,this._promise.resolve(this)},l.prototype.unload=function(){Object(o["a"])(this._bufferLoader)&&this._resourceCache.unload(this._bufferLoader),this._bufferLoader=void 0,this._typedArray=void 0}}}]);