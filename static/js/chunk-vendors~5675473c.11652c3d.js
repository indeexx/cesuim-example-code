(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~5675473c"],{"0950":function(e,t,a){"use strict";function n(){this.pass=void 0,this.alphaMode=void 0,this.alphaCutoff=void 0}a.d(t,"a",(function(){return n}))},"1f82":function(e,t,a){"use strict";var n=a("2fad"),o=a("c937"),i=a("d430"),r=a("1197"),s=a("5ef1");const c={name:"ImageBasedLightingPipelineStage",process:function(e,t,a){const c=t.imageBasedLighting,u=e.shaderBuilder;if(u.addDefine("USE_IBL_LIGHTING",void 0,r["a"].FRAGMENT),u.addUniform("vec2","model_iblFactor",r["a"].FRAGMENT),s["a"].isSupported(a.context)){const e=c.useSphericalHarmonics||c.useSpecularEnvironmentMaps||c.enabled;e&&u.addUniform("mat3","model_iblReferenceFrameMatrix",r["a"].FRAGMENT),Object(o["a"])(c.sphericalHarmonicCoefficients)?(u.addDefine("DIFFUSE_IBL",void 0,r["a"].FRAGMENT),u.addDefine("CUSTOM_SPHERICAL_HARMONICS",void 0,r["a"].FRAGMENT),u.addUniform("vec3","model_sphericalHarmonicCoefficients[9]",r["a"].FRAGMENT)):c.useDefaultSphericalHarmonics&&u.addDefine("DIFFUSE_IBL",void 0,r["a"].FRAGMENT),Object(o["a"])(c.specularEnvironmentMapAtlas)&&c.specularEnvironmentMapAtlas.ready?(u.addDefine("SPECULAR_IBL",void 0,r["a"].FRAGMENT),u.addDefine("CUSTOM_SPECULAR_IBL",void 0,r["a"].FRAGMENT),u.addUniform("sampler2D","model_specularEnvironmentMaps",r["a"].FRAGMENT),u.addUniform("vec2","model_specularEnvironmentMapsSize",r["a"].FRAGMENT),u.addUniform("float","model_specularEnvironmentMapsMaximumLOD",r["a"].FRAGMENT)):t.useDefaultSpecularMaps&&u.addDefine("SPECULAR_IBL",void 0,r["a"].FRAGMENT)}Object(o["a"])(c.luminanceAtZenith)&&(u.addDefine("USE_SUN_LUMINANCE",void 0,r["a"].FRAGMENT),u.addUniform("float","model_luminanceAtZenith",r["a"].FRAGMENT)),u.addFragmentLines([i["a"]]);const d={model_iblFactor:function(){return c.imageBasedLightingFactor},model_iblReferenceFrameMatrix:function(){return t._iblReferenceFrameMatrix},model_luminanceAtZenith:function(){return c.luminanceAtZenith},model_sphericalHarmonicCoefficients:function(){return c.sphericalHarmonicCoefficients},model_specularEnvironmentMaps:function(){return c.specularEnvironmentMapAtlas.texture},model_specularEnvironmentMapsSize:function(){return c.specularEnvironmentMapAtlas.texture.dimensions},model_specularEnvironmentMapsMaximumLOD:function(){return c.specularEnvironmentMapAtlas.maximumMipmapLevel}};e.uniformMap=Object(n["a"])(d,e.uniformMap)}};t["a"]=c},"28e7":function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a("2013"),o=a("0b24"),i=a("ae9b"),r=a("4051"),s=a("c937"),c=a("21b7"),u=a("98d8"),d=a("1a5d"),l=a("3c3d"),f=a("8676");function p(e){const t=e.model,a=e.propertyTable;i["a"].typeOf.object("propertyTable",a),i["a"].typeOf.object("model",t),this._propertyTable=a,this._model=t,this._features=void 0,this._featuresLength=0,this._batchTexture=void 0,this._styleCommandsNeededDirty=!1,this._styleCommandsNeeded=l["a"].ALL_OPAQUE,h(this)}function h(e){const t=e._model,a=f["a"].is3DTiles(t.type),i=e._propertyTable.count;if(0===i)return;let r;const s=new Array(i);if(a){const e=t.content;for(r=0;r<i;r++)s[r]=new o["a"](e,r)}else for(r=0;r<i;r++)s[r]=new u["a"]({model:t,featureId:r,featureTable:e});e._features=s,e._featuresLength=i,e._batchTexture=new n["a"]({featuresLength:i,owner:e,statistics:a?t.content.tileset.statistics:e._statistics})}Object.defineProperties(p.prototype,{batchTexture:{get:function(){return this._batchTexture}},featuresLength:{get:function(){return this._featuresLength}},styleCommandsNeededDirty:{get:function(){return this._styleCommandsNeededDirty}}}),p.prototype.update=function(e){this._styleCommandsNeededDirty=!1,this._batchTexture.update(void 0,e);const t=l["a"].getStyleCommandsNeeded(this._featuresLength,this._batchTexture.translucentFeaturesLength);this._styleCommandsNeeded!==t&&(this._styleCommandsNeededDirty=!0,this._styleCommandsNeeded=t)},p.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)},p.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)},p.prototype.getShow=function(e){return this._batchTexture.getShow(e)},p.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)},p.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)},p.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)},p.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)},p.prototype.getFeature=function(e){return this._features[e]},p.prototype.hasProperty=function(e,t){return this._propertyTable.hasProperty(e,t)},p.prototype.hasPropertyBySemantic=function(e,t){return this._propertyTable.hasPropertyBySemantic(e,t)},p.prototype.getProperty=function(e,t){return this._propertyTable.getProperty(e,t)},p.prototype.getPropertyBySemantic=function(e,t){return this._propertyTable.getPropertyBySemantic(e,t)},p.prototype.getPropertyNames=function(e){return this._propertyTable.getPropertyIds(e)},p.prototype.setProperty=function(e,t,a){return this._propertyTable.setProperty(e,t,a)};const m=new r["a"];p.prototype.applyStyle=function(e){if(!Object(s["a"])(e))return this.setAllColor(n["a"].DEFAULT_COLOR_VALUE),void this.setAllShow(n["a"].DEFAULT_SHOW_VALUE);for(let t=0;t<this._featuresLength;t++){const a=this.getFeature(t),o=Object(s["a"])(e.color)?Object(d["a"])(e.color.evaluateColor(a,m),n["a"].DEFAULT_COLOR_VALUE):n["a"].DEFAULT_COLOR_VALUE,i=Object(s["a"])(e.show)?Object(d["a"])(e.show.evaluate(a),n["a"].DEFAULT_SHOW_VALUE):n["a"].DEFAULT_SHOW_VALUE;this.setColor(t,o),this.setShow(t,i)}},p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(e){this._batchTexture.destroy(),Object(c["a"])(this)}},"2e1e":function(e,t,a){"use strict";const n={UNLIT:0,PBR:1};t["a"]=Object.freeze(n)},"3de6":function(e,t,a){"use strict";var n=a("2fad"),o=a("05a3"),i=a("1197");const r={name:"ModelSplitterPipelineStage",SPLIT_DIRECTION_UNIFORM_NAME:"model_splitDirection",process:function(e,t,a){const s=e.shaderBuilder;s.addDefine("HAS_MODEL_SPLITTER",void 0,i["a"].FRAGMENT),s.addFragmentLines([o["a"]]);const c={};s.addUniform("float",r.SPLIT_DIRECTION_UNIFORM_NAME,i["a"].FRAGMENT),c[r.SPLIT_DIRECTION_UNIFORM_NAME]=function(){return t.splitDirection},e.uniformMap=Object(n["a"])(c,e.uniformMap)}};t["a"]=r},"4bc5":function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a("6d72"),o=a("8656"),i=a("ae9b"),r=a("44e9"),s=a("1a5d"),c=a("c937"),u=a("1f82"),d=a("722e"),l=a("df33"),f=a("b39e"),p=a("9e66"),h=a("7c8c"),m=a("d2b6"),_=a("3de6"),b=a("51d2"),T=a("5263"),g=a("5027"),y=a("ff3a"),A=a("66a6"),O=a("a57b");function I(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT),i["a"].typeOf.object("options.model",e.model),i["a"].typeOf.object("options.modelComponents",e.modelComponents),this._model=e.model,this._modelComponents=e.modelComponents,this._pipelineStages=[],this._updateStages=[],this._runtimeNodes=[],this._rootNodes=[],this._drawCommands=[],this.modelPipelineStages=[],this._boundingSphere=void 0,this._computedModelMatrix=d["a"].clone(d["a"].IDENTITY),S(this)}function S(e){const t=e._modelComponents,a=t.scene,n=e._model;e._computedModelMatrix=d["a"].multiplyTransformation(n.modelMatrix,t.transform,e._computedModelMatrix),e._computedModelMatrix=h["a"].correctModelMatrix(e._computedModelMatrix,t.upAxis,t.forwardAxis,e._computedModelMatrix),e._computedModelMatrix=d["a"].multiplyByUniformScale(e._computedModelMatrix,n.computedScale,e._computedModelMatrix);const o=a.nodes,i=d["a"].IDENTITY;for(let r=0;r<o.length;r++){const t=a.nodes[r],n=E(e,t,i);e._rootNodes.push(n)}}function E(e,t,a){const n=[],o=h["a"].getNodeTransform(t);let i;if(Object(c["a"])(t.children))for(i=0;i<t.children.length;i++){const r=t.children[i],s=d["a"].multiplyTransformation(a,o,new d["a"]),c=E(e,r,s);n.push(c)}const r=new p["a"]({node:t,transform:o,transformToRoot:a,children:n,sceneGraph:e});if(Object(c["a"])(t.primitives))for(i=0;i<t.primitives.length;i++)r.runtimePrimitives.push(new f["a"]({primitive:t.primitives[i],node:t,model:e._model}));return e._runtimeNodes.push(r),e._runtimeNodes.length-1}function M(e,t){for(let a=0;a<e._runtimeNodes.length;a++){const n=e._runtimeNodes[a];for(let e=0;e<n.runtimePrimitives.length;e++){const a=n.runtimePrimitives[e];t(a)}}}Object.defineProperties(I.prototype,{components:{get:function(){return this._modelComponents}},computedModelMatrix:{get:function(){return this._computedModelMatrix}},boundingSphere:{get:function(){return this._boundingSphere}}}),I.prototype.buildDrawCommands=function(e){const t=this._model,a=new m["a"](t);this.configurePipeline();const i=this.modelPipelineStages;let r,s,c;for(r=0;r<i.length;r++){const n=i[r];n.process(a,t,e)}const u=[];for(r=0;r<this._runtimeNodes.length;r++){const t=this._runtimeNodes[r];t.configurePipeline();const i=t.pipelineStages,d=new b["a"](a,t);for(s=0;s<i.length;s++){const a=i[s];a.process(d,t.node,e)}for(s=0;s<t.runtimePrimitives.length;s++){const a=t.runtimePrimitives[s];a.configurePipeline();const i=a.pipelineStages,r=new T["a"](d,a);for(c=0;c<i.length;c++){const t=i[c];t.process(r,a.primitive,e)}a.boundingSphere=o["a"].clone(r.boundingSphere),u.push(a.boundingSphere);const l=Object(n["a"])(r,e);a.drawCommands=l}}this._boundingSphere=o["a"].fromBoundingSpheres(u),t._boundingSphere=o["a"].transform(this._boundingSphere,t.modelMatrix,t._boundingSphere),t._initialRadius=t._boundingSphere.radius,t._boundingSphere.radius*=t._clampedScale},I.prototype.configurePipeline=function(){const e=this.modelPipelineStages;e.length=0;const t=this._model;Object(c["a"])(t.color)&&e.push(l["a"]),t.imageBasedLighting.enabled&&e.push(u["a"]),t.isClippingEnabled()&&e.push(O["a"]),Object(c["a"])(t.splitDirection)&&t.splitDirection!==A["a"].NONE&&e.push(_["a"])},I.prototype.update=function(e){let t,a,n;for(t=0;t<this._runtimeNodes.length;t++){const o=this._runtimeNodes[t];for(a=0;a<o.updateStages.length;a++){const t=o.updateStages[a];t.update(o,this,e)}for(a=0;a<o.runtimePrimitives.length;a++){const e=o.runtimePrimitives[a];for(n=0;n<e.updateStages.length;n++){const t=e.updateStages[n];t.update(e)}}}},I.prototype.updateModelMatrix=function(){const e=this._model;this._computedModelMatrix=d["a"].multiplyTransformation(e.modelMatrix,this._modelComponents.transform,this._computedModelMatrix),this._computedModelMatrix=h["a"].correctModelMatrix(this._computedModelMatrix,this._modelComponents.upAxis,this._modelComponents.forwardAxis,this._computedModelMatrix),this._computedModelMatrix=d["a"].multiplyByUniformScale(this._computedModelMatrix,e.computedScale,this._computedModelMatrix);const t=this._rootNodes;for(let a=0;a<t.length;a++){const e=this._runtimeNodes[t[a]];e._transformDirty=!0}},I.prototype.updateBackFaceCulling=function(e){const t=this._model;M(this,(function(a){for(let n=0;n<a.drawCommands.length;n++){const o=a.drawCommands[n],i=Object(r["a"])(o.renderState,!0),s=a.primitive.material.doubleSided,u=Object(c["a"])(t.color)&&t.color.alpha<1;i.cull.enabled=e&&!s&&!u,o.renderState=g["a"].fromCache(i)}}))},I.prototype.updateShadows=function(e){const t=this._model,a=y["a"].castShadows(t.shadows),n=y["a"].receiveShadows(t.shadows);M(this,(function(e){for(let t=0;t<e.drawCommands.length;t++){const o=e.drawCommands[t];o.castShadows=a,o.receiveShadows=n}}))},I.prototype.getDrawCommands=function(){const e=[];return M(this,(function(t){e.push.apply(e,t.drawCommands)})),e}},"4c10":function(e,t,a){"use strict";var n=a("8656"),o=a("c937"),i=a("722e");const r={};function s(e,t,a){let r,c;const u=i["a"].multiplyTransformation(a,e.transform,new i["a"]);for(r=0;r<e.runtimePrimitives.length;r++){const a=e.runtimePrimitives[r];for(c=0;c<a.drawCommands.length;c++){const e=a.drawCommands[c];e.modelMatrix=i["a"].multiplyTransformation(t._computedModelMatrix,u,e.modelMatrix),e.boundingVolume=n["a"].transform(a.boundingSphere,e.modelMatrix,e.boundingVolume)}}if(Object(o["a"])(e.children))for(r=0;r<e.children.length;r++){const a=t._runtimeNodes[e.children[r]];a._transformToRoot=i["a"].clone(u,a._transformToRoot),s(a,t,u),a._transformDirty=!1}}r.name="ModelMatrixUpdateStage",r.update=function(e,t,a){e._transformDirty&&(s(e,t,e.transformToRoot),e._transformDirty=!1)},t["a"]=r},"51d2":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("ae9b"),o=a("44e9"),i=a("722e");function r(e,t){n["a"].typeOf.object("modelRenderResources",e),n["a"].typeOf.object("runtimeNode",t),this.model=e.model,this.shaderBuilder=e.shaderBuilder.clone(),this.uniformMap=Object(o["a"])(e.uniformMap),this.alphaOptions=Object(o["a"])(e.alphaOptions),this.renderStateOptions=Object(o["a"])(e.renderStateOptions),this.runtimeNode=t,this.transform=i["a"].multiplyTransformation(t.transformToRoot,t.transform,new i["a"]),this.attributes=[],this.attributeIndex=1,this.featureIdVertexAttributeSetIndex=0,this.instanceCount=0,this.instancingTranslationMax=void 0,this.instancingTranslationMin=void 0}},"63a1":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a("77df"),o=a("4051"),i=a("2fad"),r=a("c937"),s=a("21b7"),c=a("51f2"),u=a("c38c");function d(e,t,a){this._tileset=e,this._tile=t,this._resource=a,this._model=void 0,this._metadata=void 0,this._group=void 0}function l(e,t,a,o){const r={cull:!1,releaseGltfJson:!0,opaquePass:c["a"].CESIUM_3D_TILE,modelMatrix:t.computedTransform,upAxis:e._gltfUpAxis,forwardAxis:n["a"].X,incrementallyLoadTextures:!1,customShader:e.customShader,content:a,show:e.show,colorBlendMode:e.colorBlendMode,colorBlendAmount:e.colorBlendAmount,lightColor:e.lightColor,imageBasedLighting:e.imageBasedLighting,featureIdLabel:e.featureIdLabel,instanceFeatureIdLabel:e.instanceFeatureIdLabel,pointCloudShading:e.pointCloudShading,clippingPlanes:e.clippingPlanes,backFaceCulling:e.backFaceCulling,shadows:e.shadows,showCreditsOnScreen:e.showCreditsOnScreen,splitDirection:e.splitDirection};return Object(i["a"])(o,r)}Object.defineProperties(d.prototype,{featuresLength:{get:function(){const e=this._model,t=e.featureTables,a=e.featureTableId;return Object(r["a"])(t)&&Object(r["a"])(t[a])?t[a].featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){const e=this._model,t=e.featureTables,a=e.featureTableId;if(Object(r["a"])(t)&&Object(r["a"])(t[a]))return t[a]}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),d.prototype.getFeature=function(e){const t=this._model,a=t.featureTableId;if(!Object(r["a"])(a))return;const n=t.featureTables[a];return n.getFeature(e)},d.prototype.hasProperty=function(e,t){const a=this._model,n=a.featureTableId;if(!Object(r["a"])(n))return!1;const o=a.featureTables[n];return o.hasProperty(e,t)},d.prototype.applyDebugSettings=function(e,t){t=e?t:o["a"].WHITE,0===this.featuresLength?this._model.color=t:Object(r["a"])(this.batchTable)&&this.batchTable.setAllColor(t)},d.prototype.applyStyle=function(e){this._model.style=e},d.prototype.update=function(e,t){const a=this._model,n=this._tile;a.colorBlendAmount=e.colorBlendAmount,a.colorBlendMode=e.colorBlendMode,a.modelMatrix=n.computedTransform,a.customShader=e.customShader,a.pointCloudShading=e.pointCloudShading,a.featureIdLabel=e.featureIdLabel,a.instanceFeatureIdLabel=e.instanceFeatureIdLabel,a.lightColor=e.lightColor,a.imageBasedLighting=e.imageBasedLighting,a.backFaceCulling=e.backFaceCulling,a.shadows=e.shadows,a.showCreditsOnScreen=e.showCreditsOnScreen,a.splitDirection=e.splitDirection;const o=e.clippingPlanes;a.referenceMatrix=e.clippingPlanesOriginMatrix,Object(r["a"])(o)&&n.clippingPlanesDirty&&(a._clippingPlanes=o.enabled&&n._isClipped?o:void 0),Object(r["a"])(o)&&Object(r["a"])(a._clippingPlanes)&&a._clippingPlanes!==o&&(a._clippingPlanes=o),a.update(t)},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),Object(s["a"])(this)},d.fromGltf=function(e,t,a,n){const o=new d(e,t,a),i={gltf:n,basePath:a},r=l(e,t,o,i);return o._model=u["a"].fromGltf(r),o},d.fromB3dm=function(e,t,a,n,o){const i=new d(e,t,a),r={arrayBuffer:n,byteOffset:o,resource:a},s=l(e,t,i,r);return i._model=u["a"].fromB3dm(s),i},d.fromI3dm=function(e,t,a,n,o){const i=new d(e,t,a),r={arrayBuffer:n,byteOffset:o,resource:a},s=l(e,t,i,r);return i._model=u["a"].fromI3dm(s),i},d.fromPnts=function(e,t,a,n,o){const i=new d(e,t,a),r={arrayBuffer:n,byteOffset:o,resource:a},s=l(e,t,i,r);return i._model=u["a"].fromPnts(s),i}},"68eb":function(e,t,a){"use strict";var n=a("c937"),o=a("1a5d"),i=a("1197"),r=a("8574"),s=a("2e1e"),c=a("6b5d"),u=a("51f2"),d=a("d767"),l=a("dde0"),f=a("6b82"),p=a("afe9"),h=a("5f79"),m=a("7c8c");const _=p["a"].Material,b=p["a"].MetallicRoughness,T=p["a"].SpecularGlossiness,g={};function y(e,t,a,n,o){const r=`HAS_${o}_TEXTURE_TRANSFORM`;e.addDefine(r,void 0,i["a"].FRAGMENT);const s=n+"Transform";e.addUniform("mat3",s,i["a"].FRAGMENT),t[s]=function(){return a.transform}}function A(e,t,a,r,s,c){e.addUniform("sampler2D",r,i["a"].FRAGMENT),t[r]=function(){return Object(o["a"])(a.texture,c)};const u=`HAS_${s}_TEXTURE`;e.addDefine(u,void 0,i["a"].FRAGMENT);const l=a.texCoord,f="v_texCoord_"+l,p="TEXCOORD_"+s;e.addDefine(p,f,i["a"].FRAGMENT);const h=a.transform;Object(n["a"])(h)&&!d["a"].equals(h,d["a"].IDENTITY)&&y(e,t,a,r,s)}function O(e,t,a,o,r,s){const c=e.emissiveTexture;Object(n["a"])(c)&&A(a,t,c,"u_emissiveTexture","EMISSIVE",s);const u=e.emissiveFactor;Object(n["a"])(u)&&!l["a"].equals(u,_.DEFAULT_EMISSIVE_FACTOR)&&(a.addUniform("vec3","u_emissiveFactor",i["a"].FRAGMENT),t.u_emissiveFactor=function(){return e.emissiveFactor},a.addDefine("HAS_EMISSIVE_FACTOR",void 0,i["a"].FRAGMENT));const d=e.normalTexture;Object(n["a"])(d)&&A(a,t,d,"u_normalTexture","NORMAL",r);const f=e.occlusionTexture;Object(n["a"])(f)&&A(a,t,f,"u_occlusionTexture","OCCLUSION",o)}function I(e,t,a,o){const r=e.specularGlossiness;a.addDefine("USE_SPECULAR_GLOSSINESS",void 0,i["a"].FRAGMENT);const s=r.diffuseTexture;Object(n["a"])(s)&&A(a,t,s,"u_diffuseTexture","DIFFUSE",o);const c=r.diffuseFactor;Object(n["a"])(c)&&!f["a"].equals(c,T.DEFAULT_DIFFUSE_FACTOR)&&(a.addUniform("vec4","u_diffuseFactor",i["a"].FRAGMENT),t.u_diffuseFactor=function(){return r.diffuseFactor},a.addDefine("HAS_DIFFUSE_FACTOR",void 0,i["a"].FRAGMENT));const u=r.specularGlossinessTexture;Object(n["a"])(u)&&A(a,t,u,"u_specularGlossinessTexture","SPECULAR_GLOSSINESS",o);const d=r.specularFactor;Object(n["a"])(d)&&!l["a"].equals(d,T.DEFAULT_SPECULAR_FACTOR)&&(a.addUniform("vec3","u_specularFactor",i["a"].FRAGMENT),t.u_specularFactor=function(){return r.specularFactor},a.addDefine("HAS_SPECULAR_FACTOR",void 0,i["a"].FRAGMENT));const p=r.glossinessFactor;Object(n["a"])(p)&&p!==T.DEFAULT_GLOSSINESS_FACTOR&&(a.addUniform("float","u_glossinessFactor",i["a"].FRAGMENT),t.u_glossinessFactor=function(){return r.glossinessFactor},a.addDefine("HAS_GLOSSINESS_FACTOR",void 0,i["a"].FRAGMENT))}function S(e,t,a,o){const r=e.metallicRoughness;a.addDefine("USE_METALLIC_ROUGHNESS",void 0,i["a"].FRAGMENT);const s=r.baseColorTexture;Object(n["a"])(s)&&A(a,t,s,"u_baseColorTexture","BASE_COLOR",o);const c=r.baseColorFactor;Object(n["a"])(c)&&!f["a"].equals(c,b.DEFAULT_BASE_COLOR_FACTOR)&&(a.addUniform("vec4","u_baseColorFactor",i["a"].FRAGMENT),t.u_baseColorFactor=function(){return r.baseColorFactor},a.addDefine("HAS_BASE_COLOR_FACTOR",void 0,i["a"].FRAGMENT));const u=r.metallicRoughnessTexture;Object(n["a"])(u)&&A(a,t,u,"u_metallicRoughnessTexture","METALLIC_ROUGHNESS",o);const d=r.metallicFactor;Object(n["a"])(d)&&d!==b.DEFAULT_METALLIC_FACTOR&&(a.addUniform("float","u_metallicFactor",i["a"].FRAGMENT),t.u_metallicFactor=function(){return r.metallicFactor},a.addDefine("HAS_METALLIC_FACTOR",void 0,i["a"].FRAGMENT));const l=r.roughnessFactor;Object(n["a"])(l)&&l!==b.DEFAULT_ROUGHNESS_FACTOR&&(a.addUniform("float","u_roughnessFactor",i["a"].FRAGMENT),t.u_roughnessFactor=function(){return r.roughnessFactor},a.addDefine("HAS_ROUGHNESS_FACTOR",void 0,i["a"].FRAGMENT))}g.name="MaterialPipelineStage",g.process=function(e,t,a){const o=t.material,i=e.uniformMap,d=e.shaderBuilder,l=a.context.defaultTexture,f=a.context.defaultNormalTexture,p=a.context.defaultEmissiveTexture;O(o,i,d,l,f,p),Object(n["a"])(o.specularGlossiness)?I(o,i,d,l):S(o,i,d,l);const _=m["a"].getAttributeBySemantic(t,h["a"].NORMAL),b=e.lightingOptions;o.unlit||!_?b.lightingModel=s["a"].UNLIT:b.lightingModel=s["a"].PBR;const T=e.model,g=T.backFaceCulling&&!o.doubleSided,y=Object(n["a"])(T.color)&&T.color.alpha<1;e.renderStateOptions.cull={enabled:g&&!y};const A=e.alphaOptions;Object(n["a"])(A.alphaMode)||(A.alphaMode=o.alphaMode,o.alphaMode===r["a"].BLEND?A.pass=u["a"].TRANSLUCENT:o.alphaMode===r["a"].MASK&&(A.alphaCutoff=o.alphaCutoff)),d.addFragmentLines([c["a"]])},g._processTexture=A,g._processTextureTransform=y,t["a"]=g},"7c8c":function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a("8656"),o=a("dde0"),i=a("c937"),r=a("722e"),s=a("1b9c"),c=a("e2aa"),u=a("77df"),d=a("c380"),l=a("5f79");function f(){}f.getFailedLoadFunction=function(e,t,a){return function(n){let o=`Failed to load ${t}: ${a}`;Object(i["a"])(n)&&(o+="\n"+n.message),e._readyPromise.reject(new c["a"](o))}},f.getNodeTransform=function(e){return Object(i["a"])(e.matrix)?e.matrix:r["a"].fromTranslationQuaternionRotationScale(Object(i["a"])(e.translation)?e.translation:o["a"].ZERO,Object(i["a"])(e.rotation)?e.rotation:s["a"].IDENTITY,Object(i["a"])(e.scale)?e.scale:o["a"].ONE)},f.getAttributeBySemantic=function(e,t,a){const n=e.attributes,o=n.length;for(let r=0;r<o;++r){const e=n[r],o=!Object(i["a"])(a)||e.setIndex===a;if(e.semantic===t&&o)return e}},f.getAttributeByName=function(e,t){const a=e.attributes,n=a.length;for(let o=0;o<n;++o){const e=a[o];if(e.name===t)return e}},f.getFeatureIdsByLabel=function(e,t){for(let a=0;a<e.length;a++){const n=e[a];if(n.positionalLabel===t||n.label===t)return n}},f.hasQuantizedAttributes=function(e){if(!Object(i["a"])(e))return!1;for(let t=0;t<e.length;t++){const a=e[t];if(Object(i["a"])(a.quantization))return!0}return!1},f.getAttributeInfo=function(e){const t=e.semantic,a=e.setIndex;let n,o=!1;Object(i["a"])(t)?(n=l["a"].getVariableName(t,a),o=!0):(n=e.name,n=n.replace(/^_/,""),n=n.toLowerCase());const r=/^color_\d+$/.test(n),s=e.type;let c=d["a"].getGlslType(s);r&&(c="vec4");const u=Object(i["a"])(e.quantization);let f;return u&&(f=r?"vec4":d["a"].getGlslType(e.quantization.type)),{attribute:e,isQuantized:u,variableName:n,hasSemantic:o,glslType:c,quantizedGlslType:f}};const p=new o["a"],h=new o["a"];f.createBoundingSphere=function(e,t,a,r){const s=f.getAttributeBySemantic(e,"POSITION"),c=s.max,u=s.min;let d;if(Object(i["a"])(a)&&Object(i["a"])(r)){const e=o["a"].add(u,r,h),t=o["a"].add(c,a,p);d=n["a"].fromCornerPoints(e,t)}else d=n["a"].fromCornerPoints(u,c);return n["a"].transform(d,t,d),d},f.correctModelMatrix=function(e,t,a,n){return n=r["a"].clone(e,n),t===u["a"].Y?n=r["a"].multiplyTransformation(e,u["a"].Y_UP_TO_Z_UP,n):t===u["a"].X&&(n=r["a"].multiplyTransformation(e,u["a"].X_UP_TO_Z_UP,n)),a===u["a"].Z&&(n=r["a"].multiplyTransformation(n,u["a"].Z_UP_TO_X_UP,n)),n}},8676:function(e,t,a){"use strict";var n=a("ae9b"),o=a("e2a6");const i={GLTF:"GLTF",TILE_GLTF:"TILE_GLTF",TILE_B3DM:"B3DM",TILE_I3DM:"I3DM",TILE_PNTS:"PNTS",is3DTiles:function(e){switch(n["a"].typeOf.string("modelType",e),e){case i.TILE_GLTF:case i.TILE_B3DM:case i.TILE_I3DM:case i.TILE_PNTS:return!0;case i.GLTF:return!1;default:throw new o["a"]("modelType is not a valid value.")}}};t["a"]=Object.freeze(i)},8725:function(e,t,a){"use strict";var n=a("c937"),o=a("1197"),i=a("adea"),r=a("2e1e");const s={name:"LightingPipelineStage",process:function(e,t){const a=e.model,s=e.lightingOptions,c=e.shaderBuilder;if(Object(n["a"])(a.lightColor)){c.addDefine("USE_CUSTOM_LIGHT_COLOR",void 0,o["a"].FRAGMENT),c.addUniform("vec3","model_lightColorHdr",o["a"].FRAGMENT);const t=e.uniformMap;t.model_lightColorHdr=function(){return a.lightColor}}const u=s.lightingModel;u===r["a"].PBR?c.addDefine("LIGHTING_PBR",void 0,o["a"].FRAGMENT):c.addDefine("LIGHTING_UNLIT",void 0,o["a"].FRAGMENT),c.addFragmentLines([i["a"]])}};t["a"]=s},"94c6":function(e,t,a){"use strict";var n=a("6f54"),o=a("6ba7"),i=a("4051"),r=a("cbf0"),s=a("1a5d"),c=a("c937"),u=a("1197"),d=a("8676"),l=a("7c8c");const f={};function p(e,t){const a=e.model,n={model:a,node:e.runtimeNode,primitive:e.runtimePrimitive};let o;if(d["a"].is3DTiles(a.type)){const e=a.content;o={content:e,primitive:e.tileset,detail:n}}else o={primitive:a,detail:n};return Object(c["a"])(t)&&(o.instanceId=t),o}function h(e,t,a){const n=e.model;let o,i;const r=n.featureIdLabel,d=n.instanceFeatureIdLabel;Object(c["a"])(n.featureTableId)?o=n.featureTableId:Object(c["a"])(a)?(i=l["a"].getFeatureIdsByLabel(a.featureIds,d),o=i.propertyTableId):(i=l["a"].getFeatureIdsByLabel(t.featureIds,r),o=i.propertyTableId);const f=n.featureTables[o],p=e.shaderBuilder;p.addUniform("sampler2D","model_pickTexture",u["a"].FRAGMENT);const h=f.batchTexture;e.uniformMap.model_pickTexture=function(){return Object(s["a"])(h.pickTexture,h.defaultTexture)},e.pickId="((selectedFeature.id < int(model_featuresLength)) ? texture2D(model_pickTexture, selectedFeature.st) : vec4(0.0))"}function m(e,t,a){const s=e.instanceCount,c=new Array(s),d=new Uint8Array(4*s),l=e.model,f=l._resources;for(let n=0;n<s;n++){const t=p(e,n),o=a.createPickId(t);f.push(o),c[n]=o;const r=o.color;d[4*n+0]=i["a"].floatToByte(r.red),d[4*n+1]=i["a"].floatToByte(r.green),d[4*n+2]=i["a"].floatToByte(r.blue),d[4*n+3]=i["a"].floatToByte(r.alpha)}const h=n["a"].createVertexBuffer({context:a,typedArray:d,usage:o["a"].STATIC_DRAW});h.vertexArrayDestroyable=!1,f.push(h);const m={index:e.attributeIndex++,vertexBuffer:h,componentsPerAttribute:4,componentDatatype:r["a"].UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};e.attributes.push(m);const _=e.shaderBuilder;_.addDefine("USE_PICKING",void 0,u["a"].BOTH),_.addAttribute("vec4","a_pickColor"),_.addVarying("vec4","v_pickColor"),e.pickId="v_pickColor"}f.name="PickingPipelineStage",f.process=function(e,t,a){const n=a.context,o=e.runtimeNode,i=e.shaderBuilder,r=e.model,s=o.node.instances;if(e.hasPropertyTable)h(e,t,s,n);else if(Object(c["a"])(s))m(e,s,n);else{const t=p(e),a=n.createPickId(t);r._resources.push(a),i.addUniform("vec4","czm_pickColor",u["a"].FRAGMENT);const o=e.uniformMap;o.czm_pickColor=function(){return a.color},e.pickId="czm_pickColor"}},t["a"]=f},"98d8":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("4051"),o=a("c937");function i(e){this._model=e.model,this._featureTable=e.featureTable,this._featureId=e.featureId,this._color=void 0}Object.defineProperties(i.prototype,{show:{get:function(){return this._featureTable.getShow(this._featureId)},set:function(e){this._featureTable.setShow(this._featureId,e)}},color:{get:function(){return Object(o["a"])(this._color)||(this._color=new n["a"]),this._featureTable.getColor(this._featureId,this._color)},set:function(e){this._featureTable.setColor(this._featureId,e)}},primitive:{get:function(){return this._model}},featureTable:{get:function(){return this._featureTable}},featureId:{get:function(){return this._featureId}}}),i.prototype.hasProperty=function(e){return this._featureTable.hasProperty(this._featureId,e)},i.prototype.getProperty=function(e){return this._featureTable.getProperty(this._featureId,e)},i.prototype.getPropertyInherited=function(e){return this._featureTable.hasPropertyBySemantic(this._featureId,e)?this._featureTable.getPropertyBySemantic(this._featureId,e):this._featureTable.getProperty(this._featureId,e)},i.prototype.getPropertyNames=function(e){return this._featureTable.getPropertyNames(e)},i.prototype.setProperty=function(e,t){return this._featureTable.setProperty(this._featureId,e,t)}},"99b6":function(e,t,a){"use strict";var n=a("dde0"),o=a("cbf0"),i=a("c937"),r=a("722e"),s=a("c380"),c=a("1b9c"),u=a("6f54"),d=a("6ba7"),l=a("dbf6"),f=a("7c8c"),p=a("3b5b"),h=a("2828"),m=a("346e"),_=a("1197");const b=new r["a"],T={name:"InstancingPipelineStage",process:function(e,t,a){const n=t.instances,o=n.attributes[0].count;let c=[];const u=e.model.sceneGraph,d=e.shaderBuilder;d.addDefine("HAS_INSTANCING"),d.addVertexLines([p["a"]]);const T=f["a"].getAttributeBySemantic(n,l["a"].TRANSLATION);let g,y;Object(i["a"])(T)&&(g=T.max,y=T.min);const A=f["a"].getAttributeBySemantic(n,l["a"].ROTATION);if(!Object(i["a"])(A)&&Object(i["a"])(g)&&Object(i["a"])(y)){Object(i["a"])(T)&&(c.push({index:e.attributeIndex++,vertexBuffer:T.buffer,componentsPerAttribute:s["a"].getNumberOfComponents(T.type),componentDatatype:T.componentDatatype,normalize:!1,offsetInBytes:T.byteOffset,strideInBytes:T.byteStride,instanceDivisor:1}),e.instancingTranslationMax=g,e.instancingTranslationMin=y,d.addDefine("HAS_INSTANCE_TRANSLATION"),d.addAttribute("vec3","a_instanceTranslation"));const t=f["a"].getAttributeBySemantic(n,l["a"].SCALE);Object(i["a"])(t)&&(c.push({index:e.attributeIndex++,vertexBuffer:t.buffer,componentsPerAttribute:s["a"].getNumberOfComponents(t.type),componentDatatype:t.componentDatatype,normalize:!1,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,instanceDivisor:1}),d.addDefine("HAS_INSTANCE_SCALE"),d.addAttribute("vec3","a_instanceScale"))}else c=E(t,o,e,a);if(S(e,a,n,c),n.transformInWorldSpace){const t=e.uniformMap;d.addDefine("USE_LEGACY_INSTANCING",void 0,_["a"].VERTEX),d.addUniform("mat4","u_instance_modifiedModelView",_["a"].VERTEX),d.addUniform("mat4","u_instance_nodeTransform",_["a"].VERTEX),t.u_instance_modifiedModelView=function(){return r["a"].multiply(a.context.uniformState.view,u.components.transform,b)},t.u_instance_nodeTransform=function(){return e.runtimeNode.axisCorrectedTransform},d.addVertexLines([m["a"]])}else d.addVertexLines([h["a"]]);e.instanceCount=o,e.attributes.push.apply(e.attributes,c)}},g=new n["a"],y=new c["a"],A=new n["a"],O=new r["a"];function I(e,t,a){const o=12,s=new Float32Array(t*o),u=f["a"].getAttributeBySemantic(e,l["a"].TRANSLATION),d=f["a"].getAttributeBySemantic(e,l["a"].ROTATION),p=f["a"].getAttributeBySemantic(e,l["a"].SCALE),h=new n["a"](-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),m=new n["a"](Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),_=Object(i["a"])(u),b=Object(i["a"])(d),T=Object(i["a"])(p),I=_?u.packedTypedArray:new Float32Array(3*t),S=b?d.packedTypedArray:new Float32Array(4*t);let E;T?E=p.packedTypedArray:(E=new Float32Array(3*t),E.fill(1));for(let i=0;i<t;i++){const e=new n["a"](I[3*i],I[3*i+1],I[3*i+2],g);n["a"].maximumByComponent(h,e,h),n["a"].minimumByComponent(m,e,m);const t=new c["a"](S[4*i],S[4*i+1],S[4*i+2],b?S[4*i+3]:1,y),u=new n["a"](E[3*i],E[3*i+1],E[3*i+2],A),d=r["a"].fromTranslationQuaternionRotationScale(e,t,u,O),l=o*i;s[l+0]=d[0],s[l+1]=d[4],s[l+2]=d[8],s[l+3]=d[12],s[l+4]=d[1],s[l+5]=d[5],s[l+6]=d[9],s[l+7]=d[13],s[l+8]=d[2],s[l+9]=d[6],s[l+10]=d[10],s[l+11]=d[14],a.instancingTranslationMax=h,a.instancingTranslationMin=m}return s}function S(e,t,a,n){const o=a.attributes,i=e.model,r=e.shaderBuilder;for(let c=0;c<o.length;c++){const a=o[c];if(a.semantic!==l["a"].FEATURE_ID)continue;a.setIndex>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=a.setIndex+1);const f=u["a"].createVertexBuffer({context:t.context,typedArray:a.packedTypedArray,usage:d["a"].STATIC_DRAW});f.vertexArrayDestroyable=!1,i._resources.push(f),n.push({index:e.attributeIndex++,vertexBuffer:f,componentsPerAttribute:s["a"].getNumberOfComponents(a.type),componentDatatype:a.componentDatatype,normalize:!1,offsetInBytes:a.byteOffset,strideInBytes:a.byteStride,instanceDivisor:1}),r.addAttribute("float","a_instanceFeatureId_"+a.setIndex)}}function E(e,t,a,n){const i=I(e.instances,t,a),r=u["a"].createVertexBuffer({context:n.context,typedArray:i,usage:d["a"].STATIC_DRAW});r.vertexArrayDestroyable=!1,a.model._resources.push(r);const s=12,c=o["a"].getSizeInBytes(o["a"].FLOAT),l=c*s,f=[{index:a.attributeIndex++,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:l,instanceDivisor:1},{index:a.attributeIndex++,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,normalize:!1,offsetInBytes:4*c,strideInBytes:l,instanceDivisor:1},{index:a.attributeIndex++,vertexBuffer:r,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,normalize:!1,offsetInBytes:8*c,strideInBytes:l,instanceDivisor:1}],p=a.shaderBuilder;return p.addDefine("HAS_INSTANCE_MATRICES"),p.addAttribute("vec4","a_instancingTransformRow0"),p.addAttribute("vec4","a_instancingTransformRow1"),p.addAttribute("vec4","a_instancingTransformRow2"),f}T._getInstanceTransformsTypedArray=I,t["a"]=T},"9e66":function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a("ae9b"),o=a("1a5d"),i=a("c937"),r=a("e2a6"),s=a("722e"),c=a("99b6"),u=a("4c10"),d=a("7c8c");function l(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT),n["a"].typeOf.object("options.node",e.node),n["a"].typeOf.object("options.transform",e.transform),n["a"].typeOf.object("options.transformToRoot",e.transformToRoot),n["a"].typeOf.object("options.sceneGraph",e.sceneGraph),n["a"].typeOf.object("options.children",e.children);const t=e.sceneGraph,a=e.transform,i=e.transformToRoot;this._sceneGraph=t,this._children=e.children,this._node=e.node;const r=t.components;this._transform=s["a"].clone(a,this._transform),this._transformToRoot=s["a"].clone(i,this._transformToRoot),this._originalTransform=s["a"].clone(a,this._originalTransform),this._axisCorrectedTransform=d["a"].correctModelMatrix(a,r.upAxis,r.forwardAxis,this._axisCorrectedTransform),this._transformDirty=!1,this.pipelineStages=[],this.runtimePrimitives=[],this.updateStages=[],this.configurePipeline()}Object.defineProperties(l.prototype,{node:{get:function(){return this._node}},sceneGraph:{get:function(){return this._sceneGraph}},children:{get:function(){return this._children}},transform:{get:function(){return this._transform},set:function(e){s["a"].equals(this._transform,e)||(this._transformDirty=!0,this._transform=s["a"].clone(e,this._transform),this._axisCorrectedTransform=d["a"].correctModelMatrix(e,this._sceneGraph.components.upAxis,this._sceneGraph.components.forwardAxis,this._axisCorrectedTransform))}},transformToRoot:{get:function(){return this._transformToRoot}},axisCorrectedTransform:{get:function(){return this._axisCorrectedTransform}},originalTransform:{get:function(){return this._originalTransform}}}),l.prototype.getChild=function(e){if(n["a"].typeOf.number("index",e),e<0||e>=this.children.length)throw new r["a"]("index must be greater than or equal to 0 and less than the number of children.");return this.sceneGraph.runtimeNodes[this.children[e]]},l.prototype.configurePipeline=function(){const e=this.node,t=this.pipelineStages;t.length=0;const a=this.updateStages;a.length=0,Object(i["a"])(e.instances)&&t.push(c["a"]),a.push(u["a"])}},a57b:function(e,t,a){"use strict";var n=a("85b2"),o=a("bd5e"),i=a("2fad"),r=a("4051"),s=a("5340"),c=a("1197");const u={name:"ModelClippingPlanesPipelineStage"},d=new n["a"];u.process=function(e,t,a){const n=t.clippingPlanes,u=a.context,l=e.shaderBuilder;l.addDefine("HAS_CLIPPING_PLANES",void 0,c["a"].FRAGMENT),l.addDefine("CLIPPING_PLANES_LENGTH",n.length,c["a"].FRAGMENT),n.unionClippingRegions&&l.addDefine("UNION_CLIPPING_REGIONS",void 0,c["a"].FRAGMENT),o["a"].useFloatTexture(u)&&l.addDefine("USE_CLIPPING_PLANES_FLOAT_TEXTURE",void 0,c["a"].FRAGMENT);const f=o["a"].getTextureResolution(n,u,d);l.addDefine("CLIPPING_PLANES_TEXTURE_WIDTH",f.x,c["a"].FRAGMENT),l.addDefine("CLIPPING_PLANES_TEXTURE_HEIGHT",f.y,c["a"].FRAGMENT),l.addUniform("sampler2D","model_clippingPlanes",c["a"].FRAGMENT),l.addUniform("vec4","model_clippingPlanesEdgeStyle",c["a"].FRAGMENT),l.addUniform("mat4","model_clippingPlanesMatrix",c["a"].FRAGMENT),l.addFragmentLines([s["a"]]);const p={model_clippingPlanes:function(){return n.texture},model_clippingPlanesEdgeStyle:function(){const e=r["a"].clone(n.edgeColor);return e.alpha=n.edgeWidth,e},model_clippingPlanesMatrix:function(){return t._clippingPlanesMatrix}};e.uniformMap=Object(i["a"])(p,e.uniformMap)},t["a"]=u},b39e:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a("ae9b"),o=a("1a5d"),i=a("c937"),r=a("82ba"),s=a("fa44"),c=a("53fc"),u=a("84d0"),d=a("915b"),l=a("37ce"),f=a("de2e"),p=a("3a30d"),h=a("8771"),m=a("8725"),_=a("68eb"),b=a("cf18"),T=a("7c8c"),g=a("94c6"),y=a("06e9"),A=a("9206");function O(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT),n["a"].typeOf.object("options.primitive",e.primitive),n["a"].typeOf.object("options.node",e.node),n["a"].typeOf.object("options.model",e.model),this.primitive=e.primitive,this.node=e.node,this.model=e.model,this.pipelineStages=[],this.drawCommands=[],this.boundingSphere=void 0,this.updateStages=[],this.configurePipeline()}function I(e,t,a){let n;return Object(i["a"])(t.instances)&&(n=T["a"].getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),Object(i["a"])(n))?{hasFeatureIds:!0,hasPropertyTable:Object(i["a"])(n.propertyTableId)}:(n=T["a"].getFeatureIdsByLabel(a.featureIds,e.featureIdLabel),Object(i["a"])(n)?{hasFeatureIds:!0,hasPropertyTable:Object(i["a"])(n.propertyTableId)}:{hasFeatureIds:!1,hasPropertyTable:!1})}O.prototype.configurePipeline=function(){const e=this.pipelineStages;e.length=0;const t=this.primitive,a=this.node,n=this.model,o=n.customShader,O=Object(i["a"])(o),S=O&&Object(i["a"])(o.fragmentShaderText),E=!S||o.mode!==u["a"].REPLACE_MATERIAL,M=T["a"].hasQuantizedAttributes(t.attributes),C=n.pointCloudShading,L=Object(i["a"])(C)&&C.attenuation,N=I(n,a,t);e.push(h["a"]),L&&t.primitiveType===r["a"].POINTS&&e.push(y["a"]),M&&e.push(p["a"]),E&&e.push(_["a"]),e.push(l["a"]),e.push(b["a"]),N.hasPropertyTable&&(e.push(A["a"]),e.push(c["a"]),e.push(f["a"])),O&&e.push(d["a"]),e.push(m["a"]),n.allowPicking&&e.push(g["a"]),e.push(s["a"])}},c38c:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a("8656"),o=a("dde0"),i=a("ae9b"),r=a("ce1c"),s=a("bd5e"),c=a("c937"),u=a("61ad"),d=a("1a5d"),l=a("e2a6"),f=a("f729"),p=a("a1a1"),h=a("4bc5"),m=a("8676"),_=a("7c8c"),b=a("51f2"),T=a("9f38"),g=a("21b7"),y=a("d767"),A=a("722e"),O=a("28e7"),I=a("2519"),S=a("bdab"),E=a("caf3"),M=a("4051"),C=a("d765"),L=a("ff3a"),N=a("66a6");function x(e){e=Object(d["a"])(e,d["a"].EMPTY_OBJECT),i["a"].typeOf.object("options.loader",e.loader),i["a"].typeOf.object("options.resource",e.resource),this._loader=e.loader,this._resource=e.resource,this.type=Object(d["a"])(e.type,m["a"].GLTF),this.modelMatrix=A["a"].clone(Object(d["a"])(e.modelMatrix,A["a"].IDENTITY)),this._modelMatrix=A["a"].clone(this.modelMatrix),this._scale=Object(d["a"])(e.scale,1),this._minimumPixelSize=Object(d["a"])(e.minimumPixelSize,0),this._maximumScale=e.maximumScale,this._clampedScale=Object(c["a"])(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._computedScale=this._clampedScale,this._updateModelMatrix=!1,this.referenceMatrix=void 0,this._iblReferenceFrameMatrix=y["a"].clone(y["a"].IDENTITY),this._resourcesLoaded=!1,this._drawCommandsBuilt=!1,this._ready=!1,this._readyPromise=Object(u["a"])(),this._customShader=e.customShader,this._content=e.content,this._texturesLoaded=!1,this._defaultTexture=void 0;const t=e.color;this._color=Object(d["a"])(t)?M["a"].clone(t):void 0,this._colorBlendMode=Object(d["a"])(e.colorBlendMode,r["a"].HIGHLIGHT),this._colorBlendAmount=Object(d["a"])(e.colorBlendAmount,.5),this._cull=Object(d["a"])(e.cull,!0),this._opaquePass=Object(d["a"])(e.opaquePass,b["a"].OPAQUE),this._allowPicking=Object(d["a"])(e.allowPicking,!0),this._show=Object(d["a"])(e.show,!0),this._style=void 0;let a=Object(d["a"])(e.featureIdLabel,"featureId_0");"number"===typeof a&&(a="featureId_"+a),this._featureIdLabel=a;let l=Object(d["a"])(e.instanceFeatureIdLabel,"instanceFeatureId_0");"number"===typeof l&&(l="instanceFeatureId_"+l),this._instanceFeatureIdLabel=l,this._featureTables=[],this._featureTableId=void 0,this._featureTableIdDirty=!0,this._resources=[],this._boundingSphere=new n["a"],this._initialRadius=void 0;const f=new I["a"](e.pointCloudShading);this._attenuation=f.attenuation,this._pointCloudShading=f;const h=e.clippingPlanes;Object(c["a"])(h)&&void 0===h.owner?s["a"].setOwner(h,this,"_clippingPlanes"):this._clippingPlanes=h,this._clippingPlanesState=0,this._clippingPlanesMatrix=A["a"].clone(A["a"].IDENTITY),this._lightColor=o["a"].clone(e.lightColor),this._imageBasedLighting=Object(c["a"])(e.imageBasedLighting)?e.imageBasedLighting:new p["a"],this._shouldDestroyImageBasedLighting=!Object(c["a"])(e.imageBasedLighting),this._backFaceCulling=Object(d["a"])(e.backFaceCulling,!0),this._backFaceCullingDirty=!1,this._shadows=Object(d["a"])(e.shadows,L["a"].ENABLED),this._shadowsDirty=!1,this._debugShowBoundingVolumeDirty=!1,this._debugShowBoundingVolume=Object(d["a"])(e.debugShowBoundingVolume,!1),this._showCreditsOnScreen=Object(d["a"])(e.showCreditsOnScreen,!1),this._splitDirection=Object(d["a"])(e.splitDirection,N["a"].NONE),R(this)}function D(e,t){const a=e._featureTables,n=t.propertyTables;for(let o=0;o<n.length;o++){const t=n[o],i=new O["a"]({model:e,propertyTable:t});a.push(i)}return a}function F(e,t){const a=t._featureIdLabel,n=t._instanceFeatureIdLabel;let o,i,r,s;for(o=0;o<e.nodes.length;o++)if(s=e.nodes[o],Object(c["a"])(s.instances)&&(r=_["a"].getFeatureIdsByLabel(s.instances.featureIds,n),Object(c["a"])(r)&&Object(c["a"])(r.propertyTableId)))return r.propertyTableId;for(o=0;o<e.nodes.length;o++)for(s=e.nodes[o],i=0;i<s.primitives.length;i++){const e=s.primitives[i],t=_["a"].getFeatureIdsByLabel(e.featureIds,a);if(Object(c["a"])(t))return t.propertyTableId}}function R(e){const t=e._loader,a=e._resource;t.load(),t.promise.then((function(t){const a=t.components,n=a.structuralMetadata;Object(c["a"])(n)&&n.propertyTableCount>0&&D(e,n),e._sceneGraph=new h["a"]({model:e,modelComponents:a}),e._resourcesLoaded=!0})).catch(_["a"].getFailedLoadFunction(e,"model",a));const n=Object(d["a"])(t.texturesLoadedPromise,Promise.resolve());n.then((function(){e._texturesLoaded=!0})).catch(_["a"].getFailedLoadFunction(e,"model",a))}Object.defineProperties(x.prototype,{ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},loader:{get:function(){return this._loader}},cull:{get:function(){return this._cull}},opaquePass:{get:function(){return this._opaquePass}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){i["a"].defined("pointCloudShading",e),e!==this._pointCloudShading&&this.resetDrawCommands(),this._pointCloudShading=e}},customShader:{get:function(){return this._customShader},set:function(e){e!==this._customShader&&this.resetDrawCommands(),this._customShader=e}},sceneGraph:{get:function(){return this._sceneGraph}},content:{get:function(){return this._content}},structuralMetadata:{get:function(){return this._sceneGraph.components.structuralMetadata}},featureTableId:{get:function(){return this._featureTableId},set:function(e){this._featureTableId=e}},featureTables:{get:function(){return this._featureTables},set:function(e){this._featureTables=e}},allowPicking:{get:function(){return this._allowPicking}},style:{get:function(){return this._style},set:function(e){e!==this._style&&this.applyStyle(e),this._style=e}},color:{get:function(){return this._color},set:function(e){M["a"].equals(this._color,e)||this.resetDrawCommands(),this._color=M["a"].clone(e,this._color)}},colorBlendMode:{get:function(){return this._colorBlendMode},set:function(e){this._colorBlendMode=e}},colorBlendAmount:{get:function(){return this._colorBlendAmount},set:function(e){this._colorBlendAmount=e}},boundingSphere:{get:function(){if(!this._ready)throw new l["a"]("The model is not loaded. Use ModelExperimental.readyPromise or wait for ModelExperimental.ready to be true.");return this._boundingSphere}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolumeDirty=!0),this._debugShowBoundingVolume=e}},show:{get:function(){return this._show},set:function(e){this._show=e}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){"number"===typeof e&&(e="featureId_"+e),i["a"].typeOf.string("value",e),e!==this._featureIdLabel&&(this._featureTableIdDirty=!0),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){"number"===typeof e&&(e="instanceFeatureId_"+e),i["a"].typeOf.string("value",e),e!==this._instanceFeatureIdLabel&&(this._featureTableIdDirty=!0),this._instanceFeatureIdLabel=e}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&(s["a"].setOwner(e,this,"_clippingPlanes"),this.resetDrawCommands())}},lightColor:{get:function(){return this._lightColor},set:function(e){Object(c["a"])(e)!==Object(c["a"])(this._lightColor)&&this.resetDrawCommands(),this._lightColor=o["a"].clone(e,this._lightColor)}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){i["a"].typeOf.object("imageBasedLighting",this._imageBasedLighting),e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this.resetDrawCommands())}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){e!==this._backFaceCulling&&(this._backFaceCullingDirty=!0),this._backFaceCulling=e}},scale:{get:function(){return this._scale},set:function(e){e!==this._scale&&(this._updateModelMatrix=!0),this._scale=e}},computedScale:{get:function(){return this._computedScale}},minimumPixelSize:{get:function(){return this._minimumPixelSize},set:function(e){e!==this._minimumPixelSize&&(this._updateModelMatrix=!0),this._minimumPixelSize=e}},maximumScale:{get:function(){return this._maximumScale},set:function(e){e!==this._maximumScale&&(this._updateModelMatrix=!0),this._maximumScale=e}},shadows:{get:function(){return this._shadows},set:function(e){e!==this._shadows&&(this._shadowsDirty=!0),this._shadows=e}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen=e}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&this.resetDrawCommands(),this._splitDirection=e}}}),x.prototype.resetDrawCommands=function(){this._drawCommandsBuilt&&(this.destroyResources(),this._drawCommandsBuilt=!1)};const P=new A["a"],w=new y["a"],j=new A["a"];function B(e){const t=e._sceneGraph.components,a=t.structuralMetadata;Object(c["a"])(a)&&a.propertyTableCount>0&&(e.featureTableId=F(t,e),e.applyStyle(e._style))}x.prototype.update=function(e){this._resourcesLoaded&&this._texturesLoaded||this._loader.process(e),Object(c["a"])(this._customShader)&&this._customShader.update(e),this.pointCloudShading.attenuation!==this._attenuation&&(this.resetDrawCommands(),this._attenuation=this.pointCloudShading.attenuation);const t=e.context,a=Object(d["a"])(this.referenceMatrix,this.modelMatrix);if(this._imageBasedLighting.update(e),this._imageBasedLighting.useSphericalHarmonicCoefficients||this._imageBasedLighting.useSpecularEnvironmentMaps){let e=w,n=P;n=A["a"].multiply(t.uniformState.view3D,a,n),e=A["a"].getMatrix3(n,e),e=y["a"].getRotation(e,e),this._iblReferenceFrameMatrix=y["a"].transpose(e,this._iblReferenceFrameMatrix)}this._imageBasedLighting.shouldRegenerateShaders&&this.resetDrawCommands();let o=0;if(this.isClippingEnabled()){this._clippingPlanes.owner===this&&this._clippingPlanes.update(e);let n=j;n=A["a"].multiply(t.uniformState.view3D,a,n),n=A["a"].multiply(n,this._clippingPlanes.modelMatrix,n),this._clippingPlanesMatrix=A["a"].inverseTranspose(n,this._clippingPlanesMatrix),o=this._clippingPlanes.clippingPlanesState}if(o!==this._clippingPlanesState&&(this.resetDrawCommands(),this._clippingPlanesState=o),this._defaultTexture=t.defaultTexture,!this._resourcesLoaded)return;this._featureTableIdDirty&&(B(this),this._featureTableIdDirty=!1);const i=this._featureTables;for(let n=0;n<i.length;n++)i[n].update(e),i[n].styleCommandsNeededDirty&&this.resetDrawCommands();if(!this._drawCommandsBuilt){this._sceneGraph.buildDrawCommands(e),this._drawCommandsBuilt=!0;const t=this;if(!t._ready)return void e.afterRender.push((function(){t._ready=!0,t._readyPromise.resolve(t)}))}if(this._debugShowBoundingVolumeDirty&&(z(this._sceneGraph,this._debugShowBoundingVolume),this._debugShowBoundingVolumeDirty=!1),A["a"].equals(this.modelMatrix,this._modelMatrix)||(this._updateModelMatrix=!0,this._modelMatrix=A["a"].clone(this.modelMatrix,this._modelMatrix),this._boundingSphere=n["a"].transform(this._sceneGraph.boundingSphere,this.modelMatrix,this._boundingSphere)),(this._updateModelMatrix||0!==this._minimumPixelSize)&&(this._clampedScale=Object(c["a"])(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._boundingSphere.radius=this._initialRadius*this._clampedScale,this._computedScale=V(this,e),this._sceneGraph.updateModelMatrix(),this._updateModelMatrix=!1),this._backFaceCullingDirty&&(this.sceneGraph.updateBackFaceCulling(this._backFaceCulling),this._backFaceCullingDirty=!1),this._shadowsDirty&&(this.sceneGraph.updateShadows(this._shadows),this._shadowsDirty=!1),this._sceneGraph.update(e),this._show&&0!==this._computedScale){const t=this._sceneGraph.components.asset,a=t.credits,n=a.length;for(let i=0;i<n;i++){const t=a[i];t.showOnScreen=this._showCreditsOnScreen,e.creditDisplay.addCredit(t)}const o=this._sceneGraph.getDrawCommands();e.commandList.push.apply(e.commandList,o)}};const v=new n["a"];function G(e,t,a){return v.center=e,v.radius=t,a.camera.getPixelSize(v,a.context.drawingBufferWidth,a.context.drawingBufferHeight)}const U=new o["a"];function V(e,t){let a=e.scale;if(0!==e.minimumPixelSize){const n=t.context,o=Math.max(n.drawingBufferWidth,n.drawingBufferHeight),i=e.modelMatrix;U.x=i[12],U.y=i[13],U.z=i[14];const r=e.boundingSphere.radius,s=G(U,r,t),c=1/s,u=Math.min(c*(2*r),o);u<e.minimumPixelSize&&(a=e.minimumPixelSize*s/(2*e._initialRadius))}return Object(c["a"])(e.maximumScale)?Math.min(e.maximumScale,a):a}function z(e,t){const a=e._drawCommands;for(let n=0;n<a.length;n++)a[n].debugShowBoundingVolume=t}function k(e,t,a){return{loader:e,type:t,resource:a.resource,modelMatrix:a.modelMatrix,scale:a.scale,minimumPixelSize:a.minimumPixelSize,maximumScale:a.maximumScale,debugShowBoundingVolume:a.debugShowBoundingVolume,cull:a.cull,opaquePass:a.opaquePass,allowPicking:a.allowPicking,customShader:a.customShader,content:a.content,show:a.show,color:a.color,colorBlendAmount:a.colorBlendAmount,colorBlendMode:a.colorBlendMode,featureIdLabel:a.featureIdLabel,instanceFeatureIdLabel:a.instanceFeatureIdLabel,pointCloudShading:a.pointCloudShading,clippingPlanes:a.clippingPlanes,lightColor:a.lightColor,imageBasedLighting:a.imageBasedLighting,backFaceCulling:a.backFaceCulling,shadows:a.shadows,showCreditsOnScreen:a.showCreditsOnScreen,splitDirection:a.splitDirection}}x.prototype.isClippingEnabled=function(){const e=this._clippingPlanes;return Object(c["a"])(e)&&e.enabled&&0!==e.length},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){const e=this._loader;Object(c["a"])(e)&&e.destroy();const t=this._featureTables;if(Object(c["a"])(t))for(let n=0;n<t.length;n++)t[n].destroy();this.destroyResources();const a=this._clippingPlanes;Object(c["a"])(a)&&!a.isDestroyed()&&a.owner===this&&a.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,Object(g["a"])(this)},x.prototype.destroyResources=function(){const e=this._resources;for(let t=0;t<e.length;t++)e[t].destroy();this._resources=[]},x.fromGltf=function(e){e=Object(d["a"])(e,d["a"].EMPTY_OBJECT),i["a"].defined("options.gltf",e.gltf);const t={releaseGltfJson:e.releaseGltfJson,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis},a=e.gltf,n=Object(d["a"])(e.basePath,""),o=T["a"].createIfNeeded(n);Object(c["a"])(a.asset)?(t.gltfJson=a,t.baseResource=o,t.gltfResource=o):a instanceof Uint8Array?(t.typedArray=a,t.baseResource=o,t.gltfResource=o):t.gltfResource=T["a"].createIfNeeded(e.gltf);const r=new f["a"](t),s=Object(c["a"])(e.content),u=s?m["a"].TILE_GLTF:m["a"].GLTF,l=k(r,u,e);l.resource=t.gltfResource;const p=new x(l);return p},x.fromB3dm=function(e){const t={b3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis},a=new S["a"](t),n=k(a,m["a"].TILE_B3DM,e),o=new x(n);return o},x.fromPnts=function(e){const t={arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset},a=new E["a"](t),n=k(a,m["a"].TILE_PNTS,e),o=new x(n);return o},x.fromI3dm=function(e){const t={i3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis},a=new C["a"](t),n=k(a,m["a"].TILE_I3DM,e),o=new x(n);return o},x.prototype.applyColorAndShow=function(e){const t=Object(c["a"])(e)&&Object(c["a"])(e.color),a=Object(c["a"])(e)&&Object(c["a"])(e.show);this._color=t?e.color.evaluateColor(void 0,this._color):M["a"].clone(M["a"].WHITE,this._color),this._show=!a||e.show.evaluate(void 0)},x.prototype.applyStyle=function(e){if(Object(c["a"])(this.featureTableId)&&this.featureTables[this.featureTableId].featuresLength>0){const t=this.featureTables[this.featureTableId];t.applyStyle(e)}else this.applyColorAndShow(e);this.resetDrawCommands()}},caf3:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a("cf26"),o=a("dde0"),i=a("4051"),r=a("ae9b"),s=a("cbf0"),c=a("1a5d"),u=a("61ad"),d=a("c937"),l=a("722e"),f=a("82ba"),p=a("3c000"),h=a("6f54"),m=a("6ba7"),_=a("8574"),b=a("c380"),T=a("77df"),g=a("1901"),y=a("5618"),A=a("2323"),O=a("dc50"),I=a("aac0"),S=a("afe9"),E=a("2a6d"),M=a("13e9"),C=a("816c"),L=a("5f79");const N=S["a"].Components,x=S["a"].Scene,D=S["a"].Node,F=S["a"].Primitive,R=S["a"].Attribute,P=S["a"].Quantization,w=S["a"].FeatureIdAttribute,j=S["a"].Material,B=S["a"].MetallicRoughness;function v(e){e=Object(c["a"])(e,c["a"].EMPTY_OBJECT);const t=e.arrayBuffer,a=Object(c["a"])(e.byteOffset,0);r["a"].typeOf.object("options.arrayBuffer",t),this._arrayBuffer=t,this._byteOffset=a,this._parsedContent=void 0,this._decodePromise=void 0,this._decodedAttributes=void 0,this._promise=Object(u["a"])(),this._state=C["a"].UNLOADED,this._buffers=[],this._components=void 0,this._transform=l["a"].IDENTITY}function G(e,t){const a=e._parsedContent,n=a.draco;let o;o=Object(d["a"])(n)?y["a"].decodePointCloud(n,t):Promise.resolve(),Object(d["a"])(o)&&(e._decodePromise=o,o.then((function(a){e.isDestroyed()||(Object(d["a"])(a)&&U(e,n,a),W(e,t),e._state=C["a"].READY,e._promise.resolve(e))})).catch((function(t){e.unload(),e._state=C["a"].FAILED;const a="Failed to load Draco";e._promise.reject(e.getError(a,t))})))}function U(e,t,a){e._state=C["a"].READY;const n=e._parsedContent;let i;if(Object(d["a"])(a.POSITION)){if(i={name:"POSITION",semantic:L["a"].POSITION,typedArray:a.POSITION.array,componentDatatype:s["a"].FLOAT,type:b["a"].VEC3,isQuantized:!1},Object(d["a"])(a.POSITION.data.quantization)){const e=a.POSITION.data.quantization,t=e.range,n=o["a"].fromElements(t,t,t),r=o["a"].unpack(e.minValues),c=(1<<e.quantizationBits)-1;i.isQuantized=!0,i.quantizedRange=c,i.quantizedVolumeOffset=r,i.quantizedVolumeScale=n,i.quantizedComponentDatatype=s["a"].UNSIGNED_SHORT,i.quantizedType=b["a"].VEC3}n.positions=i}if(Object(d["a"])(a.NORMAL)){if(i={name:"NORMAL",semantic:L["a"].NORMAL,typedArray:a.NORMAL.array,componentDatatype:s["a"].FLOAT,type:b["a"].VEC3,isQuantized:!1,octEncoded:!1,octEncodedZXY:!1},Object(d["a"])(a.NORMAL.data.quantization)){const e=(1<<a.NORMAL.data.quantization.quantizationBits)-1;i.quantizedRange=e,i.octEncoded=!0,i.octEncodedZXY=!0,i.quantizedComponentDatatype=s["a"].UNSIGNED_BYTE,i.quantizedType=b["a"].VEC2}n.normals=i}if(Object(d["a"])(a.RGBA)?n.colors={name:"COLOR",semantic:L["a"].COLOR,setIndex:0,typedArray:a.RGBA.array,componentDatatype:s["a"].UNSIGNED_BYTE,type:b["a"].VEC4,normalized:!0,isTranslucent:!0}:Object(d["a"])(a.RGB)&&(n.colors={name:"COLOR",semantic:L["a"].COLOR,setIndex:0,typedArray:a.RGB.array,componentDatatype:s["a"].UNSIGNED_BYTE,type:b["a"].VEC3,normalized:!0,isTranslucent:!1}),Object(d["a"])(a.BATCH_ID)){const e=a.BATCH_ID.array;n.batchIds={name:"_FEATURE_ID",semantic:L["a"].FEATURE_ID,setIndex:0,typedArray:e,componentDatatype:s["a"].fromTypedArray(e),type:b["a"].SCALAR}}let r=n.styleableProperties;const c=t.batchTableProperties;for(const o in c)if(c.hasOwnProperty(o)){const e=a[o];Object(d["a"])(r)||(r={}),r[o]={typedArray:e.array,componentCount:e.data.componentsPerAttribute}}n.styleableProperties=r}function V(e,t,a){let r,s=t.typedArray;if(t.octEncoded&&(r=new P,r.octEncoded=t.octEncoded,r.octEncodedZXY=t.octEncodedZXY,r.normalizationRange=t.quantizedRange,r.type=t.quantizedType,r.componentDatatype=t.quantizedComponentDatatype),t.isQuantized){r=new P;const e=t.quantizedRange;r.normalizationRange=e,r.quantizedVolumeOffset=o["a"].ZERO;const a=t.quantizedVolumeScale;r.quantizedVolumeDimensions=a,r.quantizedVolumeStepSize=o["a"].divideByScalar(a,e,new o["a"]),r.componentDatatype=t.quantizedComponentDatatype,r.type=t.quantizedType}const u=new R;if(u.name=t.name,u.semantic=t.semantic,u.setIndex=t.setIndex,u.componentDatatype=t.componentDatatype,u.type=t.type,u.normalized=Object(c["a"])(t.normalized,!1),u.min=t.min,u.max=t.max,u.quantization=r,t.isRGB565&&(s=n["a"].decodeRGB565(s)),Object(d["a"])(t.constantColor)){const e=new Array(4);u.constant=i["a"].pack(t.constantColor,e)}else{const t=h["a"].createVertexBuffer({typedArray:s,context:a,usage:m["a"].STATIC_DRAW});t.vertexArrayDestroyable=!1,e._buffers.push(t),u.buffer=t}return u}let z,k;function H(e){if(!Object(d["a"])(k)){z=new p["a"](0),k=new Array(e);for(let t=0;t<e;++t)k[t]=z.random()}return k}Object(d["a"])(Object.create)&&(v.prototype=Object.create(O["a"].prototype),v.prototype.constructor=v),Object.defineProperties(v.prototype,{promise:{get:function(){return this._promise.promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}},transform:{get:function(){return this._transform}}}),v.prototype.load=function(){this._parsedContent=E["a"].parse(this._arrayBuffer,this._byteOffset),this._state=C["a"].PROCESSING},v.prototype.process=function(e){this._state===C["a"].PROCESSING&&(Object(d["a"])(this._decodePromise)||G(this,e.context))};const q=new o["a"],Y=new o["a"],Z=new o["a"];function X(e){const t=e.typedArray,a=20,n=t.length/3,i=Math.min(n,a),r=H(a),s=Number.MAX_VALUE,c=-Number.MAX_VALUE;let u,d,l,f=o["a"].fromElements(s,s,s,q),p=o["a"].fromElements(c,c,c,Y);if(e.isQuantized)f=o["a"].ZERO,p=e.quantizedVolumeScale;else for(u=0;u<i;++u)d=Math.floor(r[u]*n),l=o["a"].unpack(t,3*d,Z),o["a"].minimumByComponent(f,l,f),o["a"].maximumByComponent(p,l,p);e.min=o["a"].clone(f),e.max=o["a"].clone(p)}const J={name:L["a"].COLOR,semantic:L["a"].COLOR,setIndex:0,constantColor:i["a"].DARKGRAY,componentDatatype:s["a"].FLOAT,type:b["a"].VEC4,isQuantized:!1,isTranslucent:!1};function Q(e,t,a){const n=[];let o;const i=t.positions;return Object(d["a"])(i)&&(X(i),o=V(e,i,a),o.count=t.pointsLength,n.push(o)),Object(d["a"])(t.normals)&&(o=V(e,t.normals,a),n.push(o)),Object(d["a"])(t.colors)?(o=V(e,t.colors,a),n.push(o)):(o=V(e,J,a),n.push(o)),Object(d["a"])(t.batchIds)&&(o=V(e,t.batchIds,a),n.push(o)),n}function $(e){const t=e.batchLength,a=e.pointsLength,n=e.batchTableBinary;if(Object(d["a"])(n)){const o=Object(c["a"])(t,a);return Object(g["a"])({count:o,batchTable:e.batchTableJson,binaryBody:n})}const o=new M["a"]({name:I["a"].BATCH_TABLE_CLASS_NAME,count:a});return new A["a"]({schema:{},propertyTables:[o]})}function W(e,t){const a=e._parsedContent,n=new B;n.metallicFactor=0,n.roughnessFactor=.9;const o=new j;o.metallicRoughness=n;const i=a.colors;Object(d["a"])(i)&&i.isTranslucent&&(o.alphaMode=_["a"].BLEND);const r=!Object(d["a"])(a.normals);o.unlit=r;const s=new F;if(s.attributes=Q(e,a,t),s.primitiveType=f["a"].POINTS,s.material=o,Object(d["a"])(a.batchIds)){const e=new w;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",s.featureIds.push(e)}const c=new D;c.primitives=[s];const u=new x;u.nodes=[c],u.upAxis=T["a"].Z,u.forwardAxis=T["a"].X;const p=new N;p.scene=u,p.nodes=[c],p.structuralMetadata=$(a),Object(d["a"])(a.rtcCenter)&&(p.transform=l["a"].multiplyByTranslation(p.transform,a.rtcCenter,p.transform));const h=a.positions;Object(d["a"])(h)&&h.isQuantized&&(p.transform=l["a"].multiplyByTranslation(p.transform,h.quantizedVolumeOffset,p.transform)),e._components=p,e._parsedContent=void 0}v.prototype.unload=function(){const e=this._buffers;for(let t=0;t<e.length;t++)e[t].destroy();e.length=0,this._components=void 0,this._parsedContent=void 0}},cf18:function(e,t,a){"use strict";var n=a("c937"),o=a("1197"),i=a("43be"),r=a("c9f2"),s=a("7c8c");const c={};function u(e){e.addStruct(c.STRUCT_ID_METADATA_VS,c.STRUCT_NAME_METADATA,o["a"].VERTEX),e.addStruct(c.STRUCT_ID_METADATA_FS,c.STRUCT_NAME_METADATA,o["a"].FRAGMENT),e.addFunction(c.FUNCTION_ID_INITIALIZE_METADATA_VS,c.FUNCTION_SIGNATURE_INITIALIZE_METADATA,o["a"].VERTEX),e.addFunction(c.FUNCTION_ID_INITIALIZE_METADATA_FS,c.FUNCTION_SIGNATURE_INITIALIZE_METADATA,o["a"].FRAGMENT),e.addFunction(c.FUNCTION_ID_SET_METADATA_VARYINGS,c.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS,o["a"].VERTEX)}function d(e,t,a){const o=a.propertyAttributes;if(Object(n["a"])(o))for(let n=0;n<o.length;n++){const a=o[n],i=a.properties;for(const n in i)if(i.hasOwnProperty(n)){const a=i[n],o=s["a"].getAttributeByName(t,a.attribute),r=s["a"].getAttributeInfo(o);l(e,r,n,a)}}}function l(e,t,a,n){const i=_(a),r=t.variableName,s=t.glslType,u=e.shaderBuilder;u.addStructField(c.STRUCT_ID_METADATA_VS,s,i),u.addStructField(c.STRUCT_ID_METADATA_FS,s,i);let d="attributes."+r;n.hasValueTransform&&(d=m(d,{renderResources:e,glslType:s,metadataVariable:i,shaderDestination:o["a"].BOTH,offset:n.offset,scale:n.scale}));const l=`metadata.${i} = ${d};`;u.addFunctionLines(c.FUNCTION_ID_INITIALIZE_METADATA_VS,[l]),u.addFunctionLines(c.FUNCTION_ID_INITIALIZE_METADATA_FS,[l])}function f(e,t){const a=t.propertyTextures;if(Object(n["a"])(a))for(let n=0;n<a.length;n++){const t=a[n],o=t.properties;for(const a in o)if(o.hasOwnProperty(a)){const t=o[a];t.isGpuCompatible()&&p(e,a,t)}}}function p(e,t,a){const n=a.textureReader,i=n.index,r="u_propertyTexture_"+i;e.uniformMap.hasOwnProperty(r)||h(e,r,n);const s=_(t),u=a.getGlslType(),d=e.shaderBuilder;d.addStructField(c.STRUCT_ID_METADATA_FS,u,s);const l=n.texCoord,f="attributes.texCoord_"+l,p=n.channels;let b=`texture2D(${r}, ${f}).${p}`;b=a.unpackInShader(b),a.hasValueTransform&&(b=m(b,{renderResources:e,glslType:u,metadataVariable:s,shaderDestination:o["a"].FRAGMENT,offset:a.offset,scale:a.scale}));const T=`metadata.${s} = ${b};`;d.addFunctionLines(c.FUNCTION_ID_INITIALIZE_METADATA_FS,[T])}function h(e,t,a){const n=e.shaderBuilder;n.addUniform("sampler2D",t,o["a"].FRAGMENT);const i=e.uniformMap;i[t]=function(){return a.texture}}function m(e,t){const a=t.metadataVariable,n=`u_${a}_offset`,o=`u_${a}_scale`,i=t.renderResources,r=i.shaderBuilder,s=t.glslType,c=t.shaderDestination;r.addUniform(s,n,c),r.addUniform(s,o,c);const u=i.uniformMap;return u[n]=function(){return t.offset},u[o]=function(){return t.scale},`czm_valueTransform(${n}, ${o}, ${e})`}function _(e){return e.replaceAll(/[^_a-zA-Z0-9]+/g,"_")}c.name="MetadataPipelineStage",c.STRUCT_ID_METADATA_VS="MetadataVS",c.STRUCT_ID_METADATA_FS="MetadataFS",c.STRUCT_NAME_METADATA="Metadata",c.FUNCTION_ID_INITIALIZE_METADATA_VS="initializeMetadataVS",c.FUNCTION_ID_INITIALIZE_METADATA_FS="initializeMetadataFS",c.FUNCTION_SIGNATURE_INITIALIZE_METADATA="void initializeMetadata(out Metadata metadata, ProcessedAttributes attributes)",c.FUNCTION_ID_SET_METADATA_VARYINGS="setMetadataVaryings",c.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS="void setMetadataVaryings()",c.process=function(e,t,a){const o=e.shaderBuilder;u(o),o.addVertexLines([r["a"]]),o.addFragmentLines([i["a"]]);const s=e.model.structuralMetadata;Object(n["a"])(s)&&(d(e,t,s),f(e,s))},t["a"]=c},d1d9:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a("1a5d"),o=a("2e1e");function i(e){e=Object(n["a"])(e,n["a"].EMPTY_OBJECT),this.lightingModel=Object(n["a"])(e.lightingModel,o["a"].UNLIT)}},d2b6:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a("ae9b"),o=a("0950"),i=a("7d7f");function r(e){n["a"].typeOf.object("model",e),this.shaderBuilder=new i["a"],this.model=e,this.uniformMap={},this.alphaOptions=new o["a"],this.renderStateOptions={}}},d765:function(e,t,a){"use strict";var n=a("cf26"),o=a("77df"),i=a("dde0"),r=a("666e"),s=a("ae9b"),c=a("cbf0"),u=a("1a5d"),d=a("61ad"),l=a("c937"),f=a("e107"),p=a("2323"),h=a("ac4e"),m=a("f729"),_=a("3c2f"),b=a("d767"),T=a("722e"),g=a("aac0"),y=a("afe9"),A=a("1901"),O=a("13e9"),I=a("1b9c"),S=a("dc50"),E=a("e2aa"),M=a("6f7c"),C=a("dbf6"),L=a("c380"),N=a("8656");const x={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},D=y["a"].Attribute,F=y["a"].FeatureIdAttribute,R=y["a"].Instances;function P(e){e=Object(u["a"])(e,u["a"].EMPTY_OBJECT);const t=e.i3dmResource,a=e.arrayBuffer;let n=e.baseResource;const i=Object(u["a"])(e.byteOffset,0),r=Object(u["a"])(e.releaseGltfJson,!1),c=Object(u["a"])(e.asynchronous,!0),f=Object(u["a"])(e.incrementallyLoadTextures,!0),p=Object(u["a"])(e.upAxis,o["a"].Y),h=Object(u["a"])(e.forwardAxis,o["a"].X),m=Object(u["a"])(e.loadAsTypedArray,!1);s["a"].typeOf.object("options.i3dmResource",t),s["a"].typeOf.object("options.arrayBuffer",a),n=Object(l["a"])(n)?n:t.clone(),this._i3dmResource=t,this._baseResource=n,this._arrayBuffer=a,this._byteOffset=i,this._releaseGltfJson=r,this._asynchronous=c,this._incrementallyLoadTextures=f,this._upAxis=p,this._forwardAxis=h,this._loadAsTypedArray=m,this._state=x.UNLOADED,this._promise=Object(d["a"])(),this._gltfLoader=void 0,this._transform=T["a"].IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}function w(e,t){e.unload(),e._state=x.FAILED;const a="Failed to load I3DM";t=e.getError(a,t),e._promise.reject(t)}function j(e,t){const a=e._batchTable,n=e._instancesLength;if(0===n)return;let o;if(Object(l["a"])(a.json))o=Object(A["a"])({count:n,batchTable:a.json,binaryBody:a.binary});else{const e=new O["a"]({name:g["a"].BATCH_TABLE_CLASS_NAME,count:n});o=new p["a"]({schema:{},propertyTables:[e]})}t.structuralMetadata=o}Object(l["a"])(Object.create)&&(P.prototype=Object.create(S["a"].prototype),P.prototype.constructor=P),Object.defineProperties(P.prototype,{promise:{get:function(){return this._promise.promise}},texturesLoadedPromise:{get:function(){return this._gltfLoader.texturesLoadedPromise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),P.prototype.load=function(){const e=_["a"].parse(this._arrayBuffer,this._byteOffset),t=e.featureTableJson,a=e.featureTableBinary,n=e.batchTableJson,o=e.batchTableBinary,s=e.gltfFormat,u=new r["a"](t,a);this._featureTable=u;const d=u.getGlobalProperty("INSTANCES_LENGTH");if(u.featuresLength=d,!Object(l["a"])(d))throw new E["a"]("Feature table global property: INSTANCES_LENGTH must be defined");this._instancesLength=d;const f=u.getGlobalProperty("RTC_CENTER",c["a"].FLOAT,3);Object(l["a"])(f)&&(this._transform=T["a"].fromTranslation(i["a"].fromArray(f))),this._batchTable={json:n,binary:o};const p={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAsTypedArray:this._loadAsTypedArray};if(0===s){let t=Object(h["a"])(e.gltf);t=t.replace(/[\s\0]+$/,"");const a=this._baseResource.getDerivedResource({url:t});p.gltfResource=a,p.baseResource=a}else p.gltfResource=this._i3dmResource,p.typedArray=e.gltf;const b=new m["a"](p);this._gltfLoader=b,this._state=x.LOADING;const g=this;b.load(),b.promise.then((function(){if(g.isDestroyed())return;const e=b.components;e.transform=g._transform,G(g,e),j(g,e),g._components=e,g._state=x.READY,g._promise.resolve(g)})).catch((function(e){g.isDestroyed()||w(g,e)}))},P.prototype.process=function(e){s["a"].typeOf.object("frameState",e),this._state===x.LOADING&&(this._state=x.PROCESSING),this._state===x.PROCESSING&&this._gltfLoader.process(e)};const B=new i["a"],v=new Array(4);function G(e,t){let a;const n=e._featureTable,o=e._instancesLength;if(0===o)return;const r=n.getGlobalProperty("RTC_CENTER",c["a"].FLOAT,3),s=n.getGlobalProperty("EAST_NORTH_UP"),u=n.hasProperty("NORMAL_UP")||n.hasProperty("NORMAL_UP_OCT32P")||s,d=n.hasProperty("SCALE")||n.hasProperty("SCALE_NON_UNIFORM"),f=U(n,o);let p,h;u&&(p=new Float32Array(4*o)),d&&(h=new Float32Array(3*o));const m=new Float32Array(o),_=i["a"].unpackArray(f);let g=new i["a"];const y=new i["a"],A=new i["a"],O=new i["a"],S=new b["a"],E=new I["a"],M=new Array(4),x=new i["a"],P=new Array(3),w=new T["a"];if(!Object(l["a"])(r)){const e=N["a"].fromPoints(_);for(a=0;a<_.length;a++)i["a"].subtract(_[a],e.center,B),f[3*a+0]=B.x,f[3*a+1]=B.y,f[3*a+2]=B.z;t.transform=T["a"].fromTranslation(e.center)}for(a=0;a<o;a++){g=i["a"].clone(_[a]),Object(l["a"])(r)&&i["a"].add(g,i["a"].unpack(r),g),u&&(z(n,s,a,E,g,A,y,O,S,w),I["a"].pack(E,M,0),p[4*a+0]=M[0],p[4*a+1]=M[1],p[4*a+2]=M[2],p[4*a+3]=M[3]),d&&(k(n,a,x),i["a"].pack(x,P,0),h[3*a+0]=P[0],h[3*a+1]=P[1],h[3*a+2]=P[2]);let e=n.getProperty("BATCH_ID",c["a"].UNSIGNED_SHORT,1,a);Object(l["a"])(e)||(e=a),m[a]=e}const j=new R;j.transformInWorldSpace=!0;const v=new D;if(v.name="Instance Translation",v.semantic=C["a"].TRANSLATION,v.componentDatatype=c["a"].FLOAT,v.type=L["a"].VEC3,v.count=o,v.packedTypedArray=f,j.attributes.push(v),u){const e=new D;e.name="Instance Rotation",e.semantic=C["a"].ROTATION,e.componentDatatype=c["a"].FLOAT,e.type=L["a"].VEC4,e.count=o,e.packedTypedArray=p,j.attributes.push(e)}if(d){const e=new D;e.name="Instance Scale",e.semantic=C["a"].SCALE,e.componentDatatype=c["a"].FLOAT,e.type=L["a"].VEC3,e.count=o,e.packedTypedArray=h,j.attributes.push(e)}const G=new D;G.name="Instance Feature ID",G.setIndex=0,G.semantic=C["a"].FEATURE_ID,G.componentDatatype=c["a"].FLOAT,G.type=L["a"].SCALAR,G.count=o,G.packedTypedArray=m,j.attributes.push(G);const V=new F;for(V.propertyTableId=0,V.setIndex=0,V.positionalLabel="instanceFeatureId_0",j.featureIds.push(V),a=0;a<t.nodes.length;a++){const e=t.nodes[a];e.primitives.length>0&&(e.instances=j)}}function U(e,t){if(e.hasProperty("POSITION"))return e.getPropertyArray("POSITION",c["a"].FLOAT,3);if(e.hasProperty("POSITION_QUANTIZED")){const t=e.getPropertyArray("POSITION_QUANTIZED",c["a"].UNSIGNED_SHORT,3),a=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",c["a"].FLOAT,3);if(!Object(l["a"])(a))throw new E["a"]("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const n=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",c["a"].FLOAT,3);if(!Object(l["a"])(n))throw new E["a"]("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(let e=0;e<t.length/3;e++){const o=t[e];for(let i=0;i<3;i++)t[3*e+i]=o[i]/65535*n[i]+a[i]}return t}throw new E["a"]("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}const V=new Array(4);function z(e,t,a,o,r,s,u,d,p,h){const m=e.getProperty("NORMAL_UP",c["a"].FLOAT,3,a,v),_=e.getProperty("NORMAL_RIGHT",c["a"].FLOAT,3,a,V);let g=!1;if(Object(l["a"])(m)){if(!Object(l["a"])(_))throw new E["a"]("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");i["a"].unpack(m,0,s),i["a"].unpack(_,0,u),g=!0}else{const o=e.getProperty("NORMAL_UP_OCT32P",c["a"].UNSIGNED_SHORT,2,a,v),i=e.getProperty("NORMAL_RIGHT_OCT32P",c["a"].UNSIGNED_SHORT,2,a,V);if(Object(l["a"])(o)){if(!Object(l["a"])(i))throw new E["a"]("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");n["a"].octDecodeInRange(o[0],o[1],65535,s),n["a"].octDecodeInRange(i[0],i[1],65535,u),g=!0}else t?(M["a"].eastNorthUpToFixedFrame(r,f["a"].WGS84,h),T["a"].getMatrix3(h,p)):b["a"].clone(b["a"].IDENTITY,p)}g&&(i["a"].cross(u,s,d),i["a"].normalize(d,d),b["a"].setColumn(p,0,u,p),b["a"].setColumn(p,1,s,p),b["a"].setColumn(p,2,d,p)),I["a"].fromRotationMatrix(p,o)}function k(e,t,a){a=i["a"].fromElements(1,1,1,a);const n=e.getProperty("SCALE",c["a"].FLOAT,1,t);Object(l["a"])(n)&&i["a"].multiplyByScalar(a,n,a);const o=e.getProperty("SCALE_NON_UNIFORM",c["a"].FLOAT,3,t,v);Object(l["a"])(o)&&(a.x*=o[0],a.y*=o[1],a.z*=o[2])}P.prototype.unload=function(){Object(l["a"])(this._gltfLoader)&&this._gltfLoader.unload(),this._components=void 0},t["a"]=P},df33:function(e,t,a){"use strict";var n=a("8574"),o=a("ce1c"),i=a("2fad"),r=a("0d4e"),s=a("51f2"),c=a("1197");const u={name:"ModelColorPipelineStage",COLOR_UNIFORM_NAME:"model_color",COLOR_BLEND_UNIFORM_NAME:"model_colorBlend",process:function(e,t,a){const d=e.shaderBuilder;d.addDefine("HAS_MODEL_COLOR",void 0,c["a"].FRAGMENT),d.addFragmentLines([r["a"]]);const l={},f=t.color,p=e.renderStateOptions;0===f.alpha?(p.colorMask={red:!1,green:!1,blue:!1,alpha:!1},p.depthMask=!1):f.alpha<1&&(e.alphaOptions.pass=s["a"].TRANSLUCENT,e.alphaOptions.alphaMode=n["a"].BLEND),d.addUniform("vec4",u.COLOR_UNIFORM_NAME,c["a"].FRAGMENT),l[u.COLOR_UNIFORM_NAME]=function(){return t.color},d.addUniform("float",u.COLOR_BLEND_UNIFORM_NAME,c["a"].FRAGMENT),l[u.COLOR_BLEND_UNIFORM_NAME]=function(){return o["a"].getColorBlend(t.colorBlendMode,t.colorBlendAmount)},e.uniformMap=Object(i["a"])(l,e.uniformMap)}};t["a"]=u}}]);