(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~e1cfed04"],{"13e9":function(e,t,n){"use strict";var a=n("ae9b"),r=n("1a5d"),i=n("c937");function o(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT),a["a"].typeOf.number("options.count",e.count),this._name=e.name,this._id=e.id,this._count=e.count,this._extras=e.extras,this._extensions=e.extensions,this._metadataTable=e.metadataTable,this._jsonMetadataTable=e.jsonMetadataTable,this._batchTableHierarchy=e.batchTableHierarchy}Object.defineProperties(o.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},count:{get:function(){return this._count}},class:{get:function(){if(Object(i["a"])(this._metadataTable))return this._metadataTable.class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),o.prototype.hasProperty=function(e,t){return a["a"].typeOf.number("index",e),a["a"].typeOf.string("propertyId",t),!(!Object(i["a"])(this._metadataTable)||!this._metadataTable.hasProperty(t))||(!(!Object(i["a"])(this._jsonMetadataTable)||!this._jsonMetadataTable.hasProperty(t))||!(!Object(i["a"])(this._batchTableHierarchy)||!this._batchTableHierarchy.hasProperty(e,t)))},o.prototype.hasPropertyBySemantic=function(e,t){return a["a"].typeOf.number("index",e),a["a"].typeOf.string("semantic",t),!!Object(i["a"])(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(t)},o.prototype.propertyExists=function(e){return a["a"].typeOf.string("propertyId",e),!(!Object(i["a"])(this._metadataTable)||!this._metadataTable.hasProperty(e))||(!(!Object(i["a"])(this._jsonMetadataTable)||!this._jsonMetadataTable.hasProperty(e))||!(!Object(i["a"])(this._batchTableHierarchy)||!this._batchTableHierarchy.propertyExists(e)))},o.prototype.propertyExistsBySemantic=function(e){return a["a"].typeOf.string("semantic",e),!!Object(i["a"])(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(e)};const s=[];o.prototype.getPropertyIds=function(e,t){return t=Object(i["a"])(t)?t:[],t.length=0,Object(i["a"])(this._metadataTable)&&t.push.apply(t,this._metadataTable.getPropertyIds(s)),Object(i["a"])(this._jsonMetadataTable)&&t.push.apply(t,this._jsonMetadataTable.getPropertyIds(s)),Object(i["a"])(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,s)),t},o.prototype.getProperty=function(e,t){let n;return Object(i["a"])(this._metadataTable)&&(n=this._metadataTable.getProperty(e,t),Object(i["a"])(n))||Object(i["a"])(this._jsonMetadataTable)&&(n=this._jsonMetadataTable.getProperty(e,t),Object(i["a"])(n))||Object(i["a"])(this._batchTableHierarchy)&&(n=this._batchTableHierarchy.getProperty(e,t),Object(i["a"])(n))?n:void 0},o.prototype.setProperty=function(e,t,n){return!(!Object(i["a"])(this._metadataTable)||!this._metadataTable.setProperty(e,t,n))||(!(!Object(i["a"])(this._jsonMetadataTable)||!this._jsonMetadataTable.setProperty(e,t,n))||Object(i["a"])(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))},o.prototype.getPropertyBySemantic=function(e,t){if(Object(i["a"])(this._metadataTable))return this._metadataTable.getPropertyBySemantic(e,t)},o.prototype.setPropertyBySemantic=function(e,t,n){return!!Object(i["a"])(this._metadataTable)&&this._metadataTable.setPropertyBySemantic(e,t,n)},o.prototype.getPropertyTypedArray=function(e){if(a["a"].typeOf.string("propertyId",e),Object(i["a"])(this._metadataTable))return this._metadataTable.getPropertyTypedArray(e)},o.prototype.getPropertyTypedArrayBySemantic=function(e){if(a["a"].typeOf.string("semantic",e),Object(i["a"])(this._metadataTable))return this._metadataTable.getPropertyTypedArrayBySemantic(e)},t["a"]=o},"4c5b":function(e,t,n){"use strict";var a=n("0b4a"),r=n("1a5d"),i=n("c937"),o=n("21b7"),s=n("e2a6");function c(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT),this._primitives=[],this._guid=Object(a["a"])(),this._zIndex=void 0,this.show=Object(r["a"])(e.show,!0),this.destroyPrimitives=Object(r["a"])(e.destroyPrimitives,!0)}function p(e,t){if(!e.contains(t))throw new s["a"]("primitive is not in this collection.");return e._primitives.indexOf(t)}Object.defineProperties(c.prototype,{length:{get:function(){return this._primitives.length}}}),c.prototype.add=function(e,t){const n=Object(i["a"])(t);if(!Object(i["a"])(e))throw new s["a"]("primitive is required.");if(n){if(t<0)throw new s["a"]("index must be greater than or equal to zero.");if(t>this._primitives.length)throw new s["a"]("index must be less than or equal to the number of primitives.")}const a=e._external=e._external||{},r=a._composites=a._composites||{};return r[this._guid]={collection:this},n?this._primitives.splice(t,0,e):this._primitives.push(e),e},c.prototype.remove=function(e){if(this.contains(e)){const t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},c.prototype.removeAndDestroy=function(e){const t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},c.prototype.removeAll=function(){const e=this._primitives,t=e.length;for(let n=0;n<t;++n)delete e[n]._external._composites[this._guid],this.destroyPrimitives&&e[n].destroy();this._primitives=[]},c.prototype.contains=function(e){return!!(Object(i["a"])(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},c.prototype.raise=function(e){if(Object(i["a"])(e)){const t=p(this,e),n=this._primitives;if(t!==n.length-1){const e=n[t];n[t]=n[t+1],n[t+1]=e}}},c.prototype.raiseToTop=function(e){if(Object(i["a"])(e)){const t=p(this,e),n=this._primitives;t!==n.length-1&&(n.splice(t,1),n.push(e))}},c.prototype.lower=function(e){if(Object(i["a"])(e)){const t=p(this,e),n=this._primitives;if(0!==t){const e=n[t];n[t]=n[t-1],n[t-1]=e}}},c.prototype.lowerToBottom=function(e){if(Object(i["a"])(e)){const t=p(this,e),n=this._primitives;0!==t&&(n.splice(t,1),n.unshift(e))}},c.prototype.get=function(e){if(!Object(i["a"])(e))throw new s["a"]("index is required.");return this._primitives[e]},c.prototype.update=function(e){if(!this.show)return;const t=this._primitives;for(let n=0;n<t.length;++n)t[n].update(e)},c.prototype.prePassesUpdate=function(e){const t=this._primitives;for(let n=0;n<t.length;++n){const a=t[n];Object(i["a"])(a.prePassesUpdate)&&a.prePassesUpdate(e)}},c.prototype.updateForPass=function(e,t){const n=this._primitives;for(let a=0;a<n.length;++a){const r=n[a];Object(i["a"])(r.updateForPass)&&r.updateForPass(e,t)}},c.prototype.postPassesUpdate=function(e){const t=this._primitives;for(let n=0;n<t.length;++n){const a=t[n];Object(i["a"])(a.postPassesUpdate)&&a.postPassesUpdate(e)}},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this.removeAll(),Object(o["a"])(this)},t["a"]=c},5441:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("ae9b"),r=n("1a5d"),i=n("c937");function o(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT);const t=e.property,n=e.classProperty;a["a"].typeOf.object("options.property",t),a["a"].typeOf.object("options.classProperty",n),this._attribute=t.attribute,this._classProperty=n,this._min=t.min,this._max=t.max;let o=t.offset,s=t.scale;const c=n.hasValueTransform||Object(i["a"])(o)||Object(i["a"])(s);o=Object(r["a"])(o,n.offset),s=Object(r["a"])(s,n.scale),o=n.unpackVectorAndMatrixTypes(o),s=n.unpackVectorAndMatrixTypes(s),this._offset=o,this._scale=s,this._hasValueTransform=c,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(o.prototype,{attribute:{get:function(){return this._attribute}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}})},5769:function(e,t,n){"use strict";var a=n("8656"),r=n("85b2"),i=n("dde0"),o=n("6b82"),s=n("8d54"),c=n("44e9"),p=n("4051"),h=n("2fad"),u=n("cbf0"),l=n("1a5d"),d=n("61ad"),b=n("c937"),m=n("21b7"),f=n("e2a6"),_=n("d809"),g=n("8e1f"),y=n("5a72"),O=n("f3a4"),T=n("0c02"),v=n("e148"),S=n("a61d"),j=n("722e"),x=n("a7b2"),w=n("e2aa"),C=n("5f0f"),A=n("86a0"),D=n("6ba7"),P=n("2341"),I=n("d5cf"),k=n("51f2"),z=n("5027"),F=n("8f7d"),E=n("b3ce"),M=n("dc15"),L=n("73f3"),B=n("ddd8"),V=n("0650"),R=n("d180"),G=n("d509"),H=n("dc6c"),$=n("ff3a");function N(e){if(e=Object(l["a"])(e,l["a"].EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=j["a"].clone(Object(l["a"])(e.modelMatrix,j["a"].IDENTITY)),this._modelMatrix=new j["a"],this.show=Object(l["a"])(e.show,!0),this._vertexCacheOptimize=Object(l["a"])(e.vertexCacheOptimize,!1),this._interleave=Object(l["a"])(e.interleave,!1),this._releaseGeometryInstances=Object(l["a"])(e.releaseGeometryInstances,!0),this._allowPicking=Object(l["a"])(e.allowPicking,!0),this._asynchronous=Object(l["a"])(e.asynchronous,!0),this._compressVertices=Object(l["a"])(e.compressVertices,!0),this.cull=Object(l["a"])(e.cull,!0),this.debugShowBoundingVolume=Object(l["a"])(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,Object(b["a"])(this.rtcCenter)&&(!Object(b["a"])(this.geometryInstances)||Array.isArray(this.geometryInstances)&&1!==this.geometryInstances.length))throw new f["a"]("Relative-to-center rendering only supports one geometry instance.");this.shadows=Object(l["a"])(e.shadows,$["a"].DISABLED),this._translucent=void 0,this._state=G["a"].READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._readyPromise=Object(d["a"])(),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}function U(e){const t=e.length,n=[],a=e[0].attributes;let r;for(r in a)if(a.hasOwnProperty(r)&&Object(b["a"])(a[r])){const i=a[r];let o=!0;for(let n=1;n<t;++n){const t=e[n].attributes[r];if(!Object(b["a"])(t)||i.componentDatatype!==t.componentDatatype||i.componentsPerAttribute!==t.componentsPerAttribute||i.normalize!==t.normalize){o=!1;break}}o&&n.push(r)}return n}Object.defineProperties(N.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});const q=new r["a"],Y=new i["a"],W=new o["a"];function J(e){const t=e.length;return 1===t?e[0]:2===t?r["a"].unpack(e,0,q):3===t?i["a"].unpack(e,0,Y):4===t?o["a"].unpack(e,0,W):void 0}function Q(e,t){const n=e.geometryInstances,a=Array.isArray(n)?n:[n],r=a.length;if(0===r)return;const i=U(a),o=i.length,s=[],c={},h={};let d;const m=a[0];let f,_,g,y=m.attributes;for(f=0;f<o;++f)_=i[f],g=y[_],c[_]=f,s.push({functionName:"czm_batchTable_"+_,componentDatatype:g.componentDatatype,componentsPerAttribute:g.componentsPerAttribute,normalize:g.normalize});-1!==i.indexOf("distanceDisplayCondition")&&(s.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:u["a"].FLOAT,componentsPerAttribute:1}),h.center3DHigh=s.length-5,h.center3DLow=s.length-4,h.center2DHigh=s.length-3,h.center2DLow=s.length-2,h.radius=s.length-1),-1!==i.indexOf("offset")&&(s.push({functionName:"czm_batchTable_offset2D",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3}),d=s.length-1),s.push({functionName:"czm_batchTable_pickColor",componentDatatype:u["a"].UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});const O=s.length,T=new L["a"](t,s,r);for(f=0;f<r;++f){const n=a[f];y=n.attributes;for(let e=0;e<o;++e){_=i[e],g=y[_];const t=J(g.value),n=c[_];T.setBatchedAttribute(f,n,t)}const r={primitive:Object(l["a"])(n.pickPrimitive,e)};Object(b["a"])(n.id)&&(r.id=n.id);const s=t.createPickId(r);e._pickIds.push(s);const h=s.color,u=W;u.x=p["a"].floatToByte(h.red),u.y=p["a"].floatToByte(h.green),u.z=p["a"].floatToByte(h.blue),u.w=p["a"].floatToByte(h.alpha),T.setBatchedAttribute(f,O-1,u)}e._batchTable=T,e._batchTableAttributeIndices=c,e._batchTableBoundingSphereAttributeIndices=h,e._batchTableOffsetAttribute2DIndex=d}function X(e){let t;return t=Array.isArray(e.values)?e.values.slice(0):new e.values.constructor(e.values),new O["a"]({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function Z(e){const t=e.attributes,n=new T["a"];for(const a in t)t.hasOwnProperty(a)&&Object(b["a"])(t[a])&&(n[a]=X(t[a]));let r;if(Object(b["a"])(e.indices)){const t=e.indices;r=Array.isArray(t)?t.slice(0):new t.constructor(t)}return new y["a"]({attributes:n,indices:r,primitiveType:e.primitiveType,boundingSphere:a["a"].clone(e.boundingSphere)})}function K(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:j["a"].clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}const ee=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;function te(e){const t=E["a"].replaceMain(e,"czm_non_pick_main"),n="varying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}";return`${t}\n${n}`}function ne(e){return"varying vec4 v_pickColor;\n"+e}function ae(e,t){if(!e.compressVertices)return t;const n=-1!==t.search(/attribute\s+vec3\s+normal;/g),a=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!n&&!a)return t;const r=-1!==t.search(/attribute\s+vec3\s+tangent;/g),i=-1!==t.search(/attribute\s+vec3\s+bitangent;/g);let o=a&&n?2:1;o+=r||i?1:0;const s=o>1?"vec"+o:"float",c="compressedAttributes",p=`attribute ${s} ${c};`;let h="",u="";if(a){h+="vec2 st;\n";const e=o>1?c+".x":c;u+=`    st = czm_decompressTextureCoordinates(${e});\n`}n&&r&&i?(h+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",u+=`    czm_octDecode(${c}.${a?"yz":"xy"}, normal, tangent, bitangent);\n`):(n&&(h+="vec3 normal;\n",u+=`    normal = czm_octDecode(${c}${o>1?"."+(a?"y":"x"):""});\n`),r&&(h+="vec3 tangent;\n",u+=`    tangent = czm_octDecode(${c}.${a&&n?"z":"y"});\n`),i&&(h+="vec3 bitangent;\n",u+=`    bitangent = czm_octDecode(${c}.${a&&n?"z":"y"});\n`));let l=t;l=l.replace(/attribute\s+vec3\s+normal;/g,""),l=l.replace(/attribute\s+vec2\s+st;/g,""),l=l.replace(/attribute\s+vec3\s+tangent;/g,""),l=l.replace(/attribute\s+vec3\s+bitangent;/g,""),l=E["a"].replaceMain(l,"czm_non_compressed_main");const d=`void main() \n{ \n${u}    czm_non_compressed_main(); \n}`;return[p,h,l,d].join("\n")}function re(e){let t=E["a"].replaceMain(e,"czm_non_depth_clamp_main");return t+="void main() {\n    czm_non_depth_clamp_main();\n    gl_Position = czm_depthClamp(gl_Position);}\n",t}function ie(e){let t=E["a"].replaceMain(e,"czm_non_depth_clamp_main");return t+="void main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth)\n    #if defined(LOG_DEPTH)\n        czm_writeLogDepth();\n    #else\n        czm_writeDepthClamp();\n    #endif\n#endif\n}\n",t="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+t,t}function oe(e,t){const n=e.vertexAttributes;for(const a in n)if(n.hasOwnProperty(a)&&!Object(b["a"])(t[a]))throw new f["a"](`Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input '${a}', which was not computed as part of the Geometry.  Use the appearance's vertexFormat property when constructing the geometry.`)}function se(e,t){return function(){return e[t]}}N._modifyShaderPosition=function(e,t,n){let a,r="",i="",o="";while(null!==(a=ee.exec(t))){const s=a[1],c=`vec4 czm_compute${s[0].toUpperCase()}${s.substr(1)}()`;"vec4 czm_computePosition()"!==c&&(r+=c+";\n"),Object(b["a"])(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),r+="uniform mat4 u_modifiedModelView;\n",i+="attribute vec4 position;\n",o+=c+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?o+=c+"\n{\n"+`    return czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow);\n}\n\n`:(i+=`attribute vec3 ${s}2DHigh;\nattribute vec3 ${s}2DLow;\n`,o+=c+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n"+`        p = czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n`+`        p = czm_translateRelativeToEye(${s}2DHigh.zxy, ${s}2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n`+`                czm_translateRelativeToEye(${s}2DHigh.zxy, ${s}2DLow.zxy),\n`+`                czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n`)}return[r,i,t,o].join("\n")},N._appendShowToShader=function(e,t){if(!Object(b["a"])(e._batchTableAttributeIndices.show))return t;const n=E["a"].replaceMain(t,"czm_non_show_main"),a="void main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}";return`${n}\n${a}`},N._updateColorAttribute=function(e,t,n){if(!Object(b["a"])(e._batchTableAttributeIndices.color)&&!Object(b["a"])(e._batchTableAttributeIndices.depthFailColor))return t;if(-1===t.search(/attribute\s+vec4\s+color;/g))return t;if(n&&!Object(b["a"])(e._batchTableAttributeIndices.depthFailColor))throw new f["a"]("A depthFailColor per-instance attribute is required when using a depth fail appearance that uses a color attribute.");let a=t;return a=a.replace(/attribute\s+vec4\s+color;/g,""),a=n?a.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):a.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),a},N._updatePickColorAttribute=function(e){let t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t},N._appendOffsetToShader=function(e,t){if(!Object(b["a"])(e._batchTableAttributeIndices.offset))return t;let n="attribute float batchId;\n";n+="attribute float applyOffset;";let a=t.replace(/attribute\s+float\s+batchId;/g,n),r="vec4 $1 = czm_computePosition();\n";return r+="    if (czm_sceneMode == czm_sceneMode3D)\n",r+="    {\n",r+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",r+="    }\n",r+="    else\n",r+="    {\n",r+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",r+="    }\n",a=a.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,r),a},N._appendDistanceDisplayConditionToShader=function(e,t,n){if(!Object(b["a"])(e._batchTableAttributeIndices.distanceDisplayCondition))return t;const a=E["a"].replaceMain(t,"czm_non_distanceDisplayCondition_main");let r="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return r+=n?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",r+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}",`${a}\n${r}`};const ce=Math.max(g["a"].hardwareConcurrency-1,1);let pe;const he=new A["a"]("combineGeometry");function ue(e,t){let n,a,r,i;const o=e._instanceIds;if(e._state===G["a"].READY){n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];const s=e._numberOfInstances=n.length,c=[];let p,h=[];for(r=0;r<s;++r){if(a=n[r].geometry,o.push(n[r].id),!Object(b["a"])(a._workerName))throw new f["a"]("_workerName must be defined for asynchronous geometry.");h.push({moduleName:a._workerName,geometry:a})}if(!Object(b["a"])(pe))for(pe=new Array(ce),r=0;r<ce;r++)pe[r]=new A["a"]("createGeometry");for(h=Object(C["a"])(h,ce),r=0;r<h.length;r++){let e=0;const t=h[r],n=t.length;for(i=0;i<n;++i)p=t[i],a=p.geometry,Object(b["a"])(a.constructor.pack)&&(p.offset=e,e+=Object(l["a"])(a.constructor.packedLength,a.packedLength));let o;if(e>0){const r=new Float64Array(e);for(o=[r.buffer],i=0;i<n;++i)p=t[i],a=p.geometry,Object(b["a"])(a.constructor.pack)&&(a.constructor.pack(a,r,p.offset),p.geometry=r)}c.push(pe[r].scheduleTask({subTasks:h[r]},o))}e._state=G["a"].CREATING,Promise.all(c).then((function(t){e._createGeometryResults=t,e._state=G["a"].CREATED})).catch((function(n){Be(e,t,G["a"].FAILED,n)}))}else if(e._state===G["a"].CREATED){const a=[];n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];const r=t.scene3DOnly,i=t.mapProjection,o=he.scheduleTask(R["a"].packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:i.ellipsoid,projection:i,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:r,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},a),a);e._createGeometryResults=void 0,e._state=G["a"].COMBINING,Promise.resolve(o).then((function(n){const a=R["a"].unpackCombineGeometryResults(n);e._geometries=a.geometries,e._attributeLocations=a.attributeLocations,e.modelMatrix=j["a"].clone(a.modelMatrix,e.modelMatrix),e._pickOffsets=a.pickOffsets,e._offsetInstanceExtend=a.offsetInstanceExtend,e._instanceBoundingSpheres=a.boundingSpheres,e._instanceBoundingSpheresCV=a.boundingSpheresCV,Object(b["a"])(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=G["a"].COMBINED):Be(e,t,G["a"].FAILED,void 0)})).catch((function(n){Be(e,t,G["a"].FAILED,n)}))}}function le(e,t){const n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],a=e._numberOfInstances=n.length,r=new Array(a),i=e._instanceIds;let o,s,c=0;for(s=0;s<a;s++){o=n[s];const e=o.geometry;let t;t=Object(b["a"])(e.attributes)&&Object(b["a"])(e.primitiveType)?Z(e):e.constructor.createGeometry(e),r[c++]=K(o,t),i.push(o.id)}r.length=c;const p=t.scene3DOnly,h=t.mapProjection,u=R["a"].combineGeometry({instances:r,ellipsoid:h.ellipsoid,projection:h,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:p,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=u.geometries,e._attributeLocations=u.attributeLocations,e.modelMatrix=j["a"].clone(u.modelMatrix,e.modelMatrix),e._pickOffsets=u.pickOffsets,e._offsetInstanceExtend=u.offsetInstanceExtend,e._instanceBoundingSpheres=u.boundingSpheres,e._instanceBoundingSpheresCV=u.boundingSpheresCV,Object(b["a"])(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=G["a"].COMBINED):Be(e,t,G["a"].FAILED,void 0)}function de(e,t){const n=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!Object(b["a"])(n))return void(e._recomputeBoundingSpheres=!1);let r;const o=e._offsetInstanceExtend,s=e._instanceBoundingSpheres,c=s.length;let p=e._tempBoundingSpheres;if(!Object(b["a"])(p)){for(p=new Array(c),r=0;r<c;r++)p[r]=new a["a"];e._tempBoundingSpheres=p}for(r=0;r<c;++r){let t=p[r];const a=e._batchTable.getBatchedAttribute(r,n,new i["a"]);t=s[r].clone(t),ke(t,a,o[r])}const h=[],u=[],l=[];for(r=0;r<c;++r){const e=p[r],t=e.center.x-e.radius;t>0||a["a"].intersectPlane(e,x["a"].ORIGIN_ZX_PLANE)!==S["a"].INTERSECTING?h.push(e):(u.push(e),l.push(e))}let d=h[0],m=l[0],f=u[0];for(r=1;r<h.length;r++)d=a["a"].union(d,h[r]);for(r=1;r<l.length;r++)m=a["a"].union(m,l[r]);for(r=1;r<u.length;r++)f=a["a"].union(f,u[r]);const _=[];for(Object(b["a"])(d)&&_.push(d),Object(b["a"])(m)&&_.push(m),Object(b["a"])(f)&&_.push(f),r=0;r<_.length;r++){const n=_[r].clone(e._boundingSpheres[r]);e._boundingSpheres[r]=n,e._boundingSphereCV[r]=a["a"].projectTo2D(n,t.mapProjection,e._boundingSphereCV[r])}N._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}const be=new _["a"],me=new s["a"],fe=new i["a"],_e=new a["a"];function ge(e,t){const n=Object(b["a"])(e._batchTableAttributeIndices.distanceDisplayCondition);if(!n||e._batchTableBoundingSpheresUpdated)return;const r=e._batchTableBoundingSphereAttributeIndices,i=r.center3DHigh,o=r.center3DLow,s=r.center2DHigh,c=r.center2DLow,p=r.radius,h=t.mapProjection,u=h.ellipsoid,l=e._batchTable,d=e._instanceBoundingSpheres,m=d.length;for(let f=0;f<m;++f){let n=d[f];if(!Object(b["a"])(n))continue;const r=e.modelMatrix;Object(b["a"])(r)&&(n=a["a"].transform(n,r,_e));const m=n.center,g=n.radius;let y=_["a"].fromCartesian(m,be);if(l.setBatchedAttribute(f,i,y.high),l.setBatchedAttribute(f,o,y.low),!t.scene3DOnly){const e=u.cartesianToCartographic(m,me),t=h.project(e,fe);y=_["a"].fromCartesian(t,be),l.setBatchedAttribute(f,s,y.high),l.setBatchedAttribute(f,c,y.low)}l.setBatchedAttribute(f,p,g)}e._batchTableBoundingSpheresUpdated=!0}const ye=new i["a"],Oe=new i["a"];function Te(e,t){const n=Object(b["a"])(e._batchTableAttributeIndices.offset);if(!n||e._batchTableOffsetsUpdated||t.scene3DOnly)return;const r=e._batchTableOffsetAttribute2DIndex,o=t.mapProjection,s=o.ellipsoid,c=e._batchTable,p=e._instanceBoundingSpheres,h=p.length;for(let u=0;u<h;++u){let t=p[u];if(!Object(b["a"])(t))continue;const n=c.getBatchedAttribute(u,e._batchTableAttributeIndices.offset);if(i["a"].equals(n,i["a"].ZERO)){c.setBatchedAttribute(u,r,i["a"].ZERO);continue}const h=e.modelMatrix;Object(b["a"])(h)&&(t=a["a"].transform(t,h,_e));let l=t.center;l=s.scaleToGeodeticSurface(l,Oe);let d=s.cartesianToCartographic(l,me);const m=o.project(d,fe),f=i["a"].add(n,l,ye);d=s.cartesianToCartographic(f,d);const _=o.project(d,ye),g=i["a"].subtract(_,m,ye),y=g.x;g.x=g.z,g.z=g.y,g.y=y,c.setBatchedAttribute(u,r,g)}e._batchTableOffsetsUpdated=!0}function ve(e,t){const n=e._attributeLocations,r=e._geometries,i=t.scene3DOnly,o=t.context,s=[],c=r.length;for(let p=0;p<c;++p){const c=r[p];if(s.push(M["a"].fromGeometry({context:o,geometry:c,attributeLocations:n,bufferUsage:D["a"].STATIC_DRAW,interleave:e._interleave})),Object(b["a"])(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,c);else if(e._boundingSpheres.push(a["a"].clone(c.boundingSphere)),e._boundingSphereWC.push(new a["a"]),!i){const t=c.boundingSphereCV.center,n=t.x,r=t.y,i=t.z;t.x=i,t.y=n,t.z=r,e._boundingSphereCV.push(a["a"].clone(c.boundingSphereCV)),e._boundingSphere2D.push(new a["a"]),e._boundingSphereMorph.push(new a["a"])}}e._va=s,e._primitiveType=r[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,Be(e,t,G["a"].COMPLETE,void 0)}function Se(e,t,n,a){let r,i=n.getRenderState();a?(r=Object(c["a"])(i,!1),r.cull={enabled:!0,face:B["a"].BACK},e._frontFaceRS=z["a"].fromCache(r),r.cull.face=B["a"].FRONT,e._backFaceRS=z["a"].fromCache(r)):(e._frontFaceRS=z["a"].fromCache(i),e._backFaceRS=e._frontFaceRS),r=Object(c["a"])(i,!1),Object(b["a"])(e._depthFailAppearance)&&(r.depthTest.enabled=!1),Object(b["a"])(e._depthFailAppearance)&&(i=e._depthFailAppearance.getRenderState(),r=Object(c["a"])(i,!1),r.depthTest.func=V["a"].GREATER,a?(r.cull={enabled:!0,face:B["a"].BACK},e._frontFaceDepthFailRS=z["a"].fromCache(r),r.cull.face=B["a"].FRONT,e._backFaceDepthFailRS=z["a"].fromCache(r)):(e._frontFaceDepthFailRS=z["a"].fromCache(r),e._backFaceDepthFailRS=e._frontFaceRS))}function je(e,t,n){const a=t.context,r=e._attributeLocations;let i=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);i=N._appendOffsetToShader(e,i),i=N._appendShowToShader(e,i),i=N._appendDistanceDisplayConditionToShader(e,i,t.scene3DOnly),i=te(i),i=N._updateColorAttribute(e,i,!1),i=ae(e,i),i=N._modifyShaderPosition(e,i,t.scene3DOnly);let o=n.getFragmentShaderSource();o=ne(o),e._sp=F["a"].replaceCache({context:a,shaderProgram:e._sp,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:r}),oe(e._sp,r),Object(b["a"])(e._depthFailAppearance)&&(i=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),i=N._appendShowToShader(e,i),i=N._appendDistanceDisplayConditionToShader(e,i,t.scene3DOnly),i=te(i),i=N._updateColorAttribute(e,i,!0),i=ae(e,i),i=N._modifyShaderPosition(e,i,t.scene3DOnly),i=re(i),o=e._depthFailAppearance.getFragmentShaderSource(),o=ne(o),o=ie(o),e._spDepthFail=F["a"].replaceCache({context:a,shaderProgram:e._spDepthFail,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:r}),oe(e._spDepthFail,r))}const xe=new j["a"],we=new i["a"];function Ce(e,t,n,a){const r=Object(b["a"])(n)?n._uniforms:void 0,i={},o=t.uniforms;if(Object(b["a"])(o))for(const c in o)if(o.hasOwnProperty(c)){if(Object(b["a"])(r)&&Object(b["a"])(r[c]))throw new f["a"]("Appearance and material have a uniform with the same name: "+c);i[c]=se(o,c)}let s=Object(h["a"])(i,r);return s=e._batchTable.getUniformMapCallback()(s),Object(b["a"])(e.rtcCenter)&&(s.u_modifiedModelView=function(){const t=a.context.uniformState.view;return j["a"].multiply(t,e._modelMatrix,xe),j["a"].multiplyByPoint(xe,e.rtcCenter,we),j["a"].setTranslation(xe,we,xe),xe}),s}function Ae(e,t,n,a,r,i,o,s){const c=Ce(e,t,n,s);let p;Object(b["a"])(e._depthFailAppearance)&&(p=Ce(e,e._depthFailAppearance,e._depthFailAppearance.material,s));const h=a?k["a"].TRANSLUCENT:k["a"].OPAQUE;let u=r?2:1;u*=Object(b["a"])(e._depthFailAppearance)?2:1,i.length=e._va.length*u;const l=i.length;let d=0;for(let m=0;m<l;++m){let t;r&&(t=i[m],Object(b["a"])(t)||(t=i[m]=new I["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[d],t.renderState=e._backFaceRS,t.shaderProgram=e._sp,t.uniformMap=c,t.pass=h,++m),t=i[m],Object(b["a"])(t)||(t=i[m]=new I["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[d],t.renderState=e._frontFaceRS,t.shaderProgram=e._sp,t.uniformMap=c,t.pass=h,Object(b["a"])(e._depthFailAppearance)&&(r&&(++m,t=i[m],Object(b["a"])(t)||(t=i[m]=new I["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[d],t.renderState=e._backFaceDepthFailRS,t.shaderProgram=e._spDepthFail,t.uniformMap=p,t.pass=h),++m,t=i[m],Object(b["a"])(t)||(t=i[m]=new I["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[d],t.renderState=e._frontFaceDepthFailRS,t.shaderProgram=e._spDepthFail,t.uniformMap=p,t.pass=h),++d}}function De(e,t,n,a,r,i,o,s){if(t.mode!==H["a"].SCENE3D&&!j["a"].equals(r,j["a"].IDENTITY))throw new f["a"]("Primitive.modelMatrix is only supported in 3D mode.");let c;N._updateBoundingVolumes(e,t,r),t.mode===H["a"].SCENE3D?c=e._boundingSphereWC:t.mode===H["a"].COLUMBUS_VIEW?c=e._boundingSphereCV:t.mode===H["a"].SCENE2D&&Object(b["a"])(e._boundingSphere2D)?c=e._boundingSphere2D:Object(b["a"])(e._boundingSphereMorph)&&(c=e._boundingSphereMorph);const p=t.commandList,h=t.passes;if(h.render||h.pick){const t=e.allowPicking,a=$["a"].castShadows(e.shadows),h=$["a"].receiveShadows(e.shadows),u=n.length;let l=s?2:1;l*=Object(b["a"])(e._depthFailAppearance)?2:1;for(let e=0;e<u;++e){const s=Math.floor(e/l),u=n[e];u.modelMatrix=r,u.boundingVolume=c[s],u.cull=i,u.debugShowBoundingVolume=o,u.castShadows=a,u.receiveShadows=h,u.pickId=t?"v_pickColor":void 0,p.push(u)}}}N._updateBoundingVolumes=function(e,t,n,r){let i,o,s;if(r||!j["a"].equals(n,e._modelMatrix))for(j["a"].clone(n,e._modelMatrix),o=e._boundingSpheres.length,i=0;i<o;++i)s=e._boundingSpheres[i],Object(b["a"])(s)&&(e._boundingSphereWC[i]=a["a"].transform(s,n,e._boundingSphereWC[i]),t.scene3DOnly||(e._boundingSphere2D[i]=a["a"].clone(e._boundingSphereCV[i],e._boundingSphere2D[i]),e._boundingSphere2D[i].center.x=0,e._boundingSphereMorph[i]=a["a"].union(e._boundingSphereWC[i],e._boundingSphereCV[i])));const c=e.appearance.pixelSize;if(Object(b["a"])(c))for(o=e._boundingSpheres.length,i=0;i<o;++i){s=e._boundingSpheres[i];const n=e._boundingSphereWC[i],a=t.camera.getPixelSize(s,t.context.drawingBufferWidth,t.context.drawingBufferHeight),r=a*c;n.radius=s.radius+r}},N.prototype.update=function(e){if(!Object(b["a"])(this.geometryInstances)&&0===this._va.length||Object(b["a"])(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&0===this.geometryInstances.length||!Object(b["a"])(this.appearance)||e.mode!==H["a"].SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(Object(b["a"])(this._error))throw this._error;if(Object(b["a"])(this.rtcCenter)&&!e.scene3DOnly)throw new f["a"]("RTC rendering is only available for 3D only scenes.");if(this._state===G["a"].FAILED)return;const t=e.context;if(Object(b["a"])(this._batchTable)||Q(this,t),this._batchTable.attributes.length>0){if(0===P["a"].maximumVertexTextureImageUnits)throw new w["a"]("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==G["a"].COMPLETE&&this._state!==G["a"].COMBINED&&(this.asynchronous?ue(this,e):le(this,e)),this._state===G["a"].COMBINED&&(ge(this,e),Te(this,e),ve(this,e)),!this.show||this._state!==G["a"].COMPLETE)return;this._batchTableOffsetsUpdated||Te(this,e),this._recomputeBoundingSpheres&&de(this,e);const n=this.appearance,a=n.material;let r=!1,i=!1;this._appearance!==n?(this._appearance=n,this._material=a,r=!0,i=!0):this._material!==a&&(this._material=a,i=!0);const o=this.depthFailAppearance,s=Object(b["a"])(o)?o.material:void 0;this._depthFailAppearance!==o?(this._depthFailAppearance=o,this._depthFailMaterial=s,r=!0,i=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,i=!0);const c=this._appearance.isTranslucent();this._translucent!==c&&(this._translucent=c,r=!0),Object(b["a"])(this._material)&&this._material.update(t);const p=n.closed&&c;if(r){const e=Object(l["a"])(this._createRenderStatesFunction,Se);e(this,t,n,p)}if(i){const t=Object(l["a"])(this._createShaderProgramFunction,je);t(this,e,n)}if(r||i){const t=Object(l["a"])(this._createCommandsFunction,Ae);t(this,n,a,c,p,this._colorCommands,this._pickCommands,e)}const h=Object(l["a"])(this._updateAndQueueCommandsFunction,De);h(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,p)};const Pe=new a["a"],Ie=new a["a"];function ke(e,t,n){if(n===v["a"].TOP){const n=a["a"].clone(e,Pe),r=a["a"].clone(e,Ie);r.center=i["a"].add(r.center,t,r.center),e=a["a"].union(n,r,e)}else n===v["a"].ALL&&(e.center=i["a"].add(e.center,t,e.center));return e}function ze(e,t,n){return function(){const a=e.getBatchedAttribute(t,n),r=e.attributes[n],i=r.componentsPerAttribute,o=u["a"].createTypedArray(r.componentDatatype,i);return Object(b["a"])(a.constructor.pack)?a.constructor.pack(a,o,0):o[0]=a,o}}function Fe(e,t,n,a,r){return function(i){if(!Object(b["a"])(i)||!Object(b["a"])(i.length)||i.length<1||i.length>4)throw new f["a"]("value must be and array with length between 1 and 4.");const o=J(i);e.setBatchedAttribute(t,n,o),"offset"===r&&(a._recomputeBoundingSpheres=!0,a._batchTableOffsetsUpdated=!1)}}const Ee=new i["a"];function Me(e,t,n){t.boundingSphere={get:function(){let r=e._instanceBoundingSpheres[n];if(Object(b["a"])(r)){r=r.clone();const o=e.modelMatrix,s=t.offset;Object(b["a"])(s)&&ke(r,i["a"].fromArray(s.get(),0,Ee),e._offsetInstanceExtend[n]),Object(b["a"])(o)&&(r=a["a"].transform(r,o))}return r}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[n]}}}function Le(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}function Be(e,t,n,a){e._error=a,e._state=n,t.afterRender.push((function(){e._ready=e._state===G["a"].COMPLETE||e._state===G["a"].FAILED,Object(b["a"])(a)?e._readyPromise.reject(a):e._readyPromise.resolve(e)}))}N.prototype.getGeometryInstanceAttributes=function(e){if(!Object(b["a"])(e))throw new f["a"]("id is required");if(!Object(b["a"])(this._batchTable))throw new f["a"]("must call update before calling getGeometryInstanceAttributes");let t=-1;const n=this._lastPerInstanceAttributeIndex,a=this._instanceIds,r=a.length;for(let p=0;p<r;++p){const i=(n+p)%r;if(e===a[i]){t=i;break}}if(-1===t)return;let i=this._perInstanceAttributeCache[t];if(Object(b["a"])(i))return i;const o=this._batchTable,s=this._batchTableAttributeIndices;i={};const c={};for(const p in s)if(s.hasOwnProperty(p)){const e=s[p];c[p]={get:ze(o,t,e),set:Fe(o,t,e,this,p)}}return Me(this,c,t),Le(this,c,t),Object.defineProperties(i,c),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=i,i},N.prototype.isDestroyed=function(){return!1},N.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();const n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;const a=this._pickIds;for(e=a.length,t=0;t<e;++t)a[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,Object(m["a"])(this)},t["a"]=N},b60e:function(e,t,n){"use strict";var a=n("ae9b"),r=n("1a5d"),i=n("c937"),o=n("c699");function s(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT);const t=e.propertyTexture,n=e.class,s=e.textures;a["a"].typeOf.object("options.propertyTexture",t),a["a"].typeOf.object("options.class",n),a["a"].typeOf.object("options.textures",s);const c=t.extensions,p=t.extras,h={};if(Object(i["a"])(t.properties))for(const a in t.properties)t.properties.hasOwnProperty(a)&&(h[a]=new o["a"]({property:t.properties[a],classProperty:n.properties[a],textures:s}));this._name=e.name,this._id=e.id,this._class=n,this._properties=h,this._extras=p,this._extensions=c}Object.defineProperties(s.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),s.prototype.getProperty=function(e){return a["a"].typeOf.string("propertyId",e),this._properties[e]},t["a"]=s},c699:function(e,t,n){"use strict";var a=n("ae9b"),r=n("1a5d"),i=n("c937"),o=n("31e7"),s=n("179a"),c=n("b28f");function p(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT);const t=e.property,n=e.classProperty,s=e.textures;a["a"].typeOf.object("options.property",t),a["a"].typeOf.object("options.classProperty",n),a["a"].typeOf.object("options.textures",s);const c=t,p=o["a"].createModelTextureReader({textureInfo:c,channels:l(t.channels),texture:s[c.index]});this._min=t.min,this._max=t.max;let h=t.offset,u=t.scale;const d=n.hasValueTransform||Object(i["a"])(h)||Object(i["a"])(u);h=Object(r["a"])(h,n.offset),u=Object(r["a"])(u,n.scale),h=n.unpackVectorAndMatrixTypes(h),u=n.unpackVectorAndMatrixTypes(u),this._offset=h,this._scale=u,this._hasValueTransform=d,this._textureReader=p,this._classProperty=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(p.prototype,{textureReader:{get:function(){return this._textureReader}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),p.prototype.isGpuCompatible=function(){const e=this._classProperty,t=e.type,n=e.componentType;return e.isArray?!e.isVariableLengthArray&&e.arrayLength<=4&&t===s["a"].SCALAR&&n===c["a"].UINT8:!(!s["a"].isVectorType(t)&&t!==s["a"].SCALAR)&&n===c["a"].UINT8};const h=[void 0,"float","vec2","vec3","vec4"],u=[void 0,"int","ivec2","ivec3","ivec4"];function l(e){return e.map((function(e){return"rgba".charAt(e)})).join("")}p.prototype.getGlslType=function(){const e=this._classProperty;let t=s["a"].getComponentCount(e.type);return e.isArray&&(t=e.arrayLength),e.normalized?h[t]:u[t]},p.prototype.unpackInShader=function(e){const t=this._classProperty;if(t.normalized)return e;const n=this.getGlslType();return`${n}(255.0 * ${e})`},t["a"]=p},d180:function(e,t,n){"use strict";var a=n("8656"),r=n("cbf0"),i=n("1a5d"),o=n("c937"),s=n("e2a6"),c=n("e107"),p=n("1f02"),h=n("5a72"),u=n("f3a4"),l=n("0c02"),d=n("f6fe"),b=n("2642"),m=n("722e"),f=n("5452"),_=n("5be5");function g(e,t,n){let a=!n;const r=e.length;let i;if(!a&&r>1){const t=e[0].modelMatrix;for(i=1;i<r;++i)if(!m["a"].equals(t,e[i].modelMatrix)){a=!0;break}}if(a)for(i=0;i<r;++i)Object(o["a"])(e[i].geometry)&&d["a"].transformToWorldCoordinates(e[i]);else m["a"].multiplyTransformation(t,e[0].modelMatrix,t)}function y(e,t){const n=e.attributes,a=n.position,i=a.values.length/a.componentsPerAttribute;n.batchId=new u["a"]({componentDatatype:r["a"].FLOAT,componentsPerAttribute:1,values:new Float32Array(i)});const o=n.batchId.values;for(let r=0;r<i;++r)o[r]=t}function O(e){const t=e.length;for(let n=0;n<t;++n){const t=e[n];Object(o["a"])(t.geometry)?y(t.geometry,n):Object(o["a"])(t.westHemisphereGeometry)&&Object(o["a"])(t.eastHemisphereGeometry)&&(y(t.westHemisphereGeometry,n),y(t.eastHemisphereGeometry,n))}}function T(e){const t=e.instances,n=e.projection,i=e.elementIndexUintSupported,c=e.scene3DOnly,p=e.vertexCacheOptimize,h=e.compressVertices,u=e.modelMatrix;let l,b,m,f=t.length;for(l=0;l<f;++l)if(Object(o["a"])(t[l].geometry)){m=t[l].geometry.primitiveType;break}for(l=1;l<f;++l)if(Object(o["a"])(t[l].geometry)&&t[l].geometry.primitiveType!==m)throw new s["a"]("All instance geometries must have the same primitiveType.");if(g(t,u,c),!c)for(l=0;l<f;++l)Object(o["a"])(t[l].geometry)&&d["a"].splitLongitude(t[l]);if(O(t),p)for(l=0;l<f;++l){const e=t[l];Object(o["a"])(e.geometry)?(d["a"].reorderForPostVertexCache(e.geometry),d["a"].reorderForPreVertexCache(e.geometry)):Object(o["a"])(e.westHemisphereGeometry)&&Object(o["a"])(e.eastHemisphereGeometry)&&(d["a"].reorderForPostVertexCache(e.westHemisphereGeometry),d["a"].reorderForPreVertexCache(e.westHemisphereGeometry),d["a"].reorderForPostVertexCache(e.eastHemisphereGeometry),d["a"].reorderForPreVertexCache(e.eastHemisphereGeometry))}let _=d["a"].combineInstances(t);for(f=_.length,l=0;l<f;++l){b=_[l];const e=b.attributes;if(c)for(const t in e)e.hasOwnProperty(t)&&e[t].componentDatatype===r["a"].DOUBLE&&d["a"].encodeAttribute(b,t,t+"3DHigh",t+"3DLow");else for(const t in e)if(e.hasOwnProperty(t)&&e[t].componentDatatype===r["a"].DOUBLE){const e=t+"3D",r=t+"2D";d["a"].projectTo2D(b,t,e,r,n),Object(o["a"])(b.boundingSphere)&&"position"===t&&(b.boundingSphereCV=a["a"].fromVertices(b.attributes.position2D.values)),d["a"].encodeAttribute(b,e,e+"High",e+"Low"),d["a"].encodeAttribute(b,r,r+"High",r+"Low")}h&&d["a"].compressVertices(b)}if(!i){let e=[];for(f=_.length,l=0;l<f;++l)b=_[l],e=e.concat(d["a"].fitToUnsignedShortIndices(b));_=e}return _}function v(e,t,n,a){let r,i,s;const c=a.length-1;if(c>=0){const e=a[c];r=e.offset+e.count,s=e.index,i=n[s].indices.length}else r=0,s=0,i=n[s].indices.length;const p=e.length;for(let h=0;h<p;++h){const c=e[h],p=c[t];if(!Object(o["a"])(p))continue;const u=p.indices.length;r+u>i&&(r=0,i=n[++s].indices.length),a.push({index:s,offset:r,count:u}),r+=u}}function S(e,t){const n=[];return v(e,"geometry",t,n),v(e,"westHemisphereGeometry",t,n),v(e,"eastHemisphereGeometry",t,n),n}const j={};function x(e,t){const n=e.attributes;for(const a in n)if(n.hasOwnProperty(a)){const e=n[a];Object(o["a"])(e)&&Object(o["a"])(e.values)&&t.push(e.values.buffer)}Object(o["a"])(e.indices)&&t.push(e.indices.buffer)}function w(e,t){const n=e.length;for(let a=0;a<n;++a)x(e[a],t)}function C(e){let t=1;const n=e.length;for(let r=0;r<n;r++){const n=e[r];if(++t,!Object(o["a"])(n))continue;const i=n.attributes;t+=7+2*a["a"].packedLength+(Object(o["a"])(n.indices)?n.indices.length:0);for(const e in i)if(i.hasOwnProperty(e)&&Object(o["a"])(i[e])){const n=i[e];t+=5+n.values.length}}return t}function A(e,t){const n=e.length,a=new Float64Array(1+19*n);let r=0;a[r++]=n;for(let i=0;i<n;i++){const t=e[i];if(m["a"].pack(t.modelMatrix,a,r),r+=m["a"].packedLength,Object(o["a"])(t.attributes)&&Object(o["a"])(t.attributes.offset)){const e=t.attributes.offset.value;a[r]=e[0],a[r+1]=e[1],a[r+2]=e[2]}r+=3}return t.push(a.buffer),a}function D(e){const t=e,n=new Array(t[0]);let a=0,r=1;while(r<t.length){const e=m["a"].unpack(t,r);let i;r+=m["a"].packedLength,Object(o["a"])(t[r])&&(i={offset:new f["a"](t[r],t[r+1],t[r+2])}),r+=3,n[a++]={modelMatrix:e,attributes:i}}return n}function P(e){const t=e.length,n=1+(a["a"].packedLength+1)*t,r=new Float32Array(n);let i=0;r[i++]=t;for(let s=0;s<t;++s){const t=e[s];Object(o["a"])(t)?(r[i++]=1,a["a"].pack(e[s],r,i)):r[i++]=0,i+=a["a"].packedLength}return r}function I(e){const t=new Array(e[0]);let n=0,r=1;while(r<e.length)1===e[r++]&&(t[n]=a["a"].unpack(e,r)),++n,r+=a["a"].packedLength;return t}j.combineGeometry=function(e){let t,n;const r=e.instances,i=r.length;let s,c,p=!1;i>0&&(t=T(e),t.length>0&&(n=d["a"].createAttributeLocations(t[0]),e.createPickOffsets&&(s=S(r,t))),Object(o["a"])(r[0].attributes)&&Object(o["a"])(r[0].attributes.offset)&&(c=new Array(i),p=!0));const h=new Array(i),u=new Array(i);for(let l=0;l<i;++l){const e=r[l],t=e.geometry;Object(o["a"])(t)&&(h[l]=t.boundingSphere,u[l]=t.boundingSphereCV,p&&(c[l]=e.geometry.offsetAttribute));const n=e.eastHemisphereGeometry,i=e.westHemisphereGeometry;Object(o["a"])(n)&&Object(o["a"])(i)&&(Object(o["a"])(n.boundingSphere)&&Object(o["a"])(i.boundingSphere)&&(h[l]=a["a"].union(n.boundingSphere,i.boundingSphere)),Object(o["a"])(n.boundingSphereCV)&&Object(o["a"])(i.boundingSphereCV)&&(u[l]=a["a"].union(n.boundingSphereCV,i.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:s,offsetInstanceExtend:c,boundingSpheres:h,boundingSpheresCV:u}},j.packCreateGeometryResults=function(e,t){const n=new Float64Array(C(e)),r=[],s={},c=e.length;let p=0;n[p++]=c;for(let h=0;h<c;h++){const t=e[h],c=Object(o["a"])(t);if(n[p++]=c?1:0,!c)continue;n[p++]=t.primitiveType,n[p++]=t.geometryType,n[p++]=Object(i["a"])(t.offsetAttribute,-1);const u=Object(o["a"])(t.boundingSphere)?1:0;n[p++]=u,u&&a["a"].pack(t.boundingSphere,n,p),p+=a["a"].packedLength;const l=Object(o["a"])(t.boundingSphereCV)?1:0;n[p++]=l,l&&a["a"].pack(t.boundingSphereCV,n,p),p+=a["a"].packedLength;const d=t.attributes,b=[];for(const e in d)d.hasOwnProperty(e)&&Object(o["a"])(d[e])&&(b.push(e),Object(o["a"])(s[e])||(s[e]=r.length,r.push(e)));n[p++]=b.length;for(let e=0;e<b.length;e++){const t=b[e],a=d[t];n[p++]=s[t],n[p++]=a.componentDatatype,n[p++]=a.componentsPerAttribute,n[p++]=a.normalize?1:0,n[p++]=a.values.length,n.set(a.values,p),p+=a.values.length}const m=Object(o["a"])(t.indices)?t.indices.length:0;n[p++]=m,m>0&&(n.set(t.indices,p),p+=m)}return t.push(n.buffer),{stringTable:r,packedData:n}},j.unpackCreateGeometryResults=function(e){const t=e.stringTable,n=e.packedData;let i;const o=new Array(n[0]);let s=0,c=1;while(c<n.length){const e=1===n[c++];if(!e){o[s++]=void 0;continue}const p=n[c++],d=n[c++];let m,f,_=n[c++];-1===_&&(_=void 0);const g=1===n[c++];g&&(m=a["a"].unpack(n,c)),c+=a["a"].packedLength;const y=1===n[c++];let O,T,v;y&&(f=a["a"].unpack(n,c)),c+=a["a"].packedLength;const S=new l["a"],j=n[c++];for(i=0;i<j;i++){const e=t[n[c++]],a=n[c++];v=n[c++];const i=0!==n[c++];O=n[c++],T=r["a"].createTypedArray(a,O);for(let t=0;t<O;t++)T[t]=n[c++];S[e]=new u["a"]({componentDatatype:a,componentsPerAttribute:v,normalize:i,values:T})}let x;if(O=n[c++],O>0){const e=T.length/v;for(x=b["a"].createTypedArray(e,O),i=0;i<O;i++)x[i]=n[c++]}o[s++]=new h["a"]({primitiveType:p,geometryType:d,boundingSphere:m,boundingSphereCV:f,indices:x,attributes:S,offsetAttribute:_})}return o},j.packCombineGeometryParameters=function(e,t){const n=e.createGeometryResults,a=n.length;for(let r=0;r<a;r++)t.push(n[r].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:A(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof p["a"],elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},j.unpackCombineGeometryParameters=function(e){const t=D(e.packedInstances),n=e.createGeometryResults,a=n.length;let r=0;for(let s=0;s<a;s++){const e=j.unpackCreateGeometryResults(n[s]),a=e.length;for(let n=0;n<a;n++){const a=e[n],i=t[r];i.geometry=a,++r}}const i=c["a"].clone(e.ellipsoid),o=e.isGeographic?new p["a"](i):new _["a"](i);return{instances:t,ellipsoid:i,projection:o,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:m["a"].clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},j.packCombineGeometryResults=function(e,t){Object(o["a"])(e.geometries)&&w(e.geometries,t);const n=P(e.boundingSpheres),a=P(e.boundingSpheresCV);return t.push(n.buffer,a.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:a}},j.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:I(e.boundingSpheres),boundingSpheresCV:I(e.boundingSpheresCV)}},t["a"]=j},d509:function(e,t,n){"use strict";const a={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6};t["a"]=Object.freeze(a)},d56e:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("ae9b"),r=n("1a5d"),i=n("c937"),o=n("5441");function s(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT);const t=e.propertyAttribute,n=e.class;a["a"].typeOf.object("options.propertyAttribute",t),a["a"].typeOf.object("options.class",n);const s={};if(Object(i["a"])(t.properties))for(const a in t.properties)t.properties.hasOwnProperty(a)&&(s[a]=new o["a"]({property:t.properties[a],classProperty:n.properties[a]}));this._name=e.name,this._id=e.id,this._class=n,this._properties=s,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(s.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),s.prototype.getProperty=function(e){return a["a"].typeOf.string("propertyId",e),this._properties[e]}}}]);